import{a as c,j as e,H as Po,c as lt}from"./app-88RFb6Cl.js";import{c as Bt,u as zo,R as Mo,a as yt,b as Oo,d as $o,P as Lo,V as Fo,e as Vo,h as Bo,f as Uo,g as Ho,F as qo,D as Ko,C as Go,i as Wo,A as Yo,X as Xe,U as Le}from"./app-layout-BFTu8N8U.js";import{C as ae,c as se,a as Je,b as Ze}from"./card-BB7JI8Fy.js";import{u as fe,a as Xo,c as Fe,B as Z}from"./button-BLU6mPdr.js";import{B as Oe}from"./badge-Bl_16ZFZ.js";import{P as Ot}from"./progress-BtX941aj.js";import{I as Jo}from"./input-DSmzVGVR.js";import{L as dt}from"./label-Drm7Rml6.js";import{P as ce,r as Ut}from"./index-hBdFfFz8.js";import{u as $t,c as Zo,a as X,d as Ce}from"./index-BQxYFtly.js";import{u as Qo}from"./index-BNLqAuex.js";import{c as ot}from"./createLucideIcon-CG5fLgy-.js";import{C as ea}from"./check-Ch3FuLeh.js";import{C as Ne,F as _e}from"./file-text-rYohE8FC.js";import{L as $e}from"./loader-circle-C29-Un3g.js";import{C as ue}from"./circle-alert-DTNb-uHo.js";import{C as Ht}from"./clock-BAyMaXIV.js";import{C as Te}from"./calendar-BUAHsl9q.js";import{B as qt}from"./brain-B1t0q5GF.js";import{E as Lt}from"./eye-DDwYUssd.js";/* empty css            */import"./index-u1-Hf6Gb.js";import"./index-DW9AIAM8.js";import"./log-out-Dvd2V94M.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kt=ot("ChevronDown",ta);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],aa=ot("ChevronUp",oa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],na=ot("Plus",sa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ca=ot("Search",ra);function Ft(o,[r,s]){return Math.min(s,Math.max(r,o))}var ia=[" ","Enter","ArrowUp","ArrowDown"],la=[" ","Enter"],Re="Select",[at,st,da]=Oo(Re),[Ve]=Zo(Re,[da,Bt]),nt=Bt(),[ua,Se]=Ve(Re),[ma,pa]=Ve(Re),Gt=o=>{const{__scopeSelect:r,children:s,open:p,defaultOpen:d,onOpenChange:N,value:g,defaultValue:m,onValueChange:x,dir:w,name:I,autoComplete:_,disabled:V,required:l,form:S}=o,b=nt(r),[k,z]=c.useState(null),[y,T]=c.useState(null),[pe,W]=c.useState(!1),je=zo(w),[O,ie]=$t({prop:p,defaultProp:d??!1,onChange:N,caller:Re}),[F,ge]=$t({prop:g,defaultProp:m,onChange:x,caller:Re}),ee=c.useRef(null),K=k?S||!!k.closest("form"):!0,[ne,re]=c.useState(new Set),te=Array.from(ne).map(J=>J.props.value).join(";");return e.jsx(Mo,{...b,children:e.jsxs(ua,{required:l,scope:r,trigger:k,onTriggerChange:z,valueNode:y,onValueNodeChange:T,valueNodeHasChildren:pe,onValueNodeHasChildrenChange:W,contentId:yt(),value:F,onValueChange:ge,open:O,onOpenChange:ie,dir:je,triggerPointerDownPosRef:ee,disabled:V,children:[e.jsx(at.Provider,{scope:r,children:e.jsx(ma,{scope:o.__scopeSelect,onNativeOptionAdd:c.useCallback(J=>{re(oe=>new Set(oe).add(J))},[]),onNativeOptionRemove:c.useCallback(J=>{re(oe=>{const le=new Set(oe);return le.delete(J),le})},[]),children:s})}),K?e.jsxs(ho,{"aria-hidden":!0,required:l,tabIndex:-1,name:I,autoComplete:_,value:F,onChange:J=>ge(J.target.value),disabled:V,form:S,children:[F===void 0?e.jsx("option",{value:""}):null,Array.from(ne)]},te):null]})})};Gt.displayName=Re;var Wt="SelectTrigger",Yt=c.forwardRef((o,r)=>{const{__scopeSelect:s,disabled:p=!1,...d}=o,N=nt(s),g=Se(Wt,s),m=g.disabled||p,x=fe(r,g.onTriggerChange),w=st(s),I=c.useRef("touch"),[_,V,l]=vo(b=>{const k=w().filter(T=>!T.disabled),z=k.find(T=>T.value===g.value),y=bo(k,b,z);y!==void 0&&g.onValueChange(y.value)}),S=b=>{m||(g.onOpenChange(!0),l()),b&&(g.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx($o,{asChild:!0,...N,children:e.jsx(ce.button,{type:"button",role:"combobox","aria-controls":g.contentId,"aria-expanded":g.open,"aria-required":g.required,"aria-autocomplete":"none",dir:g.dir,"data-state":g.open?"open":"closed",disabled:m,"data-disabled":m?"":void 0,"data-placeholder":fo(g.value)?"":void 0,...d,ref:x,onClick:X(d.onClick,b=>{b.currentTarget.focus(),I.current!=="mouse"&&S(b)}),onPointerDown:X(d.onPointerDown,b=>{I.current=b.pointerType;const k=b.target;k.hasPointerCapture(b.pointerId)&&k.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(S(b),b.preventDefault())}),onKeyDown:X(d.onKeyDown,b=>{const k=_.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&V(b.key),!(k&&b.key===" ")&&ia.includes(b.key)&&(S(),b.preventDefault())})})})});Yt.displayName=Wt;var Xt="SelectValue",Jt=c.forwardRef((o,r)=>{const{__scopeSelect:s,className:p,style:d,children:N,placeholder:g="",...m}=o,x=Se(Xt,s),{onValueNodeHasChildrenChange:w}=x,I=N!==void 0,_=fe(r,x.onValueNodeChange);return Ce(()=>{w(I)},[w,I]),e.jsx(ce.span,{...m,ref:_,style:{pointerEvents:"none"},children:fo(x.value)?e.jsx(e.Fragment,{children:g}):N})});Jt.displayName=Xt;var ga="SelectIcon",Zt=c.forwardRef((o,r)=>{const{__scopeSelect:s,children:p,...d}=o;return e.jsx(ce.span,{"aria-hidden":!0,...d,ref:r,children:p||"▼"})});Zt.displayName=ga;var xa="SelectPortal",Qt=o=>e.jsx(Lo,{asChild:!0,...o});Qt.displayName=xa;var Pe="SelectContent",eo=c.forwardRef((o,r)=>{const s=Se(Pe,o.__scopeSelect),[p,d]=c.useState();if(Ce(()=>{d(new DocumentFragment)},[]),!s.open){const N=p;return N?Ut.createPortal(e.jsx(to,{scope:o.__scopeSelect,children:e.jsx(at.Slot,{scope:o.__scopeSelect,children:e.jsx("div",{children:o.children})})}),N):null}return e.jsx(oo,{...o,ref:r})});eo.displayName=Pe;var me=10,[to,ke]=Ve(Pe),ha="SelectContentImpl",fa=Xo("SelectContent.RemoveScroll"),oo=c.forwardRef((o,r)=>{const{__scopeSelect:s,position:p="item-aligned",onCloseAutoFocus:d,onEscapeKeyDown:N,onPointerDownOutside:g,side:m,sideOffset:x,align:w,alignOffset:I,arrowPadding:_,collisionBoundary:V,collisionPadding:l,sticky:S,hideWhenDetached:b,avoidCollisions:k,...z}=o,y=Se(Pe,s),[T,pe]=c.useState(null),[W,je]=c.useState(null),O=fe(r,f=>pe(f)),[ie,F]=c.useState(null),[ge,ee]=c.useState(null),K=st(s),[ne,re]=c.useState(!1),te=c.useRef(!1);c.useEffect(()=>{if(T)return Bo(T)},[T]),Uo();const J=c.useCallback(f=>{const[B,...q]=K().map(j=>j.ref.current),[D]=q.slice(-1),L=document.activeElement;for(const j of f)if(j===L||(j?.scrollIntoView({block:"nearest"}),j===B&&W&&(W.scrollTop=0),j===D&&W&&(W.scrollTop=W.scrollHeight),j?.focus(),document.activeElement!==L))return},[K,W]),oe=c.useCallback(()=>J([ie,T]),[J,ie,T]);c.useEffect(()=>{ne&&oe()},[ne,oe]);const{onOpenChange:le,triggerPointerDownPosRef:de}=y;c.useEffect(()=>{if(T){let f={x:0,y:0};const B=D=>{f={x:Math.abs(Math.round(D.pageX)-(de.current?.x??0)),y:Math.abs(Math.round(D.pageY)-(de.current?.y??0))}},q=D=>{f.x<=10&&f.y<=10?D.preventDefault():T.contains(D.target)||le(!1),document.removeEventListener("pointermove",B),de.current=null};return de.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",q,{capture:!0})}}},[T,le,de]),c.useEffect(()=>{const f=()=>le(!1);return window.addEventListener("blur",f),window.addEventListener("resize",f),()=>{window.removeEventListener("blur",f),window.removeEventListener("resize",f)}},[le]);const[Be,ye]=vo(f=>{const B=K().filter(L=>!L.disabled),q=B.find(L=>L.ref.current===document.activeElement),D=bo(B,f,q);D&&setTimeout(()=>D.ref.current.focus())}),Ue=c.useCallback((f,B,q)=>{const D=!te.current&&!q;(y.value!==void 0&&y.value===B||D)&&(F(f),D&&(te.current=!0))},[y.value]),He=c.useCallback(()=>T?.focus(),[T]),ve=c.useCallback((f,B,q)=>{const D=!te.current&&!q;(y.value!==void 0&&y.value===B||D)&&ee(f)},[y.value]),M=p==="popper"?ht:ao,De=M===ht?{side:m,sideOffset:x,align:w,alignOffset:I,arrowPadding:_,collisionBoundary:V,collisionPadding:l,sticky:S,hideWhenDetached:b,avoidCollisions:k}:{};return e.jsx(to,{scope:s,content:T,viewport:W,onViewportChange:je,itemRefCallback:Ue,selectedItem:ie,onItemLeave:He,itemTextRefCallback:ve,focusSelectedItem:oe,selectedItemText:ge,position:p,isPositioned:ne,searchRef:Be,children:e.jsx(Ho,{as:fa,allowPinchZoom:!0,children:e.jsx(qo,{asChild:!0,trapped:y.open,onMountAutoFocus:f=>{f.preventDefault()},onUnmountAutoFocus:X(d,f=>{y.trigger?.focus({preventScroll:!0}),f.preventDefault()}),children:e.jsx(Ko,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:N,onPointerDownOutside:g,onFocusOutside:f=>f.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:e.jsx(M,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:f=>f.preventDefault(),...z,...De,onPlaced:()=>re(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...z.style},onKeyDown:X(z.onKeyDown,f=>{const B=f.ctrlKey||f.altKey||f.metaKey;if(f.key==="Tab"&&f.preventDefault(),!B&&f.key.length===1&&ye(f.key),["ArrowUp","ArrowDown","Home","End"].includes(f.key)){let D=K().filter(L=>!L.disabled).map(L=>L.ref.current);if(["ArrowUp","End"].includes(f.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(f.key)){const L=f.target,j=D.indexOf(L);D=D.slice(j+1)}setTimeout(()=>J(D)),f.preventDefault()}})})})})})})});oo.displayName=ha;var va="SelectItemAlignedPosition",ao=c.forwardRef((o,r)=>{const{__scopeSelect:s,onPlaced:p,...d}=o,N=Se(Pe,s),g=ke(Pe,s),[m,x]=c.useState(null),[w,I]=c.useState(null),_=fe(r,O=>I(O)),V=st(s),l=c.useRef(!1),S=c.useRef(!0),{viewport:b,selectedItem:k,selectedItemText:z,focusSelectedItem:y}=g,T=c.useCallback(()=>{if(N.trigger&&N.valueNode&&m&&w&&b&&k&&z){const O=N.trigger.getBoundingClientRect(),ie=w.getBoundingClientRect(),F=N.valueNode.getBoundingClientRect(),ge=z.getBoundingClientRect();if(N.dir!=="rtl"){const L=ge.left-ie.left,j=F.left-L,G=O.left-j,be=O.width+G,Ee=Math.max(be,ie.width),qe=window.innerWidth-me,Ke=Ft(j,[me,Math.max(me,qe-Ee)]);m.style.minWidth=be+"px",m.style.left=Ke+"px"}else{const L=ie.right-ge.right,j=window.innerWidth-F.right-L,G=window.innerWidth-O.right-j,be=O.width+G,Ee=Math.max(be,ie.width),qe=window.innerWidth-me,Ke=Ft(j,[me,Math.max(me,qe-Ee)]);m.style.minWidth=be+"px",m.style.right=Ke+"px"}const ee=V(),K=window.innerHeight-me*2,ne=b.scrollHeight,re=window.getComputedStyle(w),te=parseInt(re.borderTopWidth,10),J=parseInt(re.paddingTop,10),oe=parseInt(re.borderBottomWidth,10),le=parseInt(re.paddingBottom,10),de=te+J+ne+le+oe,Be=Math.min(k.offsetHeight*5,de),ye=window.getComputedStyle(b),Ue=parseInt(ye.paddingTop,10),He=parseInt(ye.paddingBottom,10),ve=O.top+O.height/2-me,M=K-ve,De=k.offsetHeight/2,f=k.offsetTop+De,B=te+J+f,q=de-B;if(B<=ve){const L=ee.length>0&&k===ee[ee.length-1].ref.current;m.style.bottom="0px";const j=w.clientHeight-b.offsetTop-b.offsetHeight,G=Math.max(M,De+(L?He:0)+j+oe),be=B+G;m.style.height=be+"px"}else{const L=ee.length>0&&k===ee[0].ref.current;m.style.top="0px";const G=Math.max(ve,te+b.offsetTop+(L?Ue:0)+De)+q;m.style.height=G+"px",b.scrollTop=B-ve+b.offsetTop}m.style.margin=`${me}px 0`,m.style.minHeight=Be+"px",m.style.maxHeight=K+"px",p?.(),requestAnimationFrame(()=>l.current=!0)}},[V,N.trigger,N.valueNode,m,w,b,k,z,N.dir,p]);Ce(()=>T(),[T]);const[pe,W]=c.useState();Ce(()=>{w&&W(window.getComputedStyle(w).zIndex)},[w]);const je=c.useCallback(O=>{O&&S.current===!0&&(T(),y?.(),S.current=!1)},[T,y]);return e.jsx(Na,{scope:s,contentWrapper:m,shouldExpandOnScrollRef:l,onScrollButtonChange:je,children:e.jsx("div",{ref:x,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:pe},children:e.jsx(ce.div,{...d,ref:_,style:{boxSizing:"border-box",maxHeight:"100%",...d.style}})})})});ao.displayName=va;var ba="SelectPopperPosition",ht=c.forwardRef((o,r)=>{const{__scopeSelect:s,align:p="start",collisionPadding:d=me,...N}=o,g=nt(s);return e.jsx(Go,{...g,...N,ref:r,align:p,collisionPadding:d,style:{boxSizing:"border-box",...N.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ht.displayName=ba;var[Na,wt]=Ve(Pe,{}),ft="SelectViewport",so=c.forwardRef((o,r)=>{const{__scopeSelect:s,nonce:p,...d}=o,N=ke(ft,s),g=wt(ft,s),m=fe(r,N.onViewportChange),x=c.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:p}),e.jsx(at.Slot,{scope:s,children:e.jsx(ce.div,{"data-radix-select-viewport":"",role:"presentation",...d,ref:m,style:{position:"relative",flex:1,overflow:"hidden auto",...d.style},onScroll:X(d.onScroll,w=>{const I=w.currentTarget,{contentWrapper:_,shouldExpandOnScrollRef:V}=g;if(V?.current&&_){const l=Math.abs(x.current-I.scrollTop);if(l>0){const S=window.innerHeight-me*2,b=parseFloat(_.style.minHeight),k=parseFloat(_.style.height),z=Math.max(b,k);if(z<S){const y=z+l,T=Math.min(S,y),pe=y-T;_.style.height=T+"px",_.style.bottom==="0px"&&(I.scrollTop=pe>0?pe:0,_.style.justifyContent="flex-end")}}}x.current=I.scrollTop})})})]})});so.displayName=ft;var no="SelectGroup",[ja,ya]=Ve(no),wa=c.forwardRef((o,r)=>{const{__scopeSelect:s,...p}=o,d=yt();return e.jsx(ja,{scope:s,id:d,children:e.jsx(ce.div,{role:"group","aria-labelledby":d,...p,ref:r})})});wa.displayName=no;var ro="SelectLabel",Ca=c.forwardRef((o,r)=>{const{__scopeSelect:s,...p}=o,d=ya(ro,s);return e.jsx(ce.div,{id:d.id,...p,ref:r})});Ca.displayName=ro;var et="SelectItem",[Sa,co]=Ve(et),io=c.forwardRef((o,r)=>{const{__scopeSelect:s,value:p,disabled:d=!1,textValue:N,...g}=o,m=Se(et,s),x=ke(et,s),w=m.value===p,[I,_]=c.useState(N??""),[V,l]=c.useState(!1),S=fe(r,y=>x.itemRefCallback?.(y,p,d)),b=yt(),k=c.useRef("touch"),z=()=>{d||(m.onValueChange(p),m.onOpenChange(!1))};if(p==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Sa,{scope:s,value:p,disabled:d,textId:b,isSelected:w,onItemTextChange:c.useCallback(y=>{_(T=>T||(y?.textContent??"").trim())},[]),children:e.jsx(at.ItemSlot,{scope:s,value:p,disabled:d,textValue:I,children:e.jsx(ce.div,{role:"option","aria-labelledby":b,"data-highlighted":V?"":void 0,"aria-selected":w&&V,"data-state":w?"checked":"unchecked","aria-disabled":d||void 0,"data-disabled":d?"":void 0,tabIndex:d?void 0:-1,...g,ref:S,onFocus:X(g.onFocus,()=>l(!0)),onBlur:X(g.onBlur,()=>l(!1)),onClick:X(g.onClick,()=>{k.current!=="mouse"&&z()}),onPointerUp:X(g.onPointerUp,()=>{k.current==="mouse"&&z()}),onPointerDown:X(g.onPointerDown,y=>{k.current=y.pointerType}),onPointerMove:X(g.onPointerMove,y=>{k.current=y.pointerType,d?x.onItemLeave?.():k.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:X(g.onPointerLeave,y=>{y.currentTarget===document.activeElement&&x.onItemLeave?.()}),onKeyDown:X(g.onKeyDown,y=>{x.searchRef?.current!==""&&y.key===" "||(la.includes(y.key)&&z(),y.key===" "&&y.preventDefault())})})})})});io.displayName=et;var Ge="SelectItemText",lo=c.forwardRef((o,r)=>{const{__scopeSelect:s,className:p,style:d,...N}=o,g=Se(Ge,s),m=ke(Ge,s),x=co(Ge,s),w=pa(Ge,s),[I,_]=c.useState(null),V=fe(r,z=>_(z),x.onItemTextChange,z=>m.itemTextRefCallback?.(z,x.value,x.disabled)),l=I?.textContent,S=c.useMemo(()=>e.jsx("option",{value:x.value,disabled:x.disabled,children:l},x.value),[x.disabled,x.value,l]),{onNativeOptionAdd:b,onNativeOptionRemove:k}=w;return Ce(()=>(b(S),()=>k(S)),[b,k,S]),e.jsxs(e.Fragment,{children:[e.jsx(ce.span,{id:x.textId,...N,ref:V}),x.isSelected&&g.valueNode&&!g.valueNodeHasChildren?Ut.createPortal(N.children,g.valueNode):null]})});lo.displayName=Ge;var uo="SelectItemIndicator",mo=c.forwardRef((o,r)=>{const{__scopeSelect:s,...p}=o;return co(uo,s).isSelected?e.jsx(ce.span,{"aria-hidden":!0,...p,ref:r}):null});mo.displayName=uo;var vt="SelectScrollUpButton",po=c.forwardRef((o,r)=>{const s=ke(vt,o.__scopeSelect),p=wt(vt,o.__scopeSelect),[d,N]=c.useState(!1),g=fe(r,p.onScrollButtonChange);return Ce(()=>{if(s.viewport&&s.isPositioned){let m=function(){const w=x.scrollTop>0;N(w)};const x=s.viewport;return m(),x.addEventListener("scroll",m),()=>x.removeEventListener("scroll",m)}},[s.viewport,s.isPositioned]),d?e.jsx(xo,{...o,ref:g,onAutoScroll:()=>{const{viewport:m,selectedItem:x}=s;m&&x&&(m.scrollTop=m.scrollTop-x.offsetHeight)}}):null});po.displayName=vt;var bt="SelectScrollDownButton",go=c.forwardRef((o,r)=>{const s=ke(bt,o.__scopeSelect),p=wt(bt,o.__scopeSelect),[d,N]=c.useState(!1),g=fe(r,p.onScrollButtonChange);return Ce(()=>{if(s.viewport&&s.isPositioned){let m=function(){const w=x.scrollHeight-x.clientHeight,I=Math.ceil(x.scrollTop)<w;N(I)};const x=s.viewport;return m(),x.addEventListener("scroll",m),()=>x.removeEventListener("scroll",m)}},[s.viewport,s.isPositioned]),d?e.jsx(xo,{...o,ref:g,onAutoScroll:()=>{const{viewport:m,selectedItem:x}=s;m&&x&&(m.scrollTop=m.scrollTop+x.offsetHeight)}}):null});go.displayName=bt;var xo=c.forwardRef((o,r)=>{const{__scopeSelect:s,onAutoScroll:p,...d}=o,N=ke("SelectScrollButton",s),g=c.useRef(null),m=st(s),x=c.useCallback(()=>{g.current!==null&&(window.clearInterval(g.current),g.current=null)},[]);return c.useEffect(()=>()=>x(),[x]),Ce(()=>{m().find(I=>I.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[m]),e.jsx(ce.div,{"aria-hidden":!0,...d,ref:r,style:{flexShrink:0,...d.style},onPointerDown:X(d.onPointerDown,()=>{g.current===null&&(g.current=window.setInterval(p,50))}),onPointerMove:X(d.onPointerMove,()=>{N.onItemLeave?.(),g.current===null&&(g.current=window.setInterval(p,50))}),onPointerLeave:X(d.onPointerLeave,()=>{x()})})}),ka="SelectSeparator",Da=c.forwardRef((o,r)=>{const{__scopeSelect:s,...p}=o;return e.jsx(ce.div,{"aria-hidden":!0,...p,ref:r})});Da.displayName=ka;var Nt="SelectArrow",Ea=c.forwardRef((o,r)=>{const{__scopeSelect:s,...p}=o,d=nt(s),N=Se(Nt,s),g=ke(Nt,s);return N.open&&g.position==="popper"?e.jsx(Wo,{...d,...p,ref:r}):null});Ea.displayName=Nt;var Aa="SelectBubbleInput",ho=c.forwardRef(({__scopeSelect:o,value:r,...s},p)=>{const d=c.useRef(null),N=fe(p,d),g=Qo(r);return c.useEffect(()=>{const m=d.current;if(!m)return;const x=window.HTMLSelectElement.prototype,I=Object.getOwnPropertyDescriptor(x,"value").set;if(g!==r&&I){const _=new Event("change",{bubbles:!0});I.call(m,r),m.dispatchEvent(_)}},[g,r]),e.jsx(ce.select,{...s,style:{...Fo,...s.style},ref:N,defaultValue:r})});ho.displayName=Aa;function fo(o){return o===""||o===void 0}function vo(o){const r=Vo(o),s=c.useRef(""),p=c.useRef(0),d=c.useCallback(g=>{const m=s.current+g;r(m),(function x(w){s.current=w,window.clearTimeout(p.current),w!==""&&(p.current=window.setTimeout(()=>x(""),1e3))})(m)},[r]),N=c.useCallback(()=>{s.current="",window.clearTimeout(p.current)},[]);return c.useEffect(()=>()=>window.clearTimeout(p.current),[]),[s,d,N]}function bo(o,r,s){const d=r.length>1&&Array.from(r).every(w=>w===r[0])?r[0]:r,N=s?o.indexOf(s):-1;let g=Ia(o,Math.max(N,0));d.length===1&&(g=g.filter(w=>w!==s));const x=g.find(w=>w.textValue.toLowerCase().startsWith(d.toLowerCase()));return x!==s?x:void 0}function Ia(o,r){return o.map((s,p)=>o[(r+p)%o.length])}var _a=Gt,Ta=Yt,Ra=Jt,Pa=Zt,za=Qt,Ma=eo,Oa=so,$a=io,La=lo,Fa=mo,Va=po,Ba=go;function ut({...o}){return e.jsx(_a,{"data-slot":"select",...o})}function mt({...o}){return e.jsx(Ra,{"data-slot":"select-value",...o})}function pt({className:o,children:r,...s}){return e.jsxs(Ta,{"data-slot":"select-trigger",className:Fe("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-full items-center justify-between rounded-md border bg-transparent px-3 py-2 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&>span]:line-clamp-1",o),...s,children:[r,e.jsx(Pa,{asChild:!0,children:e.jsx(Kt,{className:"size-4 opacity-50"})})]})}function gt({className:o,children:r,position:s="popper",...p}){return e.jsx(za,{children:e.jsxs(Ma,{"data-slot":"select-content",className:Fe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",o),position:s,...p,children:[e.jsx(Ua,{}),e.jsx(Oa,{className:Fe("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),e.jsx(Ha,{})]})})}function Qe({className:o,children:r,...s}){return e.jsxs($a,{"data-slot":"select-item",className:Fe("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",o),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Fa,{children:e.jsx(ea,{className:"size-4"})})}),e.jsx(La,{children:r})]})}function Ua({className:o,...r}){return e.jsx(Va,{"data-slot":"select-scroll-up-button",className:Fe("flex cursor-default items-center justify-center py-1",o),...r,children:e.jsx(aa,{className:"size-4"})})}function Ha({className:o,...r}){return e.jsx(Ba,{"data-slot":"select-scroll-down-button",className:Fe("flex cursor-default items-center justify-center py-1",o),...r,children:e.jsx(Kt,{className:"size-4"})})}const qa=o=>{switch(o){case"pendiente":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800";case"subido":return"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border-blue-200 dark:border-blue-800";case"vigente":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border-green-200 dark:border-green-800";case"caducado":return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-200 dark:border-orange-800";case"rechazado":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 border-red-200 dark:border-red-800";default:return"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-700"}},Ka=o=>{switch(o){case"pendiente":return e.jsx(Ht,{className:"w-4 h-4"});case"subido":return e.jsx(Le,{className:"w-4 h-4"});case"vigente":return e.jsx(Ne,{className:"w-4 h-4"});case"caducado":return e.jsx(Te,{className:"w-4 h-4"});case"rechazado":return e.jsx(ue,{className:"w-4 h-4"});case"subiendo":return e.jsx(Le,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-pulse"});case"procesando":return e.jsx($e,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"});case"analizando":return e.jsx(qt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"});case"completado":return e.jsx(Ne,{className:"w-4 h-4 text-green-600 dark:text-green-400"});case"error":return e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"});default:return e.jsx(_e,{className:"w-4 h-4"})}},jt=o=>{if(!o||o===0||isNaN(o))return"0 Bytes";const r=1024,s=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(o)/Math.log(r));return parseFloat((o/Math.pow(r,p)).toFixed(2))+" "+s[p]},tt=o=>{if(!o)return"Fecha no disponible";try{let r;if(o.includes("-"))if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[s,p,d]=o.split("-");r=new Date(parseInt(s),parseInt(p)-1,parseInt(d))}else r=new Date(o);else isNaN(Number(o))?r=new Date(o):r=new Date(Number(o));return isNaN(r.getTime())?"Fecha inválida":r.toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}catch(r){return console.error("Error formateando fecha:",o,r),"Fecha inválida"}},Vt=o=>{const r=o.fechaExpedicion,s=o.vigenciaDocumento;if(o.diasRestantesVigencia,!r&&!s)return`${jt(o.tamaño||0)} • ${tt(o.fechaSubida)}`;let p=jt(o.tamaño||0);return r&&(p+=` • ${tt(r)}`),p},xt=o=>{console.log("🔍 Documento completo:",{concepto:o.concepto,estado:o.estado,archivos:o.archivos}),o.archivos&&o.archivos.length>0&&o.archivos.forEach((s,p)=>{console.log(`📄 Archivo ${p+1}:`,{nombre:s.nombre,estado:s.estado,fechaExpedicion:s.fechaExpedicion,vigenciaDocumento:s.vigenciaDocumento,diasRestantesVigencia:s.diasRestantesVigencia,validacionIA:s.validacionIA})});const r=o.archivos?.find(s=>s.estado==="completado"&&(s.metadata?.vigencia_documento||s.vigenciaDocumento));if(r){const s=r.metadata?.vigencia_documento||r.vigenciaDocumento;if(s){const p=new Date(s),d=new Date,N=p.getTime()-d.getTime(),g=Math.ceil(N/(1e3*60*60*24)),m=r.metadata?.vigencia_documento?"BD (metadata)":"IA (JSON)";return console.log(`✅ Usando vigencia desde ${m}:`,s,"Días calculados:",g),{fecha:s,diasRestantes:g,esVigenciaReal:!0}}}return console.log("⚠️ No hay archivos con vigencia IA, usando fechaLimite:",o.fechaLimite),{fecha:o.fechaLimite,diasRestantes:null,esVigenciaReal:!1}},bs=({campusDelDirector:o,documentosRequeridos:r,campusSeleccionado:s,error:p})=>{console.log("=== PROPS RECIBIDAS AL CARGAR COMPONENTE ==="),console.log("campusDelDirector:",o?.length||0,o),console.log("documentosIniciales:",r?.length||0,r),console.log("campusInicial:",s),console.log("error:",p),r&&r.length>0&&(console.log("=== DETALLE DE DOCUMENTOS INICIALES ==="),r.forEach((t,n)=>{console.log(`Documento ${n+1}:`,{id:t.id,concepto:t.concepto,estado:t.estado,archivos:t.archivos,cantidad_archivos:t.archivos?.length||0}),t.archivos&&t.archivos.length>0?(console.log(`  Archivos del documento "${t.concepto}":`),t.archivos.forEach((a,i)=>{console.log(`    Archivo ${i+1}:`,{id:a.id,nombre:a.nombre,estado:a.estado,tamaño:a.tamaño,fechaSubida:a.fechaSubida})})):console.log(`  Documento "${t.concepto}" no tiene archivos`)}));const[d,N]=c.useState(s),g=(r||[]).map(t=>({...t,archivos:t.archivos||[]}));console.log("=== PROCESAMIENTO DOCUMENTOS CON ARCHIVOS ==="),console.log("documentosConArchivos procesados:",g.length),g.forEach((t,n)=>{console.log(`DocConArchivos ${n+1}: "${t.concepto}" - ${t.archivos?.length||0} archivos`)});const[m,x]=c.useState(g),[w,I]=c.useState(null),[_,V]=c.useState({}),[l,S]=c.useState(g[0]||null),[b,k]=c.useState("todos"),z=c.useRef(null),[y,T]=c.useState(""),[pe,W]=c.useState(!1),[je,O]=c.useState(0),[ie,F]=c.useState(""),[ge,ee]=c.useState(""),[K,ne]=c.useState(!1),[re,te]=c.useState(0),[J,oe]=c.useState(0),[le,de]=c.useState(new Set),[Be,ye]=c.useState(!1),[Ue,He]=c.useState(""),[ve,M]=c.useState(!1),[De,f]=c.useState(!1),[B,q]=c.useState(!1),[D,L]=c.useState(null),j=t=>t.uniqueKey||t.id,G=t=>t.archivos||[],be=t=>{const n=G(t);if(n.length===0)return!0;const a=U(t.estado);return a==="vigente"&&!H(t)?!1:a==="caducado"||H(t)?!0:!(n.find(h=>h.estado==="completado"&&(!h.validacionIA||h.validacionIA.coincide))&&t.estado!=="rechazado")},Ee=async()=>{if(!d){console.log("No hay campus actual, no se puede refrescar");return}try{console.log("=== REFRESCANDO DOCUMENTOS DESDE SERVIDOR ==="),console.log("Campus actual:",d.ID_Campus,d.Campus),console.log("Tipo de documento seleccionado:",xe),xe==="medicos"?await Ke():await qe()}catch(t){console.error("Error al refrescar documentos:",t),M(!1),f(!0),Ye(!1)}},qe=async()=>{if(!d){console.log("No hay campus actual para documentos legales");return}try{M(!0),f(!1);const t=await fetch(`/documentos/upload?campus=${d.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(t.ok){const n=await t.json();if(console.log("Respuesta del servidor (legales):",n),n.props?.documentosRequeridos){console.log("Documentos legales recibidos:",n.props.documentosRequeridos.length);const a=(n.props.documentosRequeridos||[]).map(i=>({...i,archivos:i.archivos||[]}));if(x(a),console.log("Documentos legales actualizados"),l){const i=a.find(h=>h.id===l.id);i&&(S(i),console.log("Documento seleccionado actualizado"))}else a.length>0&&(S(a[0]),console.log("Primer documento seleccionado por defecto"));f(!0),M(!1)}else console.log("No se recibieron documentos legales en la respuesta"),M(!1),f(!0)}else console.error("Error al actualizar documentos legales:",t.status,t.statusText),M(!1),f(!0)}catch(t){console.error("Error en refrescarDocumentosLegales:",t),M(!1),f(!0)}},Ke=async()=>{if(!d){console.log("No hay campus actual para documentos médicos");return}console.log("=== REFRESCANDO DOCUMENTOS MÉDICOS OPTIMIZADO ==="),console.log("Campus:",d.ID_Campus,d.Campus),M(!0),f(!1),Ye(!0);try{const t=Date.now();console.log("🔄 Realizando consulta optimizada...");const n=await fetch(`/documentos/medicos-optimizado?campus_id=${d.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!n.ok)throw new Error(`Error en la respuesta: ${n.status}`);const a=await n.json(),i=Date.now()-t;if(console.log(`⚡ Consulta optimizada completada en ${i}ms`),console.log("Respuesta optimizada:",a),!a.success||!a.carreras||!a.documentos_por_carrera){console.log("No se recibieron datos válidos de documentos médicos"),Me([]);return}const h=a.carreras,C=a.documentos_por_carrera;console.log(`📋 Procesando ${h.length} carreras médicas...`),We(h),console.log("🔄 Carreras médicas actualizadas en el estado:",h);const u=m.filter(P=>P.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(u.length===0){console.log("No se encontraron documentos base de cartas de intención"),Me([]);return}if(!h||h.length===0){console.log("No se recibieron carreras médicas"),Me([]);return}const R=[];if(h.forEach(P=>{const $=P.ID_Especialidad,A=P.Descripcion,v=C[$]||[];u.forEach(Y=>{const E=`${Y.id}_carrera_${$}`,Q=v.find(Ie=>Ie.id===Y.id),Ae={...Y,id:Y.id,documentoOriginalId:Y.id,uniqueKey:E,concepto:`${Y.concepto} - ${A}`,descripcion:`${Y.descripcion} para la carrera de ${A}`,carreraId:String($),carreraNombre:A,estado:Q?.estado||"pendiente",archivos:Q?.archivos||[]};console.log(`✅ Documento generado para ${A}:`,{uniqueKey:Ae.uniqueKey,estado:Ae.estado,totalArchivos:Ae.archivos?.length||0}),R.push(Ae)})}),console.log(`📚 Total documentos médicos generados: ${R.length}`),Me(R),console.log("📋 Documentos médicos actualizados en estado separado"),l&&l.uniqueKey){const P=R.find($=>$.uniqueKey===l.uniqueKey);P&&(S(P),console.log("Documento médico seleccionado actualizado"))}else R.length>0&&(S(R[0]),console.log("Primer documento médico seleccionado por defecto"))}catch(t){console.error("Error en consulta optimizada de documentos médicos:",t),Me([])}finally{f(!0),M(!1),Ye(!1)}},Ct=()=>{setTimeout(()=>{console.log("Actualizando panel automáticamente..."),Ee()},2e3)};c.useEffect(()=>{console.log("=== CARGA INICIAL DEL COMPONENTE ==="),console.log("Campus inicial:",s),console.log("Campus actual:",d),console.log("Documentos iniciales:",r?.length||0),M(!0),f(!1);const t=r?.every(a=>!a.archivos||a.archivos.length===0)||!1,n=!r||r.length===0;if(s&&(n||t))console.log(n?"Campus inicial detectado SIN documentos, refrescando desde servidor...":"Campus inicial detectado con documentos VACÍOS (sin archivos), refrescando desde servidor..."),(async()=>{try{console.log("=== REFRESCANDO DOCUMENTOS CARGA INICIAL ==="),console.log("Campus inicial:",s.ID_Campus,s.Campus);const i=await fetch("/documentos/cambiar-campus",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({campus_id:s.ID_Campus})});if(i.ok){const h=await i.json();if(console.log("Respuesta del servidor (carga inicial):",h),h.documentos){console.log("Documentos recibidos (carga inicial):",h.documentos.length);const C=(h.documentos||[]).map(u=>({...u,archivos:u.archivos||[]}));x(C),console.log("Documentos estado actualizado (carga inicial)"),C.length>0&&(S(C[0]),console.log("Primer documento seleccionado por defecto (carga inicial)")),f(!0),M(!1)}else console.log("No se recibieron documentos en la respuesta (carga inicial)"),M(!1),f(!0)}else console.error("Error al cargar documentos iniciales:",i.status,i.statusText),M(!1),f(!0)}catch(i){console.error("Error al refrescar documentos (carga inicial):",i),M(!1),f(!0)}})();else if(s&&r&&r.length>0&&!t){if(console.log("Campus inicial detectado CON documentos válidos Y CON ARCHIVOS, usando documentos iniciales..."),console.log("Documentos iniciales disponibles:",r.length),console.log("Estado documentos actual:",m.length),console.log("Documento seleccionado actual:",l?.concepto||"ninguno"),!l&&m.length>0)console.log("Seleccionando primer documento por defecto:",m[0].concepto),S(m[0]);else if(!l&&r.length>0){const a={...r[0],archivos:r[0].archivos||[]};console.log("Fallback: Seleccionando primer documento de documentos iniciales:",a.concepto),S(a)}else l&&console.log("Ya hay un documento seleccionado:",l.concepto);f(!0),M(!1)}else if(console.log("No hay campus inicial, usando documentos proporcionados"),r&&r.length>0){const a=r.map(i=>({...i,archivos:i.archivos||[]}));console.log("Actualizando estado con documentos proporcionados"),x(a),!l&&a.length>0&&(console.log("Seleccionando primer documento por defecto"),S(a[0])),f(!0),M(!1)}else M(!1),f(!0)},[]),c.useEffect(()=>{console.log("=== ESTADO DOCUMENTOS CAMBIÓ ==="),console.log("Documentos en estado:",m.length),console.log("Documento seleccionado:",l?.concepto||"ninguno"),m.length>0&&(console.log("=== DETALLE DE DOCUMENTOS EN ESTADO ==="),m.forEach((t,n)=>{const a=t.archivos?.length||0;console.log(`Estado Doc ${n+1}: "${t.concepto}" - ${a} archivos`),a>0&&t.archivos?.forEach((i,h)=>{console.log(`  Estado Archivo ${h+1}: ${i.nombre} (${i.estado})`)})})),m.length>0&&!l&&(console.log("Auto-seleccionando primer documento:",m[0].concepto),S(m[0]))},[m,l]),c.useEffect(()=>{console.log("=== VERIFICANDO ANALISIS DE ARCHIVOS ==="),console.log("Documentos actuales:",m.length);const t=m.flatMap(n=>(n.archivos||[]).filter(a=>a.estado==="completado"&&!a.fechaExpedicion&&!a.vigenciaDocumento));console.log("Archivos completados sin analisis:",t.length),t.forEach(n=>{console.log(`- ${n.nombre} (${n.estado})`)}),t.length>0?console.log("Archivos completados detectados, datos deberían venir del backend"):console.log("Todos los archivos ya tienen analisis o no hay archivos completados")},[m]),c.useEffect(()=>{if(l){const t=m.find(n=>j(n)===j(l));t&&t.archivos?.some((a,i)=>{const h=l.archivos?.[i];return h&&(a.fechaExpedicion!==h.fechaExpedicion||a.vigenciaDocumento!==h.vigenciaDocumento||a.diasRestantesVigencia!==h.diasRestantesVigencia)})&&(console.log("🔄 FECHAS ACTUALIZADAS DETECTADAS - Actualizando selectedDocumento"),S(t))}},[m]),c.useEffect(()=>{d&&d.ID_Campus&&(console.log("=== CAMPUS ACTUAL CAMBIÓ ==="),console.log("Nuevo campus actual:",d.ID_Campus,d.Campus),console.log("Documentos actuales:",m.length),m.length===0?(console.log("No hay documentos, refrescando..."),Ee()):console.log("Ya hay documentos cargados, no refrescando automáticamente"))},[d]);const No=(t,n)=>{t.validacionIA&&!t.validacionIA.coincide&&(L({fileName:t.nombre,documentType:n,reason:t.validacionIA.razon||"Documento no válido",percentage:t.validacionIA.porcentaje||0,expectedType:n,detectedType:"Información de análisis IA"}),q(!0))},jo=t=>{const n=G(t);if(n.length===0)return"No hay archivos subidos para este documento";const a=U(t.estado);return a==="rechazado"?"El documento fue rechazado por un administrador. Puede subir un nuevo archivo.":a==="caducado"||H(t)?"El documento ha caducado por vencimiento de fecha. Puede subir un nuevo archivo.":a==="vigente"&&!H(t)?"Documento aprobado por administrador. No se pueden subir más archivos.":n.find(C=>C.estado==="completado"&&(!C.validacionIA||C.validacionIA.coincide))?"Documento validado automáticamente por IA. Esperando revisión del administrador.":n.find(C=>C.estado==="rechazado"||C.validacionIA&&!C.validacionIA.coincide)?"El documento anterior fue rechazado por validación automática. Puede subir un nuevo archivo.":"Puede subir archivos para este documento"},St=async t=>{console.log("=== CAMBIO DE CAMPUS ==="),console.log("Nuevo campus ID:",t),M(!0),f(!1);try{const n=await lt("/documentos/cambiar-campus",{method:"POST",body:JSON.stringify({campus_id:t})});if(n.ok){const a=await n.json();console.log("Respuesta del servidor:",a),N(a.campus),console.log("Campus actualizado:",a.campus);const i=a.documentos.map(h=>({...h,archivos:h.archivos||[]}));console.log("Documentos cargados:",i.length),x(i),S(i[0]||null),V({}),It("legales"),await kt(t),f(!0),M(!1)}else console.error("Error en la respuesta del servidor:",n.status,n.statusText),M(!1),f(!0)}catch(n){console.error("Error cambiando campus:",n),M(!1),f(!0)}},kt=async t=>{if(t){Et(!0);try{console.log(`=== VERIFICANDO CARRERAS MÉDICAS PARA CAMPUS ${t} ===`);const n=await lt(`/documentos/campus/${t}/medico`);if(n.ok){const a=await n.json();ct(a.tiene_carreras_medicas),We(a.carreras_medicas||[]),console.log(`✅ Campus ${t} tiene carreras médicas:`,a.tiene_carreras_medicas),console.log("📋 Carreras médicas disponibles:",a.carreras_medicas),(a.carreras_medicas||[]).forEach(i=>{console.log(`  - ID_Especialidad: ${i.ID_Especialidad}, Descripcion: ${i.Descripcion}`)})}else console.error("❌ Error verificando campus médico:",n.status),ct(!1),We([])}catch(n){console.error("❌ Error verificando campus médico:",n),ct(!1),We([])}finally{Et(!1)}}},yo=(t,n)=>{t.preventDefault(),I(n)},wo=t=>{t.preventDefault(),I(null)},Co=(t,n)=>{t.preventDefault(),I(null);const a=Array.from(t.dataTransfer.files);Dt(a,n)},Dt=(t,n)=>{console.log("=== HANDLE FILE SELECTION ==="),console.log("Files received:",t),console.log("DocumentoId:",n),console.log("Current selectedFiles before update:",_),V(a=>{const i={...a,[n]:[...a[n]||[],...t]};return console.log("Updated selectedFiles:",i),i})},So=(t,n)=>{if(console.log("=== HANDLE FILE INPUT CHANGE ==="),console.log("Event target files:",t.target.files),console.log("DocumentoId:",n),t.target.files){const a=Array.from(t.target.files);console.log("Files array:",a),console.log("Files length:",a.length),a.forEach((i,h)=>{console.log(`File ${h}:`,{name:i.name,size:i.size,type:i.type})}),Dt(a,n)}else console.log("❌ No files in event target")},ko=(t,n)=>{V(a=>({...a,[t]:a[t]?.filter((i,h)=>h!==n)||[]}))},Do=async t=>{console.log("INICIANDO UPLOAD - DocumentoKey:",t),console.log("Tipo de documento actual:",xe),console.log("DocumentosDelTipo disponibles:",he.length),he.forEach((i,h)=>{console.log(`  Doc ${h}: key="${j(i)}", uniqueKey="${i.uniqueKey}", id="${i.id}"`)});const n=_[t];console.log("Archivos a subir:",n),console.log("Estado completo selectedFiles:",_);const a=he.find(i=>j(i)===t);if(!a){console.error("Documento no encontrado con clave:",t),console.error("Claves disponibles:",he.map(i=>j(i))),alert("Error: Documento no encontrado");return}if(console.log("Documento encontrado:",{id:a.id,uniqueKey:a.uniqueKey,documentoOriginalId:a.documentoOriginalId,carreraId:a.carreraId,carreraNombre:a.carreraNombre}),!n||n.length===0){console.log("No hay archivos para subir"),alert("No hay archivos seleccionados. Por favor selecciona un archivo primero.");return}if(!d?.ID_Campus){console.error("No hay campus seleccionado"),alert("No hay campus seleccionado");return}console.log("Campus actual:",d.ID_Campus),W(!0),O(0),F("Preparando archivos..."),ne(!1),te(0),oe(n.length),V(i=>({...i,[t]:[]})),console.log(`Procesando ${n.length} archivo(s)...`);for(let i=0;i<n.length;i++){const h=n[i];console.log(`Procesando archivo ${i+1}/${n.length}: ${h.name}`),ee(h.name),F(`Subiendo ${h.name}...`),O(10);try{const C=new FormData;C.append("archivo",h);const u=a.documentoOriginalId||a.id;C.append("documento_id",u.toString()),C.append("campus_id",d.ID_Campus),console.log("Usando documento_id para backend:",u,"(original:",a.documentoOriginalId,", compuesto:",a.id,")"),a.carreraId&&(C.append("carrera_id",a.carreraId),console.log("Agregando carrera_id (ID_Especialidad):",a.carreraId,"para carrera:",a.carreraNombre)),console.log("=== DEBUG FORMDATA ===");for(let v of C.entries())console.log(v[0]+":",v[1]);await new Promise(v=>setTimeout(v,500)),O(25),F(`Validando ${h.name}...`),await new Promise(v=>setTimeout(v,500)),O(50),F(`Guardando ${h.name} en servidor...`),await new Promise(v=>setTimeout(v,500)),O(75),F(`Finalizando subida de ${h.name}...`),console.log("Iniciando petición de subida real...");const R=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");console.log("CSRF Token:",R);const P=new FormData;P.append("archivo",h),P.append("documento_id",u.toString()),P.append("campus_id",d.ID_Campus),a.carreraId&&P.append("carrera_id",a.carreraId),console.log("Testing with fresh FormData:");for(let v of P.entries())console.log(`  ${v[0]}:`,v[1]),v[1]instanceof File&&console.log(`    File details: name=${v[1].name}, size=${v[1].size}, type=${v[1].type}`);const $=await fetch("/documentos/subir-archivo",{method:"POST",headers:{"X-CSRF-TOKEN":R||""},body:P});console.log("Status de respuesta:",$.status,$.statusText),console.log("Headers de respuesta:",$.headers);const A=await $.text();if(console.log("Respuesta RAW del servidor:",A),$.ok)try{const v=JSON.parse(A);if(console.log("Respuesta parseada exitosamente:",v),!v.archivo||!v.archivo.estado){console.error("El servidor no procesó el archivo correctamente"),console.error("data.archivo:",v.archivo),F("Error: El archivo no se procesó correctamente en el servidor"),W(!1);return}O(100),F(`${h.name} subido exitosamente`),te(E=>E+1),v.archivo.estado==="analizando"&&(F(`Analizando ${h.name} con IA...`),O(100),await new Promise(E=>setTimeout(E,2e3)));const Y={id:v.archivo.id,nombre:h.name,tamaño:v.archivo.tamaño||h.size||0,fechaSubida:new Date().toISOString().split("T")[0],estado:v.archivo.estado==="analizando"?"analizando":"completado",progreso:100,mensaje:v.archivo.estado==="analizando"?"Analizando con IA...":"Completado"};x(E=>E.map(Q=>j(Q)===t?{...Q,estado:"subido",archivos:[...G(Q),Y]}:Q)),l&&j(l)===t&&S(E=>E&&{...E,estado:"subido",archivos:[...G(E),Y]}),de(E=>new Set(E).add(v.archivo.id)),setTimeout(()=>{de(E=>{const Q=new Set(E);return Q.delete(v.archivo.id),Q})},5e3),console.log("Archivo agregado inmediatamente al panel:",Y),v.archivo.estado==="analizando"&&Io(v.archivo.id,t,1),console.log("Programando actualización automática del panel..."),Ct()}catch(v){console.error("Error parseando JSON:",v),console.error("Respuesta no es JSON válido:",A),F("Error: El servidor devolvió una respuesta inválida"),W(!1);return}else{console.log("Status de error:",$.status,$.statusText),console.log("Respuesta RAW de error:",A);try{const v=JSON.parse(A);console.error("Error subiendo archivo:",v),v.validation_errors&&(console.error("Errores de validación específicos:"),Object.keys(v.validation_errors).forEach(Y=>{console.error(`  - ${Y}: ${v.validation_errors[Y]}`)})),v.debug_info&&console.error("Debug info:",v.debug_info),F(`Error al subir ${h.name}: ${v.error||"Error desconocido"}`)}catch(v){console.error("Error parseando respuesta de error:",v),console.error("Respuesta de error no es JSON válido:",A),F(`Error al subir ${h.name}: Error del servidor (${$.status})`)}O(0),await new Promise(v=>setTimeout(v,2e3))}}catch(C){console.error("Error en upload:",C),F(`Error de conexión con ${h.name}`),O(0),M(!1),f(!0),Ye(!1),await new Promise(u=>setTimeout(u,2e3))}}ne(!0),O(100),F(`Todos los archivos procesados exitosamente (${re+1}/${n.length})`),ee(""),await new Promise(i=>setTimeout(i,3e3)),W(!1),ne(!1),O(0),F(""),ee(""),te(0),oe(0),console.log("Proceso de subida completado exitosamente")},[rt,ze]=c.useState(new Set),[Eo,ct]=c.useState(!1),[Ao,Et]=c.useState(!1),[At,We]=c.useState([]),[it,Me]=c.useState([]),[Ga,Ye]=c.useState(!1),[xe,It]=c.useState("legales");c.useEffect(()=>()=>{console.log("Limpiando monitores activos al desmontar componente"),ze(new Set)},[]),c.useEffect(()=>{d?.ID_Campus&&kt(d.ID_Campus)},[d]),c.useEffect(()=>{d&&(console.log(`🔄 Tipo de documento cambió a: ${xe} - Refrescando estado...`),M(!0),f(!1),Me([]),xe==="medicos"?Ee():(f(!0),M(!1)))},[xe,d]);const Io=async(t,n,a=2)=>{if(rt.has(t)){console.log(`Ya existe un monitor activo para archivo ${t}`);return}ze(C=>new Set(C).add(t));let i=0;const h=async()=>{i++;try{console.log(`Verificando análisis para archivo ${t} - Intento ${i}/${a}`);const C=await lt(`/documentos/analisis/estado?archivo_id=${t}`,{method:"GET"});if(C.ok){const u=await C.json();if(console.log("Estado del análisis:",u),x(R=>R.map(P=>{if(j(P)===n){const $=G(P).map(E=>{if(E.id===t){const Q=u.tiene_analisis;let Ae=Q?"completado":"analizando",Ie="";if(u.estado==="rechazado"||Q&&u.analisis&&u.analisis.validacion&&!u.analisis.validacion.coincide){Ae="rechazado";let we="";u.analisis&&u.analisis.validacion?we=u.analisis.validacion.razon:u.analisis&&u.analisis.documento?we=u.analisis.documento.observaciones:we="Documento no cumple con los requisitos",Ie=`Documento rechazado: ${we}`;const Mt=m.find(Ro=>j(Ro)===n);L({fileName:E.nombre,documentType:Mt?.concepto||"Documento",reason:we,percentage:0,expectedType:u.analisis?.validacion?.documento_esperado||Mt?.concepto||"Tipo de documento requerido",detectedType:u.analisis?.validacion?.documento_detectado||u.analisis?.documento?.nombre_detectado||u.documento?.tipo_detectado||"Tipo no identificado",cityValidation:u.analisis?.validacion?.ciudad_campus?{campusCity:u.analisis.validacion.ciudad_campus,documentCities:u.analisis.validacion.ciudades_documento||[],isValid:u.analisis.validacion.coincide||!1,details:u.analisis.validacion.evaluacion_gpt==="ciudad_incorrecta"?"El documento pertenece a una ciudad diferente a la del campus seleccionado":void 0}:void 0}),q(!0)}else if(Q&&u.analisis&&u.analisis.validacion){let we=`Documento validado correctamente (${u.analisis.validacion.porcentaje_coincidencia}% coincidencia)`;u.analisis.validacion.ciudad_campus&&u.analisis.validacion.ciudades_documento&&(we+=` • Ubicación: ${u.analisis.validacion.ciudad_campus} ✓`),Ie=we}else Q?Ie="Análisis IA completado":Ie=`Analizando documento... (${i}/${a})`;return{...E,estado:Ae,mensaje:Ie,validacionIA:u.analisis?.validacion?{coincide:u.analisis.validacion.coincide,porcentaje:u.analisis.validacion.porcentaje_coincidencia,razon:u.analisis.validacion.razon,accion:u.analisis.validacion.accion}:void 0,fechaExpedicion:u.analisis?.documento?.fecha_expedicion,vigenciaDocumento:u.analisis?.documento?.vigencia_documento,diasRestantesVigencia:u.analisis?.documento?.dias_restantes_vigencia,metadata:u.metadata?{folio_documento:u.metadata.folio_documento,fecha_expedicion:u.metadata.fecha_expedicion,vigencia_documento:u.metadata.vigencia_documento,lugar_expedicion:u.metadata.lugar_expedicion}:void 0}}return E});let A=P.estado;const v=$.find(E=>E.estado==="completado"&&(!E.validacionIA||E.validacionIA.coincide));return $.find(E=>E.estado==="rechazado"||E.estado==="completado"&&E.validacionIA&&!E.validacionIA.coincide)?(A="rechazado",console.log("Documento rechazado - cambiando estado inmediatamente")):v?(A="vigente",console.log("Documento aprobado - cambiando a vigente")):$.some(E=>E.estado==="completado")&&(A="subido",console.log("Documento subido")),{...P,estado:A,archivos:$}}return P})),l&&j(l)===n&&S(R=>{if(R&&m.find($=>j($)===n)){const $=u.estado==="rechazado"||u.analisis?.validacion&&!u.analisis.validacion.coincide,A={...R,estado:$?"rechazado":u.analisis?.validacion?.coincide?"vigente":R.estado,archivos:R.archivos?.map(v=>{if(v.id===t){const Y=$?"rechazado":u.tiene_analisis?"completado":"analizando";return{...v,estado:Y,validacionIA:u.analisis?.validacion?{coincide:u.analisis.validacion.coincide,porcentaje:u.analisis.validacion.porcentaje_coincidencia,razon:u.analisis.validacion.razon,accion:u.analisis.validacion.accion}:void 0,fechaExpedicion:u.analisis?.documento?.fecha_expedicion,vigenciaDocumento:u.analisis?.documento?.vigencia_documento,diasRestantesVigencia:u.analisis?.documento?.dias_restantes_vigencia}}return v})||[]};return console.log("Actualizando selectedDocumento en tiempo real:",A),A}return R}),u.tiene_analisis||i>=a){if(console.log(`Finalizando monitoreo para archivo ${t}. Análisis completado: ${u.tiene_analisis}, Intentos: ${i}`),ze(R=>{const P=new Set(R);return P.delete(t),P}),u.tiene_analisis){console.log("Análisis IA completado - Actualizando panel..."),console.log("📅 FECHAS RECIBIDAS DEL ANÁLISIS:",{fecha_expedicion:u.analisis?.documento?.fecha_expedicion,vigencia_documento:u.analisis?.documento?.vigencia_documento,dias_restantes:u.analisis?.documento?.dias_restantes_vigencia});const R=m.find(A=>j(A)===n),P=R?.archivos?.find(A=>A.id===t);if(u.estado==="rechazado"||u.analisis&&u.analisis.validacion&&!u.analisis.validacion.coincide)console.log("Documento rechazado - Actualizando interfaz inmediatamente"),setTimeout(()=>{x(A=>[...A])},100);else if(u.analisis?.validacion?.coincide){console.log("Documento aprobado por IA - Mostrando notificación de éxito");const A=R?.archivos?.find(v=>v.id===t);He(`${A?.nombre||"Documento"} validado exitosamente`),ye(!0),setTimeout(()=>ye(!1),4e3),setTimeout(()=>{console.log("🔄 Forzando re-render para actualizar fechas en UI"),S(v=>v&&{...v})},500)}Ct()}!u.tiene_analisis&&i>=a&&(console.warn(`Timeout en análisis de archivo ${t} después de ${a} intentos`),x(R=>R.map(P=>{if(j(P)===n){const $=G(P).map(A=>A.id===t?{...A,estado:"error"}:A);return{...P,archivos:$}}return P})));return}setTimeout(h,2e3)}else console.error(`Error en petición de estado: ${C.status}`),i<a?setTimeout(h,2e3):ze(u=>{const R=new Set(u);return R.delete(t),R})}catch(C){console.error("Error monitoreando análisis:",C),i<a?setTimeout(h,3e3):(console.error(`Error persistente en monitoreo de archivo ${t}, cancelando.`),ze(u=>{const R=new Set(u);return R.delete(t),R}))}};h()},_o=()=>{console.log("Deteniendo todos los monitores manualmente"),ze(new Set),x(t=>t.map(n=>({...n,archivos:G(n).map(a=>a.estado==="analizando"?{...a,estado:"error"}:a)})))},_t=t=>{const n=new Date,i=new Date(t).getTime()-n.getTime();return Math.ceil(i/(1e3*60*60*24))},To=t=>t<0?"text-red-600":t<=7?"text-orange-600":t<=30?"text-yellow-600":"text-green-600",U=t=>{const n=t.toLowerCase();return console.log("🔄 Estado original:",t,"-> normalizado:",n),n},H=t=>{const n=U(t.estado);if(n==="caducado")return console.log("✅ Documento marcado como caducado en BD:",t.concepto),!0;const a=xt(t),i=a.diasRestantes!==null?a.diasRestantes:_t(t.fechaLimite),h=n==="vigente"&&i<0;return h&&console.log("⏰ Documento caducado dinámicamente:",t.concepto,"Días restantes:",i),h},Tt=t=>{if(H(t))return"bg-orange-100 text-orange-800 border-orange-300";const n=U(t.estado);return qa(n)},Rt=t=>{if(H(t))return e.jsx(Te,{className:"w-3 h-3"});const n=U(t.estado);return Ka(n)},Pt=t=>H(t)?"caducado":U(t.estado),zt=m.filter(t=>{const n=t.concepto.toLowerCase().includes(y.toLowerCase())||t.descripcion.toLowerCase().includes(y.toLowerCase());let a=!1;const i=U(t.estado);return b==="todos"?a=!0:b==="subido"?a=i==="subido"||i==="vigente"||i==="caducado"||H(t):a=i===b||b==="caducado"&&H(t),n&&a}),he=(()=>{if(xe==="legales")return zt.filter(t=>!t.concepto.toLowerCase().includes("cartas de intención de campo clínico"));{if(it.length>0)return console.log("🔄 Usando documentos médicos con estado actualizado:",it.length),it;const t=zt.filter(a=>a.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(t.length===0||At.length===0)return[];const n=[];return At.forEach(a=>{t.forEach(i=>{const h=`${i.id}_carrera_${a.ID_Especialidad}`,C={id:i.id,concepto:`${i.concepto} - ${a.Descripcion}`,descripcion:`${i.descripcion} para la carrera de ${a.Descripcion}`,fechaLimite:i.fechaLimite,estado:"pendiente",archivos:[],obligatorio:i.obligatorio,categoria:i.categoria,documentoOriginalId:i.id,uniqueKey:h,carreraId:String(a.ID_Especialidad),carreraNombre:a.Descripcion};console.log(`📄 Documento generado para ${a.Descripcion}:`,{uniqueKey:C.uniqueKey,carreraId:C.carreraId,carreraIdType:typeof C.carreraId,documentoOriginalId:C.documentoOriginalId}),n.push(C)})}),console.log(`📚 Total documentos médicos generados: ${n.length}`),n}})();return e.jsxs(Yo,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Documentos",href:"/documentos"},{title:"Subir Documentos",href:"/documentos/upload"}],children:[e.jsx(Po,{title:"Subida de Documentos",children:e.jsx("meta",{name:"csrf-token",content:document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""})}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[Be&&e.jsx("div",{className:"fixed top-4 right-4 z-40 animate-in slide-in-from-right-full duration-500",children:e.jsx(ae,{className:"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 shadow-lg",children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Archivo subido exitosamente"}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:Ue})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>ye(!1),className:"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-200 hover:bg-green-100 dark:hover:bg-green-900/50 h-6 w-6 p-0",children:e.jsx(Xe,{className:"w-3 h-3"})})]})})})}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",onClick:t=>t.preventDefault(),children:e.jsx(ae,{className:"w-96 mx-4 dark:bg-gray-800 dark:border-gray-700",onClick:t=>t.stopPropagation(),children:e.jsx(se,{className:"p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"relative",children:K?e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ne,{className:"w-12 h-12 text-green-600 animate-pulse"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-20 h-20 bg-green-600 rounded-full opacity-20 animate-ping"})})]}):e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx($e,{className:"w-16 h-16 text-blue-600 animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full opacity-20 animate-ping"})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`text-lg font-semibold ${K?"text-green-900 dark:text-green-100":"text-gray-900 dark:text-gray-100"}`,children:K?"Documentos Subidos Exitosamente":"Procesando Documentos"}),ge&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ge}),e.jsx("p",{className:`text-sm font-medium ${K?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`,children:ie}),K&&re>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("span",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:[re," de ",J," archivo(s) procesado(s) exitosamente"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Progreso"}),e.jsxs("span",{children:[je,"%"]})]}),e.jsx(Ot,{value:je,className:`h-3 ${K?"bg-green-100 dark:bg-green-900/30":"dark:bg-gray-700"}`})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:K?"Los documentos se están procesando en segundo plano...":"Por favor espera mientras procesamos tus documentos..."}),K&&e.jsxs(Z,{onClick:()=>{W(!1),ne(!1),O(0),F(""),ee(""),te(0),oe(0)},className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Continuar"]})]})})})}),B&&D&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",onClick:t=>t.preventDefault(),children:e.jsxs(ae,{className:"w-full max-w-2xl bg-white dark:bg-gray-800 shadow-xl dark:border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx(Je,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-lg text-gray-900 dark:text-gray-100",children:"Documento Rechazado"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Validación automática"})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>q(!1),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 h-8 w-8 p-0",children:e.jsx(Xe,{className:"w-4 h-4"})})]})}),e.jsxs(se,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Archivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg",children:D.fileName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Motivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border-l-4 border-red-400 dark:border-red-600",children:D.reason})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Esperado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900/20 p-2 rounded text-center",children:D.expectedType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Detectado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-orange-50 dark:bg-orange-900/20 p-2 rounded text-center",children:D.detectedType})]})]}),D.cityValidation&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Validación de Ubicación:"}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Campus:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["📍 ",D.cityValidation.campusCity]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Documento de:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["🏙️ ",D.cityValidation.documentCities.join(", ")||"No detectado"]})]})]}),D.cityValidation.details&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-yellow-800",children:[e.jsx(ue,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:D.cityValidation.details})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"¿Qué hacer?"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Suba el documento correcto o contacte al administrador si considera que es un error."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Z,{variant:"outline",onClick:()=>q(!1),className:"flex-1",children:"Cerrar"}),e.jsxs(Z,{onClick:()=>{q(!1),(l?document.getElementById(`file-input-${j(l)}`):null)?.scrollIntoView({behavior:"smooth"})},className:"flex-1",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Subir Documento Correcto"]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-2 dark:text-gray-100",children:"Subir Documentos"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Selecciona un campus y un documento de la lista para subir los archivos requeridos"})]}),rt.size>0&&e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-spin"}),e.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:[rt.size," análisis en curso"]})]}),e.jsxs(Z,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 hover:bg-blue-100 dark:hover:bg-blue-900/50",onClick:_o,children:[e.jsx(Xe,{className:"w-3 h-3 mr-1"}),"Detener"]})]})]})}),(!o||!Array.isArray(o)||o.length===0)&&e.jsx(ae,{className:"mb-6 border-destructive",children:e.jsx(se,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("p",{className:"font-medium",children:p||"No tienes campus asignados para subir documentos"})]})})}),d&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 mb-6",children:[e.jsx(ae,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Total ",xe==="medicos"?"Médicos":"Legales"]}),e.jsx("p",{className:"text-2xl font-bold",children:he.length})]})]})})}),e.jsx(ae,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="pendiente").length})]})]})})}),e.jsx(ae,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Completados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="vigente"&&!H(t)).length})]})]})})}),e.jsx(ae,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Caducados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="caducado"||H(t)).length})]})]})})}),e.jsx(ae,{children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Rechazados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="rechazado").length})]})]})})})]}),d&&e.jsxs(e.Fragment,{children:[ve&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(ae,{className:"h-fit",children:[e.jsx(Je,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ze,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(ut,{value:d?.ID_Campus||"",onValueChange:St,children:[e.jsx(pt,{className:"w-52",children:e.jsx(mt,{placeholder:"Selecciona campus"})}),e.jsx(gt,{children:[...o].sort((t,n)=>t.Campus.localeCompare(n.Campus,"es",{sensitivity:"base"})).map(t=>e.jsx(Qe,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]})}),e.jsx(se,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx($e,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Cargando Documentos"}),e.jsx("p",{className:"text-sm text-gray-500",children:xe==="medicos"?"Obteniendo estados de documentos médicos...":"Obteniendo documentos legales..."})]})]})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(ae,{className:"h-fit",children:e.jsx(se,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto",children:e.jsx(_e,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Preparando Información"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Por favor espera mientras cargamos la información completa..."})]})]})})})})]}),!ve&&De&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(ae,{className:"h-fit",children:[e.jsxs(Je,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ze,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(ut,{value:d?.ID_Campus||"",onValueChange:St,children:[e.jsx(pt,{className:"w-52",children:e.jsx(mt,{placeholder:"Selecciona campus"})}),e.jsx(gt,{children:[...o].sort((t,n)=>t.Campus.localeCompare(n.Campus,"es",{sensitivity:"base"})).map(t=>e.jsx(Qe,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"text-sm font-medium text-muted-foreground",children:"Tipo:"}),e.jsxs(ut,{value:xe,onValueChange:t=>{It(t)},children:[e.jsx(pt,{className:"w-40",children:e.jsx(mt,{})}),e.jsxs(gt,{children:[e.jsx(Qe,{value:"legales",children:"Legales"}),Eo&&e.jsx(Qe,{value:"medicos",children:"Médicos"})]})]}),Ao&&e.jsx($e,{className:"w-4 h-4 animate-spin text-blue-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Jo,{placeholder:"Buscar documento...",value:y,onChange:t=>T(t.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{variant:b==="todos"?"default":"outline",size:"sm",onClick:()=>k("todos"),children:"Todos"}),e.jsx(Z,{variant:b==="pendiente"?"default":"outline",size:"sm",onClick:()=>k("pendiente"),children:"Pendientes"}),e.jsx(Z,{variant:b==="subido"?"default":"outline",size:"sm",onClick:()=>k("subido"),children:"Subidos"})]})]})]})]}),e.jsx(se,{className:"p-0",children:e.jsx("div",{ref:z,className:"max-h-[600px] overflow-y-auto",children:he.map(t=>{const n=t.uniqueKey||t.id,a=l?.uniqueKey===n||l?.id===t.id&&!t.uniqueKey;return e.jsxs("div",{className:`p-4 border-b cursor-pointer transition-colors hover:bg-muted/50 ${a?"bg-primary/10 border-l-4 border-l-primary":""}`,onClick:i=>{i.preventDefault();const h=z.current?.scrollTop||0;S(t),requestAnimationFrame(()=>{z.current&&(z.current.scrollTop=h)})},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:t.concepto}),t.obligatorio&&e.jsx(Oe,{variant:"destructive",className:"text-xs ml-2",children:"Req."})]}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(Oe,{className:Tt(t),variant:"outline",children:[Rt(t),e.jsx("span",{className:"ml-1 capitalize text-xs",children:Pt(t)})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Te,{className:"w-3 h-3"}),(()=>{const i=xt(t),C=(i.diasRestantes!==null?i.diasRestantes:_t(t.fechaLimite))??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:tt(i.fecha)}),e.jsxs("span",{className:`font-medium ${To(C)}`,children:["(",C>=0?`${C}d`:`${Math.abs(C)}d vencido`,")"]})]})})()]})]},n)})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:l?e.jsxs(ae,{className:"h-fit dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs(Je,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"text-xl dark:text-gray-100",children:l.concepto}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mt-1",children:l.descripcion})]}),e.jsx(Oe,{className:Tt(l),children:e.jsxs("div",{className:"flex items-center gap-1",children:[Rt(l),e.jsx("span",{className:"capitalize",children:Pt(l)})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground dark:text-gray-400",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsxs("span",{children:["Vence: ",tt(xt(l).fecha)]})]}),l.obligatorio&&e.jsx(Oe,{variant:"destructive",className:"text-xs",children:"Documento Obligatorio"}),H(l)&&e.jsx(Oe,{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-300 dark:border-orange-800",children:"CADUCADO"}),l?.carreraNombre&&e.jsx(Oe,{variant:"secondary",className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400",children:l.carreraNombre})]})]}),e.jsxs(se,{className:"space-y-6",children:[G(l).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos subidos (",G(l).length,")"]}),e.jsx("div",{className:"space-y-2",children:G(l).map(t=>{const n=l?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,a=H(l);let i="";return le.has(t.id)?i="border-green-400 dark:border-green-600 bg-green-50 dark:bg-green-900/20 shadow-lg ring-2 ring-green-200 dark:ring-green-800 ring-opacity-50 animate-pulse":t.estado==="subiendo"||t.estado==="procesando"||t.estado==="analizando"?i="border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/20 shadow-lg":t.estado==="completado"?n?i="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":a?i="border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20":i="border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20":t.estado==="rechazado"?i="border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20 shadow-lg":t.estado==="error"?i="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":i="border-gray-200 dark:border-gray-700 dark:bg-gray-800/50",e.jsx("div",{className:`p-3 border rounded-lg transition-all duration-300 ${i}`,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:Vt(t)}),"                                                                    ",t.estado==="subiendo"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Le,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-bounce"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:t.mensaje||"Subiendo archivo..."}),e.jsxs("span",{className:"text-xs text-blue-500 dark:text-blue-400 font-bold",children:[t.progreso,"%"]})]}),e.jsx(Ot,{value:t.progreso,className:"h-3 bg-blue-100 dark:bg-blue-900/30"})]}),t.estado==="procesando"&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:t.mensaje||"Procesando documento..."})]})}),t.estado==="analizando"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:t.mensaje||"Analizando con IA..."})]}),e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:"procesando el documento..."})})]}),t.estado==="completado"&&e.jsxs(e.Fragment,{children:[(()=>{const h=l?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,C=H(l);return h?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Documento Rechazado"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 px-2 py-1 rounded",children:["No aprobado (",t.validacionIA.porcentaje,"%)"]})]}):C?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Te,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Documento Caducado"}),e.jsx("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 px-2 py-1 rounded",children:"Vencido - Requiere Renovación"})]}):e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ne,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Documento Vigente"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 px-2 py-1 rounded",children:["Aprobado (",t.validacionIA.porcentaje,"%)"]})]})})(),e.jsxs("div",{className:"mt-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:e.jsx(_e,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Vista Previa del Documento"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.nombre})]})]}),e.jsxs(Z,{variant:"outline",size:"sm",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Abrir Completo"]})]})}),e.jsxs("div",{className:"relative bg-gray-50 dark:bg-gray-900",children:[e.jsx("iframe",{src:`/documentos/archivo/${t.id}#toolbar=1&navpanes=0&scrollbar=1&view=FitH&zoom=125`,className:"w-full h-[700px] bg-white dark:bg-gray-900",title:`Preview de ${t.nombre}`,style:{backgroundColor:"#ffffff",border:"none",borderRadius:"0"},onError:()=>{console.log("Error cargando preview del PDF")},loading:"lazy",allowFullScreen:!0}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-all duration-300 pointer-events-none",children:e.jsxs("div",{className:"text-center text-white bg-gray-900 dark:bg-gray-800 bg-opacity-80 p-6 rounded-lg backdrop-blur-sm",children:[e.jsx(_e,{className:"w-16 h-16 mx-auto mb-4 text-blue-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Documento PDF Validado"}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Haz clic para abrir en una nueva ventana"}),e.jsxs(Z,{variant:"secondary",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 pointer-events-auto bg-white text-gray-900 hover:bg-gray-100",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Ver en Nueva Ventana"]})]})})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:e.jsx("div",{className:"flex items-center gap-4 text-xs",children:e.jsx("span",{children:Vt(t)})})})})]})]}),t.estado==="rechazado"&&e.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Documento Rechazado"})]}),t.validacionIA&&e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>No(t,l.concepto),className:"text-red-600 hover:text-red-800 hover:bg-red-100 h-6 px-2",children:e.jsx("span",{className:"text-xs",children:"Ver detalles"})})]}),t.validacionIA&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium mb-1",children:"Motivo del rechazo:"}),e.jsx("p",{className:"text-xs text-red-700",children:t.validacionIA.razon}),t.validacionIA.porcentaje!==void 0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Coincidencia: ",t.validacionIA.porcentaje,"%"]})]})]}),t.estado==="error"&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:t.mensaje||"Error en proceso"})]})]})})})},t.id)})})]}),(_[j(l)]||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos seleccionados (",(_[j(l)]||[]).length,")"]}),e.jsx("div",{className:"space-y-2",children:(_[j(l)]||[]).map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 dark:border-primary/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:jt(t.size)})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>ko(j(l),n),className:"text-destructive hover:text-destructive dark:text-red-400 dark:hover:text-red-300",children:e.jsx(Xe,{className:"w-4 h-4"})})]},n))}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(Z,{onClick:()=>Do(j(l)),children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Subir Archivos (",(_[j(l)]||[]).length,")"]}),e.jsx(Z,{variant:"outline",onClick:()=>V(t=>({...t,[j(l)]:[]})),children:"Cancelar"})]})]}),(U(l.estado)!=="vigente"||H(l))&&be(l)?e.jsxs("div",{className:`
                                                border-2 border-dashed rounded-lg p-8 text-center transition-colors
                                                ${w===j(l)?"border-primary bg-primary/5 dark:bg-primary/10":"border-muted-foreground/25 hover:border-muted-foreground/50 dark:border-gray-700 dark:hover:border-gray-600"}
                                            `,onDragOver:t=>yo(t,j(l)),onDragLeave:wo,onDrop:t=>Co(t,j(l)),children:[e.jsx(Le,{className:`
                                                w-12 h-12 mx-auto mb-4
                                                ${w===j(l)?"text-primary":"text-muted-foreground dark:text-gray-400"}
                                            `}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Arrastra archivos aquí"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mb-4 text-sm",children:"o haz clic para seleccionar archivos"}),e.jsx("input",{type:"file",id:`file-input-${j(l)}`,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:t=>So(t,j(l))}),e.jsxs(Z,{variant:"outline",onClick:()=>{document.getElementById(`file-input-${j(l)}`)?.click()},children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),"Seleccionar Archivos"]}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-3",children:"Formatos: PDF, DOC, DOCX, JPG, PNG (máx. 10MB)"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-8 text-center bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:U(l.estado)==="vigente"&&!H(l)?e.jsx(Ne,{className:"w-12 h-12 text-green-600 dark:text-green-400"}):U(l.estado)==="rechazado"?e.jsx(ue,{className:"w-12 h-12 text-red-600 dark:text-red-400"}):U(l.estado)==="caducado"||H(l)?e.jsx(Te,{className:"w-12 h-12 text-orange-600 dark:text-orange-400"}):e.jsx(ue,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"font-semibold mb-2 text-gray-700 dark:text-gray-200",children:U(l.estado)==="vigente"&&!H(l)?"Documento Aprobado":U(l.estado)==="rechazado"?"Documento Rechazado - Puede Subir Nuevo":U(l.estado)==="caducado"||H(l)?"Documento Caducado - Puede Subir Nuevo":"Subida Bloqueada"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:jo(l)}),U(l.estado)==="vigente"&&!H(l)&&e.jsxs("div",{className:"bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg p-3 text-green-800 dark:text-green-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha sido validado y aprobado."}),e.jsx("p",{className:"text-xs mt-1 text-green-700 dark:text-green-400",children:"No se pueden realizar más cambios a menos que sea rechazado por un administrador."})]}),U(l.estado)==="rechazado"&&e.jsxs("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3 text-red-800 dark:text-red-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento fue rechazado por un administrador."}),e.jsx("p",{className:"text-xs mt-1 text-red-700 dark:text-red-400",children:"Por favor, revise los comentarios y suba una nueva versión."})]}),(U(l.estado)==="caducado"||H(l))&&e.jsxs("div",{className:"bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800 rounded-lg p-3 text-orange-800 dark:text-orange-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha caducado por vencimiento de fecha."}),e.jsx("p",{className:"text-xs mt-1 text-orange-700 dark:text-orange-400",children:"Puede subir una nueva versión actualizada del documento."})]})]})]})]}):e.jsx(ae,{className:"h-full dark:bg-gray-800 dark:border-gray-700",children:e.jsx(se,{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_e,{className:"w-12 h-12 text-muted-foreground dark:text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Selecciona un documento"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 text-sm",children:"Elige un documento de la lista para comenzar a subir archivos"})]})})})})]})]})]})]})};export{bs as default};
