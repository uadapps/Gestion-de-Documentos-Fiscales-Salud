import{a as c,j as e,H as Po,c as lt}from"./app-B1ODgQz_.js";import{c as Bt,u as zo,R as Mo,a as yt,b as Oo,d as $o,P as Lo,V as Fo,e as Vo,h as Bo,f as Uo,g as Ho,F as qo,D as Ko,C as Go,i as Wo,A as Yo,X as Xe,U as Le}from"./app-layout-BePWdC8U.js";import{C as se,c as ae,a as Je,b as Ze}from"./card-jy9OEvrH.js";import{u as fe,a as Xo,c as Fe,B as Z}from"./button-DP5tUSPz.js";import{B as Oe}from"./badge-gWJcIfya.js";import{P as Ot}from"./progress-C5hEAdK3.js";import{I as Jo}from"./input-CDV7X_4s.js";import{L as dt}from"./label-D3zBpzSK.js";import{P as ce,r as Ut}from"./index-y3NtH9uY.js";import{u as $t,c as Zo,a as X,d as Ce}from"./index-BzK5dBHK.js";import{u as Qo}from"./index-Jzgeed5P.js";import{c as ot}from"./createLucideIcon-Vv1GCiNt.js";import{C as es}from"./check-B6n4jFyf.js";import{C as Ne,F as Te}from"./file-text-DVQmmY0m.js";import{L as $e}from"./loader-circle-BVS40C0C.js";import{C as ue}from"./circle-alert-AvzmIc_q.js";import{C as Ht}from"./clock-Ca5Qd2F7.js";import{C as _e}from"./calendar-DSYTGsQK.js";import{B as qt}from"./brain-CB557DzK.js";import{E as Lt}from"./eye-DG7xEGkQ.js";/* empty css            */import"./index-u1-Hf6Gb.js";import"./index-DW9AIAM8.js";import"./log-out-Bhukg_6k.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kt=ot("ChevronDown",ts);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ss=ot("ChevronUp",os);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ns=ot("Plus",as);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],cs=ot("Search",rs);function Ft(o,[n,a]){return Math.min(a,Math.max(n,o))}var is=[" ","Enter","ArrowUp","ArrowDown"],ls=[" ","Enter"],Re="Select",[st,at,ds]=Oo(Re),[Ve]=Zo(Re,[ds,Bt]),nt=Bt(),[us,Se]=Ve(Re),[ms,ps]=Ve(Re),Gt=o=>{const{__scopeSelect:n,children:a,open:p,defaultOpen:d,onOpenChange:N,value:x,defaultValue:u,onValueChange:g,dir:w,name:I,autoComplete:T,disabled:V,required:l,form:S}=o,b=nt(n),[k,z]=c.useState(null),[y,_]=c.useState(null),[pe,W]=c.useState(!1),je=zo(w),[O,ie]=$t({prop:p,defaultProp:d??!1,onChange:N,caller:Re}),[F,ge]=$t({prop:x,defaultProp:u,onChange:g,caller:Re}),ee=c.useRef(null),K=k?S||!!k.closest("form"):!0,[ne,re]=c.useState(new Set),te=Array.from(ne).map(J=>J.props.value).join(";");return e.jsx(Mo,{...b,children:e.jsxs(us,{required:l,scope:n,trigger:k,onTriggerChange:z,valueNode:y,onValueNodeChange:_,valueNodeHasChildren:pe,onValueNodeHasChildrenChange:W,contentId:yt(),value:F,onValueChange:ge,open:O,onOpenChange:ie,dir:je,triggerPointerDownPosRef:ee,disabled:V,children:[e.jsx(st.Provider,{scope:n,children:e.jsx(ms,{scope:o.__scopeSelect,onNativeOptionAdd:c.useCallback(J=>{re(oe=>new Set(oe).add(J))},[]),onNativeOptionRemove:c.useCallback(J=>{re(oe=>{const le=new Set(oe);return le.delete(J),le})},[]),children:a})}),K?e.jsxs(ho,{"aria-hidden":!0,required:l,tabIndex:-1,name:I,autoComplete:T,value:F,onChange:J=>ge(J.target.value),disabled:V,form:S,children:[F===void 0?e.jsx("option",{value:""}):null,Array.from(ne)]},te):null]})})};Gt.displayName=Re;var Wt="SelectTrigger",Yt=c.forwardRef((o,n)=>{const{__scopeSelect:a,disabled:p=!1,...d}=o,N=nt(a),x=Se(Wt,a),u=x.disabled||p,g=fe(n,x.onTriggerChange),w=at(a),I=c.useRef("touch"),[T,V,l]=vo(b=>{const k=w().filter(_=>!_.disabled),z=k.find(_=>_.value===x.value),y=bo(k,b,z);y!==void 0&&x.onValueChange(y.value)}),S=b=>{u||(x.onOpenChange(!0),l()),b&&(x.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx($o,{asChild:!0,...N,children:e.jsx(ce.button,{type:"button",role:"combobox","aria-controls":x.contentId,"aria-expanded":x.open,"aria-required":x.required,"aria-autocomplete":"none",dir:x.dir,"data-state":x.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":fo(x.value)?"":void 0,...d,ref:g,onClick:X(d.onClick,b=>{b.currentTarget.focus(),I.current!=="mouse"&&S(b)}),onPointerDown:X(d.onPointerDown,b=>{I.current=b.pointerType;const k=b.target;k.hasPointerCapture(b.pointerId)&&k.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(S(b),b.preventDefault())}),onKeyDown:X(d.onKeyDown,b=>{const k=T.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&V(b.key),!(k&&b.key===" ")&&is.includes(b.key)&&(S(),b.preventDefault())})})})});Yt.displayName=Wt;var Xt="SelectValue",Jt=c.forwardRef((o,n)=>{const{__scopeSelect:a,className:p,style:d,children:N,placeholder:x="",...u}=o,g=Se(Xt,a),{onValueNodeHasChildrenChange:w}=g,I=N!==void 0,T=fe(n,g.onValueNodeChange);return Ce(()=>{w(I)},[w,I]),e.jsx(ce.span,{...u,ref:T,style:{pointerEvents:"none"},children:fo(g.value)?e.jsx(e.Fragment,{children:x}):N})});Jt.displayName=Xt;var gs="SelectIcon",Zt=c.forwardRef((o,n)=>{const{__scopeSelect:a,children:p,...d}=o;return e.jsx(ce.span,{"aria-hidden":!0,...d,ref:n,children:p||"▼"})});Zt.displayName=gs;var xs="SelectPortal",Qt=o=>e.jsx(Lo,{asChild:!0,...o});Qt.displayName=xs;var Pe="SelectContent",eo=c.forwardRef((o,n)=>{const a=Se(Pe,o.__scopeSelect),[p,d]=c.useState();if(Ce(()=>{d(new DocumentFragment)},[]),!a.open){const N=p;return N?Ut.createPortal(e.jsx(to,{scope:o.__scopeSelect,children:e.jsx(st.Slot,{scope:o.__scopeSelect,children:e.jsx("div",{children:o.children})})}),N):null}return e.jsx(oo,{...o,ref:n})});eo.displayName=Pe;var me=10,[to,ke]=Ve(Pe),hs="SelectContentImpl",fs=Xo("SelectContent.RemoveScroll"),oo=c.forwardRef((o,n)=>{const{__scopeSelect:a,position:p="item-aligned",onCloseAutoFocus:d,onEscapeKeyDown:N,onPointerDownOutside:x,side:u,sideOffset:g,align:w,alignOffset:I,arrowPadding:T,collisionBoundary:V,collisionPadding:l,sticky:S,hideWhenDetached:b,avoidCollisions:k,...z}=o,y=Se(Pe,a),[_,pe]=c.useState(null),[W,je]=c.useState(null),O=fe(n,f=>pe(f)),[ie,F]=c.useState(null),[ge,ee]=c.useState(null),K=at(a),[ne,re]=c.useState(!1),te=c.useRef(!1);c.useEffect(()=>{if(_)return Bo(_)},[_]),Uo();const J=c.useCallback(f=>{const[B,...q]=K().map(j=>j.ref.current),[D]=q.slice(-1),L=document.activeElement;for(const j of f)if(j===L||(j?.scrollIntoView({block:"nearest"}),j===B&&W&&(W.scrollTop=0),j===D&&W&&(W.scrollTop=W.scrollHeight),j?.focus(),document.activeElement!==L))return},[K,W]),oe=c.useCallback(()=>J([ie,_]),[J,ie,_]);c.useEffect(()=>{ne&&oe()},[ne,oe]);const{onOpenChange:le,triggerPointerDownPosRef:de}=y;c.useEffect(()=>{if(_){let f={x:0,y:0};const B=D=>{f={x:Math.abs(Math.round(D.pageX)-(de.current?.x??0)),y:Math.abs(Math.round(D.pageY)-(de.current?.y??0))}},q=D=>{f.x<=10&&f.y<=10?D.preventDefault():_.contains(D.target)||le(!1),document.removeEventListener("pointermove",B),de.current=null};return de.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",q,{capture:!0})}}},[_,le,de]),c.useEffect(()=>{const f=()=>le(!1);return window.addEventListener("blur",f),window.addEventListener("resize",f),()=>{window.removeEventListener("blur",f),window.removeEventListener("resize",f)}},[le]);const[Be,ye]=vo(f=>{const B=K().filter(L=>!L.disabled),q=B.find(L=>L.ref.current===document.activeElement),D=bo(B,f,q);D&&setTimeout(()=>D.ref.current.focus())}),Ue=c.useCallback((f,B,q)=>{const D=!te.current&&!q;(y.value!==void 0&&y.value===B||D)&&(F(f),D&&(te.current=!0))},[y.value]),He=c.useCallback(()=>_?.focus(),[_]),ve=c.useCallback((f,B,q)=>{const D=!te.current&&!q;(y.value!==void 0&&y.value===B||D)&&ee(f)},[y.value]),M=p==="popper"?ht:so,De=M===ht?{side:u,sideOffset:g,align:w,alignOffset:I,arrowPadding:T,collisionBoundary:V,collisionPadding:l,sticky:S,hideWhenDetached:b,avoidCollisions:k}:{};return e.jsx(to,{scope:a,content:_,viewport:W,onViewportChange:je,itemRefCallback:Ue,selectedItem:ie,onItemLeave:He,itemTextRefCallback:ve,focusSelectedItem:oe,selectedItemText:ge,position:p,isPositioned:ne,searchRef:Be,children:e.jsx(Ho,{as:fs,allowPinchZoom:!0,children:e.jsx(qo,{asChild:!0,trapped:y.open,onMountAutoFocus:f=>{f.preventDefault()},onUnmountAutoFocus:X(d,f=>{y.trigger?.focus({preventScroll:!0}),f.preventDefault()}),children:e.jsx(Ko,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:N,onPointerDownOutside:x,onFocusOutside:f=>f.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:e.jsx(M,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:f=>f.preventDefault(),...z,...De,onPlaced:()=>re(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...z.style},onKeyDown:X(z.onKeyDown,f=>{const B=f.ctrlKey||f.altKey||f.metaKey;if(f.key==="Tab"&&f.preventDefault(),!B&&f.key.length===1&&ye(f.key),["ArrowUp","ArrowDown","Home","End"].includes(f.key)){let D=K().filter(L=>!L.disabled).map(L=>L.ref.current);if(["ArrowUp","End"].includes(f.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(f.key)){const L=f.target,j=D.indexOf(L);D=D.slice(j+1)}setTimeout(()=>J(D)),f.preventDefault()}})})})})})})});oo.displayName=hs;var vs="SelectItemAlignedPosition",so=c.forwardRef((o,n)=>{const{__scopeSelect:a,onPlaced:p,...d}=o,N=Se(Pe,a),x=ke(Pe,a),[u,g]=c.useState(null),[w,I]=c.useState(null),T=fe(n,O=>I(O)),V=at(a),l=c.useRef(!1),S=c.useRef(!0),{viewport:b,selectedItem:k,selectedItemText:z,focusSelectedItem:y}=x,_=c.useCallback(()=>{if(N.trigger&&N.valueNode&&u&&w&&b&&k&&z){const O=N.trigger.getBoundingClientRect(),ie=w.getBoundingClientRect(),F=N.valueNode.getBoundingClientRect(),ge=z.getBoundingClientRect();if(N.dir!=="rtl"){const L=ge.left-ie.left,j=F.left-L,G=O.left-j,be=O.width+G,Ee=Math.max(be,ie.width),qe=window.innerWidth-me,Ke=Ft(j,[me,Math.max(me,qe-Ee)]);u.style.minWidth=be+"px",u.style.left=Ke+"px"}else{const L=ie.right-ge.right,j=window.innerWidth-F.right-L,G=window.innerWidth-O.right-j,be=O.width+G,Ee=Math.max(be,ie.width),qe=window.innerWidth-me,Ke=Ft(j,[me,Math.max(me,qe-Ee)]);u.style.minWidth=be+"px",u.style.right=Ke+"px"}const ee=V(),K=window.innerHeight-me*2,ne=b.scrollHeight,re=window.getComputedStyle(w),te=parseInt(re.borderTopWidth,10),J=parseInt(re.paddingTop,10),oe=parseInt(re.borderBottomWidth,10),le=parseInt(re.paddingBottom,10),de=te+J+ne+le+oe,Be=Math.min(k.offsetHeight*5,de),ye=window.getComputedStyle(b),Ue=parseInt(ye.paddingTop,10),He=parseInt(ye.paddingBottom,10),ve=O.top+O.height/2-me,M=K-ve,De=k.offsetHeight/2,f=k.offsetTop+De,B=te+J+f,q=de-B;if(B<=ve){const L=ee.length>0&&k===ee[ee.length-1].ref.current;u.style.bottom="0px";const j=w.clientHeight-b.offsetTop-b.offsetHeight,G=Math.max(M,De+(L?He:0)+j+oe),be=B+G;u.style.height=be+"px"}else{const L=ee.length>0&&k===ee[0].ref.current;u.style.top="0px";const G=Math.max(ve,te+b.offsetTop+(L?Ue:0)+De)+q;u.style.height=G+"px",b.scrollTop=B-ve+b.offsetTop}u.style.margin=`${me}px 0`,u.style.minHeight=Be+"px",u.style.maxHeight=K+"px",p?.(),requestAnimationFrame(()=>l.current=!0)}},[V,N.trigger,N.valueNode,u,w,b,k,z,N.dir,p]);Ce(()=>_(),[_]);const[pe,W]=c.useState();Ce(()=>{w&&W(window.getComputedStyle(w).zIndex)},[w]);const je=c.useCallback(O=>{O&&S.current===!0&&(_(),y?.(),S.current=!1)},[_,y]);return e.jsx(Ns,{scope:a,contentWrapper:u,shouldExpandOnScrollRef:l,onScrollButtonChange:je,children:e.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:pe},children:e.jsx(ce.div,{...d,ref:T,style:{boxSizing:"border-box",maxHeight:"100%",...d.style}})})})});so.displayName=vs;var bs="SelectPopperPosition",ht=c.forwardRef((o,n)=>{const{__scopeSelect:a,align:p="start",collisionPadding:d=me,...N}=o,x=nt(a);return e.jsx(Go,{...x,...N,ref:n,align:p,collisionPadding:d,style:{boxSizing:"border-box",...N.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ht.displayName=bs;var[Ns,wt]=Ve(Pe,{}),ft="SelectViewport",ao=c.forwardRef((o,n)=>{const{__scopeSelect:a,nonce:p,...d}=o,N=ke(ft,a),x=wt(ft,a),u=fe(n,N.onViewportChange),g=c.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:p}),e.jsx(st.Slot,{scope:a,children:e.jsx(ce.div,{"data-radix-select-viewport":"",role:"presentation",...d,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...d.style},onScroll:X(d.onScroll,w=>{const I=w.currentTarget,{contentWrapper:T,shouldExpandOnScrollRef:V}=x;if(V?.current&&T){const l=Math.abs(g.current-I.scrollTop);if(l>0){const S=window.innerHeight-me*2,b=parseFloat(T.style.minHeight),k=parseFloat(T.style.height),z=Math.max(b,k);if(z<S){const y=z+l,_=Math.min(S,y),pe=y-_;T.style.height=_+"px",T.style.bottom==="0px"&&(I.scrollTop=pe>0?pe:0,T.style.justifyContent="flex-end")}}}g.current=I.scrollTop})})})]})});ao.displayName=ft;var no="SelectGroup",[js,ys]=Ve(no),ws=c.forwardRef((o,n)=>{const{__scopeSelect:a,...p}=o,d=yt();return e.jsx(js,{scope:a,id:d,children:e.jsx(ce.div,{role:"group","aria-labelledby":d,...p,ref:n})})});ws.displayName=no;var ro="SelectLabel",Cs=c.forwardRef((o,n)=>{const{__scopeSelect:a,...p}=o,d=ys(ro,a);return e.jsx(ce.div,{id:d.id,...p,ref:n})});Cs.displayName=ro;var et="SelectItem",[Ss,co]=Ve(et),io=c.forwardRef((o,n)=>{const{__scopeSelect:a,value:p,disabled:d=!1,textValue:N,...x}=o,u=Se(et,a),g=ke(et,a),w=u.value===p,[I,T]=c.useState(N??""),[V,l]=c.useState(!1),S=fe(n,y=>g.itemRefCallback?.(y,p,d)),b=yt(),k=c.useRef("touch"),z=()=>{d||(u.onValueChange(p),u.onOpenChange(!1))};if(p==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Ss,{scope:a,value:p,disabled:d,textId:b,isSelected:w,onItemTextChange:c.useCallback(y=>{T(_=>_||(y?.textContent??"").trim())},[]),children:e.jsx(st.ItemSlot,{scope:a,value:p,disabled:d,textValue:I,children:e.jsx(ce.div,{role:"option","aria-labelledby":b,"data-highlighted":V?"":void 0,"aria-selected":w&&V,"data-state":w?"checked":"unchecked","aria-disabled":d||void 0,"data-disabled":d?"":void 0,tabIndex:d?void 0:-1,...x,ref:S,onFocus:X(x.onFocus,()=>l(!0)),onBlur:X(x.onBlur,()=>l(!1)),onClick:X(x.onClick,()=>{k.current!=="mouse"&&z()}),onPointerUp:X(x.onPointerUp,()=>{k.current==="mouse"&&z()}),onPointerDown:X(x.onPointerDown,y=>{k.current=y.pointerType}),onPointerMove:X(x.onPointerMove,y=>{k.current=y.pointerType,d?g.onItemLeave?.():k.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:X(x.onPointerLeave,y=>{y.currentTarget===document.activeElement&&g.onItemLeave?.()}),onKeyDown:X(x.onKeyDown,y=>{g.searchRef?.current!==""&&y.key===" "||(ls.includes(y.key)&&z(),y.key===" "&&y.preventDefault())})})})})});io.displayName=et;var Ge="SelectItemText",lo=c.forwardRef((o,n)=>{const{__scopeSelect:a,className:p,style:d,...N}=o,x=Se(Ge,a),u=ke(Ge,a),g=co(Ge,a),w=ps(Ge,a),[I,T]=c.useState(null),V=fe(n,z=>T(z),g.onItemTextChange,z=>u.itemTextRefCallback?.(z,g.value,g.disabled)),l=I?.textContent,S=c.useMemo(()=>e.jsx("option",{value:g.value,disabled:g.disabled,children:l},g.value),[g.disabled,g.value,l]),{onNativeOptionAdd:b,onNativeOptionRemove:k}=w;return Ce(()=>(b(S),()=>k(S)),[b,k,S]),e.jsxs(e.Fragment,{children:[e.jsx(ce.span,{id:g.textId,...N,ref:V}),g.isSelected&&x.valueNode&&!x.valueNodeHasChildren?Ut.createPortal(N.children,x.valueNode):null]})});lo.displayName=Ge;var uo="SelectItemIndicator",mo=c.forwardRef((o,n)=>{const{__scopeSelect:a,...p}=o;return co(uo,a).isSelected?e.jsx(ce.span,{"aria-hidden":!0,...p,ref:n}):null});mo.displayName=uo;var vt="SelectScrollUpButton",po=c.forwardRef((o,n)=>{const a=ke(vt,o.__scopeSelect),p=wt(vt,o.__scopeSelect),[d,N]=c.useState(!1),x=fe(n,p.onScrollButtonChange);return Ce(()=>{if(a.viewport&&a.isPositioned){let u=function(){const w=g.scrollTop>0;N(w)};const g=a.viewport;return u(),g.addEventListener("scroll",u),()=>g.removeEventListener("scroll",u)}},[a.viewport,a.isPositioned]),d?e.jsx(xo,{...o,ref:x,onAutoScroll:()=>{const{viewport:u,selectedItem:g}=a;u&&g&&(u.scrollTop=u.scrollTop-g.offsetHeight)}}):null});po.displayName=vt;var bt="SelectScrollDownButton",go=c.forwardRef((o,n)=>{const a=ke(bt,o.__scopeSelect),p=wt(bt,o.__scopeSelect),[d,N]=c.useState(!1),x=fe(n,p.onScrollButtonChange);return Ce(()=>{if(a.viewport&&a.isPositioned){let u=function(){const w=g.scrollHeight-g.clientHeight,I=Math.ceil(g.scrollTop)<w;N(I)};const g=a.viewport;return u(),g.addEventListener("scroll",u),()=>g.removeEventListener("scroll",u)}},[a.viewport,a.isPositioned]),d?e.jsx(xo,{...o,ref:x,onAutoScroll:()=>{const{viewport:u,selectedItem:g}=a;u&&g&&(u.scrollTop=u.scrollTop+g.offsetHeight)}}):null});go.displayName=bt;var xo=c.forwardRef((o,n)=>{const{__scopeSelect:a,onAutoScroll:p,...d}=o,N=ke("SelectScrollButton",a),x=c.useRef(null),u=at(a),g=c.useCallback(()=>{x.current!==null&&(window.clearInterval(x.current),x.current=null)},[]);return c.useEffect(()=>()=>g(),[g]),Ce(()=>{u().find(I=>I.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),e.jsx(ce.div,{"aria-hidden":!0,...d,ref:n,style:{flexShrink:0,...d.style},onPointerDown:X(d.onPointerDown,()=>{x.current===null&&(x.current=window.setInterval(p,50))}),onPointerMove:X(d.onPointerMove,()=>{N.onItemLeave?.(),x.current===null&&(x.current=window.setInterval(p,50))}),onPointerLeave:X(d.onPointerLeave,()=>{g()})})}),ks="SelectSeparator",Ds=c.forwardRef((o,n)=>{const{__scopeSelect:a,...p}=o;return e.jsx(ce.div,{"aria-hidden":!0,...p,ref:n})});Ds.displayName=ks;var Nt="SelectArrow",Es=c.forwardRef((o,n)=>{const{__scopeSelect:a,...p}=o,d=nt(a),N=Se(Nt,a),x=ke(Nt,a);return N.open&&x.position==="popper"?e.jsx(Wo,{...d,...p,ref:n}):null});Es.displayName=Nt;var As="SelectBubbleInput",ho=c.forwardRef(({__scopeSelect:o,value:n,...a},p)=>{const d=c.useRef(null),N=fe(p,d),x=Qo(n);return c.useEffect(()=>{const u=d.current;if(!u)return;const g=window.HTMLSelectElement.prototype,I=Object.getOwnPropertyDescriptor(g,"value").set;if(x!==n&&I){const T=new Event("change",{bubbles:!0});I.call(u,n),u.dispatchEvent(T)}},[x,n]),e.jsx(ce.select,{...a,style:{...Fo,...a.style},ref:N,defaultValue:n})});ho.displayName=As;function fo(o){return o===""||o===void 0}function vo(o){const n=Vo(o),a=c.useRef(""),p=c.useRef(0),d=c.useCallback(x=>{const u=a.current+x;n(u),(function g(w){a.current=w,window.clearTimeout(p.current),w!==""&&(p.current=window.setTimeout(()=>g(""),1e3))})(u)},[n]),N=c.useCallback(()=>{a.current="",window.clearTimeout(p.current)},[]);return c.useEffect(()=>()=>window.clearTimeout(p.current),[]),[a,d,N]}function bo(o,n,a){const d=n.length>1&&Array.from(n).every(w=>w===n[0])?n[0]:n,N=a?o.indexOf(a):-1;let x=Is(o,Math.max(N,0));d.length===1&&(x=x.filter(w=>w!==a));const g=x.find(w=>w.textValue.toLowerCase().startsWith(d.toLowerCase()));return g!==a?g:void 0}function Is(o,n){return o.map((a,p)=>o[(n+p)%o.length])}var Ts=Gt,_s=Yt,Rs=Jt,Ps=Zt,zs=Qt,Ms=eo,Os=ao,$s=io,Ls=lo,Fs=mo,Vs=po,Bs=go;function ut({...o}){return e.jsx(Ts,{"data-slot":"select",...o})}function mt({...o}){return e.jsx(Rs,{"data-slot":"select-value",...o})}function pt({className:o,children:n,...a}){return e.jsxs(_s,{"data-slot":"select-trigger",className:Fe("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-full items-center justify-between rounded-md border bg-transparent px-3 py-2 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&>span]:line-clamp-1",o),...a,children:[n,e.jsx(Ps,{asChild:!0,children:e.jsx(Kt,{className:"size-4 opacity-50"})})]})}function gt({className:o,children:n,position:a="popper",...p}){return e.jsx(zs,{children:e.jsxs(Ms,{"data-slot":"select-content",className:Fe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",o),position:a,...p,children:[e.jsx(Us,{}),e.jsx(Os,{className:Fe("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:n}),e.jsx(Hs,{})]})})}function Qe({className:o,children:n,...a}){return e.jsxs($s,{"data-slot":"select-item",className:Fe("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",o),...a,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Fs,{children:e.jsx(es,{className:"size-4"})})}),e.jsx(Ls,{children:n})]})}function Us({className:o,...n}){return e.jsx(Vs,{"data-slot":"select-scroll-up-button",className:Fe("flex cursor-default items-center justify-center py-1",o),...n,children:e.jsx(ss,{className:"size-4"})})}function Hs({className:o,...n}){return e.jsx(Bs,{"data-slot":"select-scroll-down-button",className:Fe("flex cursor-default items-center justify-center py-1",o),...n,children:e.jsx(Kt,{className:"size-4"})})}const qs=o=>{switch(o){case"pendiente":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800";case"subido":return"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border-blue-200 dark:border-blue-800";case"vigente":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border-green-200 dark:border-green-800";case"caducado":return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-200 dark:border-orange-800";case"rechazado":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 border-red-200 dark:border-red-800";default:return"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-700"}},Ks=o=>{switch(o){case"pendiente":return e.jsx(Ht,{className:"w-4 h-4"});case"subido":return e.jsx(Le,{className:"w-4 h-4"});case"vigente":return e.jsx(Ne,{className:"w-4 h-4"});case"caducado":return e.jsx(_e,{className:"w-4 h-4"});case"rechazado":return e.jsx(ue,{className:"w-4 h-4"});case"subiendo":return e.jsx(Le,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-pulse"});case"procesando":return e.jsx($e,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"});case"analizando":return e.jsx(qt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"});case"completado":return e.jsx(Ne,{className:"w-4 h-4 text-green-600 dark:text-green-400"});case"error":return e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"});default:return e.jsx(Te,{className:"w-4 h-4"})}},jt=o=>{if(!o||o===0||isNaN(o))return"0 Bytes";const n=1024,a=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(o)/Math.log(n));return parseFloat((o/Math.pow(n,p)).toFixed(2))+" "+a[p]},tt=o=>{if(!o)return"Fecha no disponible";try{let n;if(o.includes("-"))if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[a,p,d]=o.split("-");n=new Date(parseInt(a),parseInt(p)-1,parseInt(d))}else n=new Date(o);else isNaN(Number(o))?n=new Date(o):n=new Date(Number(o));return isNaN(n.getTime())?"Fecha inválida":n.toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}catch(n){return console.error("Error formateando fecha:",o,n),"Fecha inválida"}},Vt=o=>{const n=o.fechaExpedicion,a=o.vigenciaDocumento;if(o.diasRestantesVigencia,!n&&!a)return`${jt(o.tamaño||0)} • ${tt(o.fechaSubida)}`;let p=jt(o.tamaño||0);return n&&(p+=` • ${tt(n)}`),p},xt=o=>{console.log("🔍 Documento completo:",{concepto:o.concepto,estado:o.estado,archivos:o.archivos}),o.archivos&&o.archivos.length>0&&o.archivos.forEach((a,p)=>{console.log(`📄 Archivo ${p+1}:`,{nombre:a.nombre,estado:a.estado,fechaExpedicion:a.fechaExpedicion,vigenciaDocumento:a.vigenciaDocumento,diasRestantesVigencia:a.diasRestantesVigencia,validacionIA:a.validacionIA})});const n=o.archivos?.find(a=>a.estado==="completado"&&a.vigenciaDocumento);if(n&&n.vigenciaDocumento){const a=new Date(n.vigenciaDocumento),p=new Date,d=a.getTime()-p.getTime(),N=Math.ceil(d/(1e3*60*60*24));return console.log("✅ Usando fecha IA:",n.vigenciaDocumento,"Días calculados:",N),{fecha:n.vigenciaDocumento,diasRestantes:N,esVigenciaReal:!0}}return console.log("⚠️ No hay archivos con vigencia IA, usando fechaLimite:",o.fechaLimite),{fecha:o.fechaLimite,diasRestantes:null,esVigenciaReal:!1}},ba=({campusDelDirector:o,documentosRequeridos:n,campusSeleccionado:a,error:p})=>{console.log("=== PROPS RECIBIDAS AL CARGAR COMPONENTE ==="),console.log("campusDelDirector:",o?.length||0,o),console.log("documentosIniciales:",n?.length||0,n),console.log("campusInicial:",a),console.log("error:",p),n&&n.length>0&&(console.log("=== DETALLE DE DOCUMENTOS INICIALES ==="),n.forEach((t,r)=>{console.log(`Documento ${r+1}:`,{id:t.id,concepto:t.concepto,estado:t.estado,archivos:t.archivos,cantidad_archivos:t.archivos?.length||0}),t.archivos&&t.archivos.length>0?(console.log(`  Archivos del documento "${t.concepto}":`),t.archivos.forEach((s,i)=>{console.log(`    Archivo ${i+1}:`,{id:s.id,nombre:s.nombre,estado:s.estado,tamaño:s.tamaño,fechaSubida:s.fechaSubida})})):console.log(`  Documento "${t.concepto}" no tiene archivos`)}));const[d,N]=c.useState(a),x=(n||[]).map(t=>({...t,archivos:t.archivos||[]}));console.log("=== PROCESAMIENTO DOCUMENTOS CON ARCHIVOS ==="),console.log("documentosConArchivos procesados:",x.length),x.forEach((t,r)=>{console.log(`DocConArchivos ${r+1}: "${t.concepto}" - ${t.archivos?.length||0} archivos`)});const[u,g]=c.useState(x),[w,I]=c.useState(null),[T,V]=c.useState({}),[l,S]=c.useState(x[0]||null),[b,k]=c.useState("todos"),z=c.useRef(null),[y,_]=c.useState(""),[pe,W]=c.useState(!1),[je,O]=c.useState(0),[ie,F]=c.useState(""),[ge,ee]=c.useState(""),[K,ne]=c.useState(!1),[re,te]=c.useState(0),[J,oe]=c.useState(0),[le,de]=c.useState(new Set),[Be,ye]=c.useState(!1),[Ue,He]=c.useState(""),[ve,M]=c.useState(!1),[De,f]=c.useState(!1),[B,q]=c.useState(!1),[D,L]=c.useState(null),j=t=>t.uniqueKey||t.id,G=t=>t.archivos||[],be=t=>{const r=G(t);if(r.length===0)return!0;const s=U(t.estado);return s==="vigente"&&!H(t)?!1:s==="caducado"||H(t)?!0:!(r.find(h=>h.estado==="completado"&&(!h.validacionIA||h.validacionIA.coincide))&&t.estado!=="rechazado")},Ee=async()=>{if(!d){console.log("No hay campus actual, no se puede refrescar");return}try{console.log("=== REFRESCANDO DOCUMENTOS DESDE SERVIDOR ==="),console.log("Campus actual:",d.ID_Campus,d.Campus),console.log("Tipo de documento seleccionado:",xe),xe==="medicos"?await Ke():await qe()}catch(t){console.error("Error al refrescar documentos:",t),M(!1),f(!0),Ye(!1)}},qe=async()=>{if(!d){console.log("No hay campus actual para documentos legales");return}try{M(!0),f(!1);const t=await fetch(`/documentos/upload?campus=${d.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(t.ok){const r=await t.json();if(console.log("Respuesta del servidor (legales):",r),r.props?.documentosRequeridos){console.log("Documentos legales recibidos:",r.props.documentosRequeridos.length);const s=(r.props.documentosRequeridos||[]).map(i=>({...i,archivos:i.archivos||[]}));if(g(s),console.log("Documentos legales actualizados"),l){const i=s.find(h=>h.id===l.id);i&&(S(i),console.log("Documento seleccionado actualizado"))}else s.length>0&&(S(s[0]),console.log("Primer documento seleccionado por defecto"));f(!0),M(!1)}else console.log("No se recibieron documentos legales en la respuesta"),M(!1),f(!0)}else console.error("Error al actualizar documentos legales:",t.status,t.statusText),M(!1),f(!0)}catch(t){console.error("Error en refrescarDocumentosLegales:",t),M(!1),f(!0)}},Ke=async()=>{if(!d){console.log("No hay campus actual para documentos médicos");return}console.log("=== REFRESCANDO DOCUMENTOS MÉDICOS OPTIMIZADO ==="),console.log("Campus:",d.ID_Campus,d.Campus),M(!0),f(!1),Ye(!0);try{const t=Date.now();console.log("🔄 Realizando consulta optimizada...");const r=await fetch(`/documentos/medicos-optimizado?campus_id=${d.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!r.ok)throw new Error(`Error en la respuesta: ${r.status}`);const s=await r.json(),i=Date.now()-t;if(console.log(`⚡ Consulta optimizada completada en ${i}ms`),console.log("Respuesta optimizada:",s),!s.success||!s.carreras||!s.documentos_por_carrera){console.log("No se recibieron datos válidos de documentos médicos"),Me([]);return}const h=s.carreras,C=s.documentos_por_carrera;console.log(`📋 Procesando ${h.length} carreras médicas...`),We(h),console.log("🔄 Carreras médicas actualizadas en el estado:",h);const m=u.filter(P=>P.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(m.length===0){console.log("No se encontraron documentos base de cartas de intención"),Me([]);return}if(!h||h.length===0){console.log("No se recibieron carreras médicas"),Me([]);return}const R=[];if(h.forEach(P=>{const $=P.ID_Especialidad,A=P.Descripcion,v=C[$]||[];m.forEach(Y=>{const E=`${Y.id}_carrera_${$}`,Q=v.find(Ie=>Ie.id===Y.id),Ae={...Y,id:Y.id,documentoOriginalId:Y.id,uniqueKey:E,concepto:`${Y.concepto} - ${A}`,descripcion:`${Y.descripcion} para la carrera de ${A}`,carreraId:String($),carreraNombre:A,estado:Q?.estado||"pendiente",archivos:Q?.archivos||[]};console.log(`✅ Documento generado para ${A}:`,{uniqueKey:Ae.uniqueKey,estado:Ae.estado,totalArchivos:Ae.archivos?.length||0}),R.push(Ae)})}),console.log(`📚 Total documentos médicos generados: ${R.length}`),Me(R),console.log("📋 Documentos médicos actualizados en estado separado"),l&&l.uniqueKey){const P=R.find($=>$.uniqueKey===l.uniqueKey);P&&(S(P),console.log("Documento médico seleccionado actualizado"))}else R.length>0&&(S(R[0]),console.log("Primer documento médico seleccionado por defecto"))}catch(t){console.error("Error en consulta optimizada de documentos médicos:",t),Me([])}finally{f(!0),M(!1),Ye(!1)}},Ct=()=>{setTimeout(()=>{console.log("Actualizando panel automáticamente..."),Ee()},2e3)};c.useEffect(()=>{console.log("=== CARGA INICIAL DEL COMPONENTE ==="),console.log("Campus inicial:",a),console.log("Campus actual:",d),console.log("Documentos iniciales:",n?.length||0),M(!0),f(!1);const t=n?.every(s=>!s.archivos||s.archivos.length===0)||!1,r=!n||n.length===0;if(a&&(r||t))console.log(r?"Campus inicial detectado SIN documentos, refrescando desde servidor...":"Campus inicial detectado con documentos VACÍOS (sin archivos), refrescando desde servidor..."),(async()=>{try{console.log("=== REFRESCANDO DOCUMENTOS CARGA INICIAL ==="),console.log("Campus inicial:",a.ID_Campus,a.Campus);const i=await fetch("/documentos/cambiar-campus",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({campus_id:a.ID_Campus})});if(i.ok){const h=await i.json();if(console.log("Respuesta del servidor (carga inicial):",h),h.documentos){console.log("Documentos recibidos (carga inicial):",h.documentos.length);const C=(h.documentos||[]).map(m=>({...m,archivos:m.archivos||[]}));g(C),console.log("Documentos estado actualizado (carga inicial)"),C.length>0&&(S(C[0]),console.log("Primer documento seleccionado por defecto (carga inicial)")),f(!0),M(!1)}else console.log("No se recibieron documentos en la respuesta (carga inicial)"),M(!1),f(!0)}else console.error("Error al cargar documentos iniciales:",i.status,i.statusText),M(!1),f(!0)}catch(i){console.error("Error al refrescar documentos (carga inicial):",i),M(!1),f(!0)}})();else if(a&&n&&n.length>0&&!t){if(console.log("Campus inicial detectado CON documentos válidos Y CON ARCHIVOS, usando documentos iniciales..."),console.log("Documentos iniciales disponibles:",n.length),console.log("Estado documentos actual:",u.length),console.log("Documento seleccionado actual:",l?.concepto||"ninguno"),!l&&u.length>0)console.log("Seleccionando primer documento por defecto:",u[0].concepto),S(u[0]);else if(!l&&n.length>0){const s={...n[0],archivos:n[0].archivos||[]};console.log("Fallback: Seleccionando primer documento de documentos iniciales:",s.concepto),S(s)}else l&&console.log("Ya hay un documento seleccionado:",l.concepto);f(!0),M(!1)}else if(console.log("No hay campus inicial, usando documentos proporcionados"),n&&n.length>0){const s=n.map(i=>({...i,archivos:i.archivos||[]}));console.log("Actualizando estado con documentos proporcionados"),g(s),!l&&s.length>0&&(console.log("Seleccionando primer documento por defecto"),S(s[0])),f(!0),M(!1)}else M(!1),f(!0)},[]),c.useEffect(()=>{console.log("=== ESTADO DOCUMENTOS CAMBIÓ ==="),console.log("Documentos en estado:",u.length),console.log("Documento seleccionado:",l?.concepto||"ninguno"),u.length>0&&(console.log("=== DETALLE DE DOCUMENTOS EN ESTADO ==="),u.forEach((t,r)=>{const s=t.archivos?.length||0;console.log(`Estado Doc ${r+1}: "${t.concepto}" - ${s} archivos`),s>0&&t.archivos?.forEach((i,h)=>{console.log(`  Estado Archivo ${h+1}: ${i.nombre} (${i.estado})`)})})),u.length>0&&!l&&(console.log("Auto-seleccionando primer documento:",u[0].concepto),S(u[0]))},[u,l]),c.useEffect(()=>{console.log("=== VERIFICANDO ANALISIS DE ARCHIVOS ==="),console.log("Documentos actuales:",u.length);const t=u.flatMap(r=>(r.archivos||[]).filter(s=>s.estado==="completado"&&!s.fechaExpedicion&&!s.vigenciaDocumento));console.log("Archivos completados sin analisis:",t.length),t.forEach(r=>{console.log(`- ${r.nombre} (${r.estado})`)}),t.length>0?console.log("Archivos completados detectados, datos deberían venir del backend"):console.log("Todos los archivos ya tienen analisis o no hay archivos completados")},[u]),c.useEffect(()=>{if(l){const t=u.find(r=>j(r)===j(l));t&&t.archivos?.some((s,i)=>{const h=l.archivos?.[i];return h&&(s.fechaExpedicion!==h.fechaExpedicion||s.vigenciaDocumento!==h.vigenciaDocumento||s.diasRestantesVigencia!==h.diasRestantesVigencia)})&&(console.log("🔄 FECHAS ACTUALIZADAS DETECTADAS - Actualizando selectedDocumento"),S(t))}},[u]),c.useEffect(()=>{d&&d.ID_Campus&&(console.log("=== CAMPUS ACTUAL CAMBIÓ ==="),console.log("Nuevo campus actual:",d.ID_Campus,d.Campus),console.log("Documentos actuales:",u.length),u.length===0?(console.log("No hay documentos, refrescando..."),Ee()):console.log("Ya hay documentos cargados, no refrescando automáticamente"))},[d]);const No=(t,r)=>{t.validacionIA&&!t.validacionIA.coincide&&(L({fileName:t.nombre,documentType:r,reason:t.validacionIA.razon||"Documento no válido",percentage:t.validacionIA.porcentaje||0,expectedType:r,detectedType:"Información de análisis IA"}),q(!0))},jo=t=>{const r=G(t);if(r.length===0)return"No hay archivos subidos para este documento";const s=U(t.estado);return s==="rechazado"?"El documento fue rechazado por un administrador. Puede subir un nuevo archivo.":s==="caducado"||H(t)?"El documento ha caducado por vencimiento de fecha. Puede subir un nuevo archivo.":s==="vigente"&&!H(t)?"Documento aprobado por administrador. No se pueden subir más archivos.":r.find(C=>C.estado==="completado"&&(!C.validacionIA||C.validacionIA.coincide))?"Documento validado automáticamente por IA. Esperando revisión del administrador.":r.find(C=>C.estado==="rechazado"||C.validacionIA&&!C.validacionIA.coincide)?"El documento anterior fue rechazado por validación automática. Puede subir un nuevo archivo.":"Puede subir archivos para este documento"},St=async t=>{console.log("=== CAMBIO DE CAMPUS ==="),console.log("Nuevo campus ID:",t),M(!0),f(!1);try{const r=await lt("/documentos/cambiar-campus",{method:"POST",body:JSON.stringify({campus_id:t})});if(r.ok){const s=await r.json();console.log("Respuesta del servidor:",s),N(s.campus),console.log("Campus actualizado:",s.campus);const i=s.documentos.map(h=>({...h,archivos:h.archivos||[]}));console.log("Documentos cargados:",i.length),g(i),S(i[0]||null),V({}),It("legales"),await kt(t),f(!0),M(!1)}else console.error("Error en la respuesta del servidor:",r.status,r.statusText),M(!1),f(!0)}catch(r){console.error("Error cambiando campus:",r),M(!1),f(!0)}},kt=async t=>{if(t){Et(!0);try{console.log(`=== VERIFICANDO CARRERAS MÉDICAS PARA CAMPUS ${t} ===`);const r=await lt(`/documentos/campus/${t}/medico`);if(r.ok){const s=await r.json();ct(s.tiene_carreras_medicas),We(s.carreras_medicas||[]),console.log(`✅ Campus ${t} tiene carreras médicas:`,s.tiene_carreras_medicas),console.log("📋 Carreras médicas disponibles:",s.carreras_medicas),(s.carreras_medicas||[]).forEach(i=>{console.log(`  - ID_Especialidad: ${i.ID_Especialidad}, Descripcion: ${i.Descripcion}`)})}else console.error("❌ Error verificando campus médico:",r.status),ct(!1),We([])}catch(r){console.error("❌ Error verificando campus médico:",r),ct(!1),We([])}finally{Et(!1)}}},yo=(t,r)=>{t.preventDefault(),I(r)},wo=t=>{t.preventDefault(),I(null)},Co=(t,r)=>{t.preventDefault(),I(null);const s=Array.from(t.dataTransfer.files);Dt(s,r)},Dt=(t,r)=>{console.log("=== HANDLE FILE SELECTION ==="),console.log("Files received:",t),console.log("DocumentoId:",r),console.log("Current selectedFiles before update:",T),V(s=>{const i={...s,[r]:[...s[r]||[],...t]};return console.log("Updated selectedFiles:",i),i})},So=(t,r)=>{if(console.log("=== HANDLE FILE INPUT CHANGE ==="),console.log("Event target files:",t.target.files),console.log("DocumentoId:",r),t.target.files){const s=Array.from(t.target.files);console.log("Files array:",s),console.log("Files length:",s.length),s.forEach((i,h)=>{console.log(`File ${h}:`,{name:i.name,size:i.size,type:i.type})}),Dt(s,r)}else console.log("❌ No files in event target")},ko=(t,r)=>{V(s=>({...s,[t]:s[t]?.filter((i,h)=>h!==r)||[]}))},Do=async t=>{console.log("INICIANDO UPLOAD - DocumentoKey:",t),console.log("Tipo de documento actual:",xe),console.log("DocumentosDelTipo disponibles:",he.length),he.forEach((i,h)=>{console.log(`  Doc ${h}: key="${j(i)}", uniqueKey="${i.uniqueKey}", id="${i.id}"`)});const r=T[t];console.log("Archivos a subir:",r),console.log("Estado completo selectedFiles:",T);const s=he.find(i=>j(i)===t);if(!s){console.error("Documento no encontrado con clave:",t),console.error("Claves disponibles:",he.map(i=>j(i))),alert("Error: Documento no encontrado");return}if(console.log("Documento encontrado:",{id:s.id,uniqueKey:s.uniqueKey,documentoOriginalId:s.documentoOriginalId,carreraId:s.carreraId,carreraNombre:s.carreraNombre}),!r||r.length===0){console.log("No hay archivos para subir"),alert("No hay archivos seleccionados. Por favor selecciona un archivo primero.");return}if(!d?.ID_Campus){console.error("No hay campus seleccionado"),alert("No hay campus seleccionado");return}console.log("Campus actual:",d.ID_Campus),W(!0),O(0),F("Preparando archivos..."),ne(!1),te(0),oe(r.length),V(i=>({...i,[t]:[]})),console.log(`Procesando ${r.length} archivo(s)...`);for(let i=0;i<r.length;i++){const h=r[i];console.log(`Procesando archivo ${i+1}/${r.length}: ${h.name}`),ee(h.name),F(`Subiendo ${h.name}...`),O(10);try{const C=new FormData;C.append("archivo",h);const m=s.documentoOriginalId||s.id;C.append("documento_id",m.toString()),C.append("campus_id",d.ID_Campus),console.log("Usando documento_id para backend:",m,"(original:",s.documentoOriginalId,", compuesto:",s.id,")"),s.carreraId&&(C.append("carrera_id",s.carreraId),console.log("Agregando carrera_id (ID_Especialidad):",s.carreraId,"para carrera:",s.carreraNombre)),console.log("=== DEBUG FORMDATA ===");for(let v of C.entries())console.log(v[0]+":",v[1]);await new Promise(v=>setTimeout(v,500)),O(25),F(`Validando ${h.name}...`),await new Promise(v=>setTimeout(v,500)),O(50),F(`Guardando ${h.name} en servidor...`),await new Promise(v=>setTimeout(v,500)),O(75),F(`Finalizando subida de ${h.name}...`),console.log("Iniciando petición de subida real...");const R=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");console.log("CSRF Token:",R);const P=new FormData;P.append("archivo",h),P.append("documento_id",m.toString()),P.append("campus_id",d.ID_Campus),s.carreraId&&P.append("carrera_id",s.carreraId),console.log("Testing with fresh FormData:");for(let v of P.entries())console.log(`  ${v[0]}:`,v[1]),v[1]instanceof File&&console.log(`    File details: name=${v[1].name}, size=${v[1].size}, type=${v[1].type}`);const $=await fetch("/documentos/subir-archivo",{method:"POST",headers:{"X-CSRF-TOKEN":R||""},body:P});console.log("Status de respuesta:",$.status,$.statusText),console.log("Headers de respuesta:",$.headers);const A=await $.text();if(console.log("Respuesta RAW del servidor:",A),$.ok)try{const v=JSON.parse(A);if(console.log("Respuesta parseada exitosamente:",v),!v.archivo||!v.archivo.estado){console.error("El servidor no procesó el archivo correctamente"),console.error("data.archivo:",v.archivo),F("Error: El archivo no se procesó correctamente en el servidor"),W(!1);return}O(100),F(`${h.name} subido exitosamente`),te(E=>E+1),v.archivo.estado==="analizando"&&(F(`Analizando ${h.name} con IA...`),O(100),await new Promise(E=>setTimeout(E,2e3)));const Y={id:v.archivo.id,nombre:h.name,tamaño:v.archivo.tamaño||h.size||0,fechaSubida:new Date().toISOString().split("T")[0],estado:v.archivo.estado==="analizando"?"analizando":"completado",progreso:100,mensaje:v.archivo.estado==="analizando"?"Analizando con IA...":"Completado"};g(E=>E.map(Q=>j(Q)===t?{...Q,estado:"subido",archivos:[...G(Q),Y]}:Q)),l&&j(l)===t&&S(E=>E&&{...E,estado:"subido",archivos:[...G(E),Y]}),de(E=>new Set(E).add(v.archivo.id)),setTimeout(()=>{de(E=>{const Q=new Set(E);return Q.delete(v.archivo.id),Q})},5e3),console.log("Archivo agregado inmediatamente al panel:",Y),v.archivo.estado==="analizando"&&Io(v.archivo.id,t,1),console.log("Programando actualización automática del panel..."),Ct()}catch(v){console.error("Error parseando JSON:",v),console.error("Respuesta no es JSON válido:",A),F("Error: El servidor devolvió una respuesta inválida"),W(!1);return}else{console.log("Status de error:",$.status,$.statusText),console.log("Respuesta RAW de error:",A);try{const v=JSON.parse(A);console.error("Error subiendo archivo:",v),v.validation_errors&&(console.error("Errores de validación específicos:"),Object.keys(v.validation_errors).forEach(Y=>{console.error(`  - ${Y}: ${v.validation_errors[Y]}`)})),v.debug_info&&console.error("Debug info:",v.debug_info),F(`Error al subir ${h.name}: ${v.error||"Error desconocido"}`)}catch(v){console.error("Error parseando respuesta de error:",v),console.error("Respuesta de error no es JSON válido:",A),F(`Error al subir ${h.name}: Error del servidor (${$.status})`)}O(0),await new Promise(v=>setTimeout(v,2e3))}}catch(C){console.error("Error en upload:",C),F(`Error de conexión con ${h.name}`),O(0),M(!1),f(!0),Ye(!1),await new Promise(m=>setTimeout(m,2e3))}}ne(!0),O(100),F(`Todos los archivos procesados exitosamente (${re+1}/${r.length})`),ee(""),await new Promise(i=>setTimeout(i,3e3)),W(!1),ne(!1),O(0),F(""),ee(""),te(0),oe(0),console.log("Proceso de subida completado exitosamente")},[rt,ze]=c.useState(new Set),[Eo,ct]=c.useState(!1),[Ao,Et]=c.useState(!1),[At,We]=c.useState([]),[it,Me]=c.useState([]),[Gs,Ye]=c.useState(!1),[xe,It]=c.useState("legales");c.useEffect(()=>()=>{console.log("Limpiando monitores activos al desmontar componente"),ze(new Set)},[]),c.useEffect(()=>{d?.ID_Campus&&kt(d.ID_Campus)},[d]),c.useEffect(()=>{d&&(console.log(`🔄 Tipo de documento cambió a: ${xe} - Refrescando estado...`),M(!0),f(!1),Me([]),xe==="medicos"?Ee():(f(!0),M(!1)))},[xe,d]);const Io=async(t,r,s=2)=>{if(rt.has(t)){console.log(`Ya existe un monitor activo para archivo ${t}`);return}ze(C=>new Set(C).add(t));let i=0;const h=async()=>{i++;try{console.log(`Verificando análisis para archivo ${t} - Intento ${i}/${s}`);const C=await lt(`/documentos/analisis/estado?archivo_id=${t}`,{method:"GET"});if(C.ok){const m=await C.json();if(console.log("Estado del análisis:",m),g(R=>R.map(P=>{if(j(P)===r){const $=G(P).map(E=>{if(E.id===t){const Q=m.tiene_analisis;let Ae=Q?"completado":"analizando",Ie="";if(m.estado==="rechazado"||Q&&m.analisis&&m.analisis.validacion&&!m.analisis.validacion.coincide){Ae="rechazado";let we="";m.analisis&&m.analisis.validacion?we=m.analisis.validacion.razon:m.analisis&&m.analisis.documento?we=m.analisis.documento.observaciones:we="Documento no cumple con los requisitos",Ie=`Documento rechazado: ${we}`;const Mt=u.find(Ro=>j(Ro)===r);L({fileName:E.nombre,documentType:Mt?.concepto||"Documento",reason:we,percentage:0,expectedType:m.analisis?.validacion?.documento_esperado||Mt?.concepto||"Tipo de documento requerido",detectedType:m.analisis?.validacion?.documento_detectado||m.analisis?.documento?.nombre_detectado||m.documento?.tipo_detectado||"Tipo no identificado",cityValidation:m.analisis?.validacion?.ciudad_campus?{campusCity:m.analisis.validacion.ciudad_campus,documentCities:m.analisis.validacion.ciudades_documento||[],isValid:m.analisis.validacion.coincide||!1,details:m.analisis.validacion.evaluacion_gpt==="ciudad_incorrecta"?"El documento pertenece a una ciudad diferente a la del campus seleccionado":void 0}:void 0}),q(!0)}else if(Q&&m.analisis&&m.analisis.validacion){let we=`Documento validado correctamente (${m.analisis.validacion.porcentaje_coincidencia}% coincidencia)`;m.analisis.validacion.ciudad_campus&&m.analisis.validacion.ciudades_documento&&(we+=` • Ubicación: ${m.analisis.validacion.ciudad_campus} ✓`),Ie=we}else Q?Ie="Análisis IA completado":Ie=`Analizando documento... (${i}/${s})`;return{...E,estado:Ae,mensaje:Ie,validacionIA:m.analisis?.validacion?{coincide:m.analisis.validacion.coincide,porcentaje:m.analisis.validacion.porcentaje_coincidencia,razon:m.analisis.validacion.razon,accion:m.analisis.validacion.accion}:void 0,fechaExpedicion:m.analisis?.documento?.fecha_expedicion,vigenciaDocumento:m.analisis?.documento?.vigencia_documento,diasRestantesVigencia:m.analisis?.documento?.dias_restantes_vigencia}}return E});let A=P.estado;const v=$.find(E=>E.estado==="completado"&&(!E.validacionIA||E.validacionIA.coincide));return $.find(E=>E.estado==="rechazado"||E.estado==="completado"&&E.validacionIA&&!E.validacionIA.coincide)?(A="rechazado",console.log("Documento rechazado - cambiando estado inmediatamente")):v?(A="vigente",console.log("Documento aprobado - cambiando a vigente")):$.some(E=>E.estado==="completado")&&(A="subido",console.log("Documento subido")),{...P,estado:A,archivos:$}}return P})),l&&j(l)===r&&S(R=>{if(R&&u.find($=>j($)===r)){const $=m.estado==="rechazado"||m.analisis?.validacion&&!m.analisis.validacion.coincide,A={...R,estado:$?"rechazado":m.analisis?.validacion?.coincide?"vigente":R.estado,archivos:R.archivos?.map(v=>{if(v.id===t){const Y=$?"rechazado":m.tiene_analisis?"completado":"analizando";return{...v,estado:Y,validacionIA:m.analisis?.validacion?{coincide:m.analisis.validacion.coincide,porcentaje:m.analisis.validacion.porcentaje_coincidencia,razon:m.analisis.validacion.razon,accion:m.analisis.validacion.accion}:void 0,fechaExpedicion:m.analisis?.documento?.fecha_expedicion,vigenciaDocumento:m.analisis?.documento?.vigencia_documento,diasRestantesVigencia:m.analisis?.documento?.dias_restantes_vigencia}}return v})||[]};return console.log("Actualizando selectedDocumento en tiempo real:",A),A}return R}),m.tiene_analisis||i>=s){if(console.log(`Finalizando monitoreo para archivo ${t}. Análisis completado: ${m.tiene_analisis}, Intentos: ${i}`),ze(R=>{const P=new Set(R);return P.delete(t),P}),m.tiene_analisis){console.log("Análisis IA completado - Actualizando panel..."),console.log("📅 FECHAS RECIBIDAS DEL ANÁLISIS:",{fecha_expedicion:m.analisis?.documento?.fecha_expedicion,vigencia_documento:m.analisis?.documento?.vigencia_documento,dias_restantes:m.analisis?.documento?.dias_restantes_vigencia});const R=u.find(A=>j(A)===r),P=R?.archivos?.find(A=>A.id===t);if(m.estado==="rechazado"||m.analisis&&m.analisis.validacion&&!m.analisis.validacion.coincide)console.log("Documento rechazado - Actualizando interfaz inmediatamente"),setTimeout(()=>{g(A=>[...A])},100);else if(m.analisis?.validacion?.coincide){console.log("Documento aprobado por IA - Mostrando notificación de éxito");const A=R?.archivos?.find(v=>v.id===t);He(`${A?.nombre||"Documento"} validado exitosamente`),ye(!0),setTimeout(()=>ye(!1),4e3),setTimeout(()=>{console.log("🔄 Forzando re-render para actualizar fechas en UI"),S(v=>v&&{...v})},500)}Ct()}!m.tiene_analisis&&i>=s&&(console.warn(`Timeout en análisis de archivo ${t} después de ${s} intentos`),g(R=>R.map(P=>{if(j(P)===r){const $=G(P).map(A=>A.id===t?{...A,estado:"error"}:A);return{...P,archivos:$}}return P})));return}setTimeout(h,2e3)}else console.error(`Error en petición de estado: ${C.status}`),i<s?setTimeout(h,2e3):ze(m=>{const R=new Set(m);return R.delete(t),R})}catch(C){console.error("Error monitoreando análisis:",C),i<s?setTimeout(h,3e3):(console.error(`Error persistente en monitoreo de archivo ${t}, cancelando.`),ze(m=>{const R=new Set(m);return R.delete(t),R}))}};h()},To=()=>{console.log("Deteniendo todos los monitores manualmente"),ze(new Set),g(t=>t.map(r=>({...r,archivos:G(r).map(s=>s.estado==="analizando"?{...s,estado:"error"}:s)})))},Tt=t=>{const r=new Date,i=new Date(t).getTime()-r.getTime();return Math.ceil(i/(1e3*60*60*24))},_o=t=>t<0?"text-red-600":t<=7?"text-orange-600":t<=30?"text-yellow-600":"text-green-600",U=t=>{const r=t.toLowerCase();return console.log("🔄 Estado original:",t,"-> normalizado:",r),r},H=t=>{const r=U(t.estado);if(r==="caducado")return console.log("✅ Documento marcado como caducado en BD:",t.concepto),!0;const s=xt(t),i=s.diasRestantes!==null?s.diasRestantes:Tt(t.fechaLimite),h=r==="vigente"&&i<0;return h&&console.log("⏰ Documento caducado dinámicamente:",t.concepto,"Días restantes:",i),h},_t=t=>{if(H(t))return"bg-orange-100 text-orange-800 border-orange-300";const r=U(t.estado);return qs(r)},Rt=t=>{if(H(t))return e.jsx(_e,{className:"w-3 h-3"});const r=U(t.estado);return Ks(r)},Pt=t=>H(t)?"caducado":U(t.estado),zt=u.filter(t=>{const r=t.concepto.toLowerCase().includes(y.toLowerCase())||t.descripcion.toLowerCase().includes(y.toLowerCase());let s=!1;const i=U(t.estado);return b==="todos"?s=!0:b==="subido"?s=i==="subido"||i==="vigente"||i==="caducado"||H(t):s=i===b||b==="caducado"&&H(t),r&&s}),he=(()=>{if(xe==="legales")return zt.filter(t=>!t.concepto.toLowerCase().includes("cartas de intención de campo clínico"));{if(it.length>0)return console.log("🔄 Usando documentos médicos con estado actualizado:",it.length),it;const t=zt.filter(s=>s.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(t.length===0||At.length===0)return[];const r=[];return At.forEach(s=>{t.forEach(i=>{const h=`${i.id}_carrera_${s.ID_Especialidad}`,C={id:i.id,concepto:`${i.concepto} - ${s.Descripcion}`,descripcion:`${i.descripcion} para la carrera de ${s.Descripcion}`,fechaLimite:i.fechaLimite,estado:"pendiente",archivos:[],obligatorio:i.obligatorio,categoria:i.categoria,documentoOriginalId:i.id,uniqueKey:h,carreraId:String(s.ID_Especialidad),carreraNombre:s.Descripcion};console.log(`📄 Documento generado para ${s.Descripcion}:`,{uniqueKey:C.uniqueKey,carreraId:C.carreraId,carreraIdType:typeof C.carreraId,documentoOriginalId:C.documentoOriginalId}),r.push(C)})}),console.log(`📚 Total documentos médicos generados: ${r.length}`),r}})();return e.jsxs(Yo,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Documentos",href:"/documentos"},{title:"Subir Documentos",href:"/documentos/upload"}],children:[e.jsx(Po,{title:"Subida de Documentos",children:e.jsx("meta",{name:"csrf-token",content:document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""})}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[Be&&e.jsx("div",{className:"fixed top-4 right-4 z-40 animate-in slide-in-from-right-full duration-500",children:e.jsx(se,{className:"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 shadow-lg",children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Archivo subido exitosamente"}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:Ue})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>ye(!1),className:"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-200 hover:bg-green-100 dark:hover:bg-green-900/50 h-6 w-6 p-0",children:e.jsx(Xe,{className:"w-3 h-3"})})]})})})}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",onClick:t=>t.preventDefault(),children:e.jsx(se,{className:"w-96 mx-4 dark:bg-gray-800 dark:border-gray-700",onClick:t=>t.stopPropagation(),children:e.jsx(ae,{className:"p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"relative",children:K?e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ne,{className:"w-12 h-12 text-green-600 animate-pulse"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-20 h-20 bg-green-600 rounded-full opacity-20 animate-ping"})})]}):e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx($e,{className:"w-16 h-16 text-blue-600 animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full opacity-20 animate-ping"})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`text-lg font-semibold ${K?"text-green-900 dark:text-green-100":"text-gray-900 dark:text-gray-100"}`,children:K?"Documentos Subidos Exitosamente":"Procesando Documentos"}),ge&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ge}),e.jsx("p",{className:`text-sm font-medium ${K?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`,children:ie}),K&&re>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("span",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:[re," de ",J," archivo(s) procesado(s) exitosamente"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Progreso"}),e.jsxs("span",{children:[je,"%"]})]}),e.jsx(Ot,{value:je,className:`h-3 ${K?"bg-green-100 dark:bg-green-900/30":"dark:bg-gray-700"}`})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:K?"Los documentos se están procesando en segundo plano...":"Por favor espera mientras procesamos tus documentos..."}),K&&e.jsxs(Z,{onClick:()=>{W(!1),ne(!1),O(0),F(""),ee(""),te(0),oe(0)},className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Continuar"]})]})})})}),B&&D&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",onClick:t=>t.preventDefault(),children:e.jsxs(se,{className:"w-full max-w-2xl bg-white dark:bg-gray-800 shadow-xl dark:border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx(Je,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(Ze,{className:"text-lg text-gray-900 dark:text-gray-100",children:"Documento Rechazado"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Validación automática"})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>q(!1),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 h-8 w-8 p-0",children:e.jsx(Xe,{className:"w-4 h-4"})})]})}),e.jsxs(ae,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Archivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg",children:D.fileName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Motivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border-l-4 border-red-400 dark:border-red-600",children:D.reason})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Esperado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900/20 p-2 rounded text-center",children:D.expectedType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Detectado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-orange-50 dark:bg-orange-900/20 p-2 rounded text-center",children:D.detectedType})]})]}),D.cityValidation&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Validación de Ubicación:"}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Campus:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["📍 ",D.cityValidation.campusCity]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Documento de:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["🏙️ ",D.cityValidation.documentCities.join(", ")||"No detectado"]})]})]}),D.cityValidation.details&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-yellow-800",children:[e.jsx(ue,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:D.cityValidation.details})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"¿Qué hacer?"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Suba el documento correcto o contacte al administrador si considera que es un error."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Z,{variant:"outline",onClick:()=>q(!1),className:"flex-1",children:"Cerrar"}),e.jsxs(Z,{onClick:()=>{q(!1),(l?document.getElementById(`file-input-${j(l)}`):null)?.scrollIntoView({behavior:"smooth"})},className:"flex-1",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Subir Documento Correcto"]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-2 dark:text-gray-100",children:"Subir Documentos"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Selecciona un campus y un documento de la lista para subir los archivos requeridos"})]}),rt.size>0&&e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-spin"}),e.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:[rt.size," análisis en curso"]})]}),e.jsxs(Z,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 hover:bg-blue-100 dark:hover:bg-blue-900/50",onClick:To,children:[e.jsx(Xe,{className:"w-3 h-3 mr-1"}),"Detener"]})]})]})}),(!o||!Array.isArray(o)||o.length===0)&&e.jsx(se,{className:"mb-6 border-destructive",children:e.jsx(ae,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("p",{className:"font-medium",children:p||"No tienes campus asignados para subir documentos"})]})})}),d&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 mb-6",children:[e.jsx(se,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Total ",xe==="medicos"?"Médicos":"Legales"]}),e.jsx("p",{className:"text-2xl font-bold",children:he.length})]})]})})}),e.jsx(se,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="pendiente").length})]})]})})}),e.jsx(se,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Completados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="vigente"&&!H(t)).length})]})]})})}),e.jsx(se,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Caducados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="caducado"||H(t)).length})]})]})})}),e.jsx(se,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Rechazados"}),e.jsx("p",{className:"text-2xl font-bold",children:he.filter(t=>U(t.estado)==="rechazado").length})]})]})})})]}),d&&e.jsxs(e.Fragment,{children:[ve&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(se,{className:"h-fit",children:[e.jsx(Je,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ze,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(ut,{value:d?.ID_Campus||"",onValueChange:St,children:[e.jsx(pt,{className:"w-52",children:e.jsx(mt,{placeholder:"Selecciona campus"})}),e.jsx(gt,{children:o.map(t=>e.jsx(Qe,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]})}),e.jsx(ae,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx($e,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Cargando Documentos"}),e.jsx("p",{className:"text-sm text-gray-500",children:xe==="medicos"?"Obteniendo estados de documentos médicos...":"Obteniendo documentos legales..."})]})]})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(se,{className:"h-fit",children:e.jsx(ae,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Te,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Preparando Información"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Por favor espera mientras cargamos la información completa..."})]})]})})})})]}),!ve&&De&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(se,{className:"h-fit",children:[e.jsxs(Je,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ze,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(ut,{value:d?.ID_Campus||"",onValueChange:St,children:[e.jsx(pt,{className:"w-52",children:e.jsx(mt,{placeholder:"Selecciona campus"})}),e.jsx(gt,{children:o.map(t=>e.jsx(Qe,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"text-sm font-medium text-muted-foreground",children:"Tipo:"}),e.jsxs(ut,{value:xe,onValueChange:t=>{It(t)},children:[e.jsx(pt,{className:"w-40",children:e.jsx(mt,{})}),e.jsxs(gt,{children:[e.jsx(Qe,{value:"legales",children:"Legales"}),Eo&&e.jsx(Qe,{value:"medicos",children:"Médicos"})]})]}),Ao&&e.jsx($e,{className:"w-4 h-4 animate-spin text-blue-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Jo,{placeholder:"Buscar documento...",value:y,onChange:t=>_(t.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{variant:b==="todos"?"default":"outline",size:"sm",onClick:()=>k("todos"),children:"Todos"}),e.jsx(Z,{variant:b==="pendiente"?"default":"outline",size:"sm",onClick:()=>k("pendiente"),children:"Pendientes"}),e.jsx(Z,{variant:b==="subido"?"default":"outline",size:"sm",onClick:()=>k("subido"),children:"Subidos"})]})]})]})]}),e.jsx(ae,{className:"p-0",children:e.jsx("div",{ref:z,className:"max-h-[600px] overflow-y-auto",children:he.map(t=>{const r=t.uniqueKey||t.id,s=l?.uniqueKey===r||l?.id===t.id&&!t.uniqueKey;return e.jsxs("div",{className:`p-4 border-b cursor-pointer transition-colors hover:bg-muted/50 ${s?"bg-primary/10 border-l-4 border-l-primary":""}`,onClick:i=>{i.preventDefault();const h=z.current?.scrollTop||0;S(t),requestAnimationFrame(()=>{z.current&&(z.current.scrollTop=h)})},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:t.concepto}),t.obligatorio&&e.jsx(Oe,{variant:"destructive",className:"text-xs ml-2",children:"Req."})]}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(Oe,{className:_t(t),variant:"outline",children:[Rt(t),e.jsx("span",{className:"ml-1 capitalize text-xs",children:Pt(t)})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(_e,{className:"w-3 h-3"}),(()=>{const i=xt(t),C=(i.diasRestantes!==null?i.diasRestantes:Tt(t.fechaLimite))??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:tt(i.fecha)}),e.jsxs("span",{className:`font-medium ${_o(C)}`,children:["(",C>=0?`${C}d`:`${Math.abs(C)}d vencido`,")"]})]})})()]})]},r)})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:l?e.jsxs(se,{className:"h-fit dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs(Je,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Ze,{className:"text-xl dark:text-gray-100",children:l.concepto}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mt-1",children:l.descripcion})]}),e.jsx(Oe,{className:_t(l),children:e.jsxs("div",{className:"flex items-center gap-1",children:[Rt(l),e.jsx("span",{className:"capitalize",children:Pt(l)})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground dark:text-gray-400",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsxs("span",{children:["Vence: ",tt(xt(l).fecha)]})]}),l.obligatorio&&e.jsx(Oe,{variant:"destructive",className:"text-xs",children:"Documento Obligatorio"}),H(l)&&e.jsx(Oe,{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-300 dark:border-orange-800",children:"CADUCADO"}),l?.carreraNombre&&e.jsx(Oe,{variant:"secondary",className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400",children:l.carreraNombre})]})]}),e.jsxs(ae,{className:"space-y-6",children:[G(l).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos subidos (",G(l).length,")"]}),e.jsx("div",{className:"space-y-2",children:G(l).map(t=>{const r=l?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,s=H(l);let i="";return le.has(t.id)?i="border-green-400 dark:border-green-600 bg-green-50 dark:bg-green-900/20 shadow-lg ring-2 ring-green-200 dark:ring-green-800 ring-opacity-50 animate-pulse":t.estado==="subiendo"||t.estado==="procesando"||t.estado==="analizando"?i="border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/20 shadow-lg":t.estado==="completado"?r?i="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":s?i="border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20":i="border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20":t.estado==="rechazado"?i="border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20 shadow-lg":t.estado==="error"?i="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":i="border-gray-200 dark:border-gray-700 dark:bg-gray-800/50",e.jsx("div",{className:`p-3 border rounded-lg transition-all duration-300 ${i}`,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:Vt(t)}),"                                                                    ",t.estado==="subiendo"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Le,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-bounce"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:t.mensaje||"Subiendo archivo..."}),e.jsxs("span",{className:"text-xs text-blue-500 dark:text-blue-400 font-bold",children:[t.progreso,"%"]})]}),e.jsx(Ot,{value:t.progreso,className:"h-3 bg-blue-100 dark:bg-blue-900/30"})]}),t.estado==="procesando"&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:t.mensaje||"Procesando documento..."})]})}),t.estado==="analizando"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:t.mensaje||"Analizando con IA..."})]}),e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:"procesando el documento..."})})]}),t.estado==="completado"&&e.jsxs(e.Fragment,{children:[(()=>{const h=l?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,C=H(l);return h?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Documento Rechazado"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 px-2 py-1 rounded",children:["No aprobado (",t.validacionIA.porcentaje,"%)"]})]}):C?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(_e,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Documento Caducado"}),e.jsx("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 px-2 py-1 rounded",children:"Vencido - Requiere Renovación"})]}):e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ne,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Documento Vigente"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 px-2 py-1 rounded",children:["Aprobado (",t.validacionIA.porcentaje,"%)"]})]})})(),e.jsxs("div",{className:"mt-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:e.jsx(Te,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Vista Previa del Documento"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.nombre})]})]}),e.jsxs(Z,{variant:"outline",size:"sm",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Abrir Completo"]})]})}),e.jsxs("div",{className:"relative bg-gray-50 dark:bg-gray-900",children:[e.jsx("iframe",{src:`/documentos/archivo/${t.id}#toolbar=1&navpanes=0&scrollbar=1&view=FitH&zoom=125`,className:"w-full h-[700px] bg-white dark:bg-gray-900",title:`Preview de ${t.nombre}`,style:{backgroundColor:"#ffffff",border:"none",borderRadius:"0"},onError:()=>{console.log("Error cargando preview del PDF")},loading:"lazy",allowFullScreen:!0}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-all duration-300 pointer-events-none",children:e.jsxs("div",{className:"text-center text-white bg-gray-900 dark:bg-gray-800 bg-opacity-80 p-6 rounded-lg backdrop-blur-sm",children:[e.jsx(Te,{className:"w-16 h-16 mx-auto mb-4 text-blue-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Documento PDF Validado"}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Haz clic para abrir en una nueva ventana"}),e.jsxs(Z,{variant:"secondary",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 pointer-events-auto bg-white text-gray-900 hover:bg-gray-100",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Ver en Nueva Ventana"]})]})})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:e.jsx("div",{className:"flex items-center gap-4 text-xs",children:e.jsx("span",{children:Vt(t)})})})})]})]}),t.estado==="rechazado"&&e.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Documento Rechazado"})]}),t.validacionIA&&e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>No(t,l.concepto),className:"text-red-600 hover:text-red-800 hover:bg-red-100 h-6 px-2",children:e.jsx("span",{className:"text-xs",children:"Ver detalles"})})]}),t.validacionIA&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium mb-1",children:"Motivo del rechazo:"}),e.jsx("p",{className:"text-xs text-red-700",children:t.validacionIA.razon}),t.validacionIA.porcentaje!==void 0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Coincidencia: ",t.validacionIA.porcentaje,"%"]})]})]}),t.estado==="error"&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ue,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:t.mensaje||"Error en proceso"})]})]})})})},t.id)})})]}),(T[j(l)]||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos seleccionados (",(T[j(l)]||[]).length,")"]}),e.jsx("div",{className:"space-y-2",children:(T[j(l)]||[]).map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 dark:border-primary/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:jt(t.size)})]})]}),e.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>ko(j(l),r),className:"text-destructive hover:text-destructive dark:text-red-400 dark:hover:text-red-300",children:e.jsx(Xe,{className:"w-4 h-4"})})]},r))}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(Z,{onClick:()=>Do(j(l)),children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Subir Archivos (",(T[j(l)]||[]).length,")"]}),e.jsx(Z,{variant:"outline",onClick:()=>V(t=>({...t,[j(l)]:[]})),children:"Cancelar"})]})]}),(U(l.estado)!=="vigente"||H(l))&&be(l)?e.jsxs("div",{className:`
                                                border-2 border-dashed rounded-lg p-8 text-center transition-colors
                                                ${w===j(l)?"border-primary bg-primary/5 dark:bg-primary/10":"border-muted-foreground/25 hover:border-muted-foreground/50 dark:border-gray-700 dark:hover:border-gray-600"}
                                            `,onDragOver:t=>yo(t,j(l)),onDragLeave:wo,onDrop:t=>Co(t,j(l)),children:[e.jsx(Le,{className:`
                                                w-12 h-12 mx-auto mb-4
                                                ${w===j(l)?"text-primary":"text-muted-foreground dark:text-gray-400"}
                                            `}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Arrastra archivos aquí"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mb-4 text-sm",children:"o haz clic para seleccionar archivos"}),e.jsx("input",{type:"file",id:`file-input-${j(l)}`,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:t=>So(t,j(l))}),e.jsxs(Z,{variant:"outline",onClick:()=>{document.getElementById(`file-input-${j(l)}`)?.click()},children:[e.jsx(ns,{className:"w-4 h-4 mr-2"}),"Seleccionar Archivos"]}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-3",children:"Formatos: PDF, DOC, DOCX, JPG, PNG (máx. 10MB)"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-8 text-center bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:U(l.estado)==="vigente"&&!H(l)?e.jsx(Ne,{className:"w-12 h-12 text-green-600 dark:text-green-400"}):U(l.estado)==="rechazado"?e.jsx(ue,{className:"w-12 h-12 text-red-600 dark:text-red-400"}):U(l.estado)==="caducado"||H(l)?e.jsx(_e,{className:"w-12 h-12 text-orange-600 dark:text-orange-400"}):e.jsx(ue,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"font-semibold mb-2 text-gray-700 dark:text-gray-200",children:U(l.estado)==="vigente"&&!H(l)?"Documento Aprobado":U(l.estado)==="rechazado"?"Documento Rechazado - Puede Subir Nuevo":U(l.estado)==="caducado"||H(l)?"Documento Caducado - Puede Subir Nuevo":"Subida Bloqueada"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:jo(l)}),U(l.estado)==="vigente"&&!H(l)&&e.jsxs("div",{className:"bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg p-3 text-green-800 dark:text-green-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha sido validado y aprobado."}),e.jsx("p",{className:"text-xs mt-1 text-green-700 dark:text-green-400",children:"No se pueden realizar más cambios a menos que sea rechazado por un administrador."})]}),U(l.estado)==="rechazado"&&e.jsxs("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3 text-red-800 dark:text-red-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento fue rechazado por un administrador."}),e.jsx("p",{className:"text-xs mt-1 text-red-700 dark:text-red-400",children:"Por favor, revise los comentarios y suba una nueva versión."})]}),(U(l.estado)==="caducado"||H(l))&&e.jsxs("div",{className:"bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800 rounded-lg p-3 text-orange-800 dark:text-orange-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha caducado por vencimiento de fecha."}),e.jsx("p",{className:"text-xs mt-1 text-orange-700 dark:text-orange-400",children:"Puede subir una nueva versión actualizada del documento."})]})]})]})]}):e.jsx(se,{className:"h-full dark:bg-gray-800 dark:border-gray-700",children:e.jsx(ae,{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-12 h-12 text-muted-foreground dark:text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Selecciona un documento"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 text-sm",children:"Elige un documento de la lista para comenzar a subir archivos"})]})})})})]})]})]})]})};export{ba as default};
