import{a as i,j as e,H as zo,c as dt}from"./app-BGQjaLPp.js";import{c as Ut,u as Mo,R as Oo,a as wt,b as $o,d as Lo,P as Fo,V as Vo,e as Bo,h as Uo,f as Ho,g as qo,F as Ko,D as Go,C as Wo,i as Yo,A as Jo,X as Xe,U as Fe}from"./app-layout-WRFE2R2z.js";import{C as se,c as ne,a as Ze,b as Qe}from"./card-CVTCVkXE.js";import{u as ve,a as Xo,c as Ve,B as Q}from"./button-cCNUyJ9L.js";import{B as $e}from"./badge-CxcOLW4i.js";import{P as $t}from"./progress-DEdO0tdH.js";import{I as Zo}from"./input-BZiW2ZQe.js";import{L as ut}from"./label-C7VQ6OlK.js";import{P as ie,r as Ht}from"./index--D6mQRjV.js";import{u as Lt,c as Qo,a as J,d as Se}from"./index-DCoPedx3.js";import{u as ea}from"./index-C4FgAYMw.js";import{c as at}from"./createLucideIcon-CkqHnpbB.js";import{C as ta}from"./check-C_BS0uKD.js";import{C as je,F as Te}from"./file-text-CfTb9JvM.js";import{L as Le}from"./loader-circle-DN5TJM48.js";import{C as me}from"./circle-alert-ClUm48XS.js";import{C as qt}from"./clock-DucFvtFq.js";import{C as Re}from"./calendar-C8KXIBnO.js";import{B as Kt}from"./brain-DbZNI8i4.js";import{E as Ft}from"./eye-BK4R16Qo.js";/* empty css            */import"./index-u1-Hf6Gb.js";import"./index-DW9AIAM8.js";import"./log-out-CyEWrG3D.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Gt=at("ChevronDown",oa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],sa=at("ChevronUp",aa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ra=at("Plus",na);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ia=at("Search",ca);function Vt(o,[c,s]){return Math.min(s,Math.max(c,o))}var la=[" ","Enter","ArrowUp","ArrowDown"],da=[" ","Enter"],Pe="Select",[st,nt,ua]=$o(Pe),[Be]=Qo(Pe,[ua,Ut]),rt=Ut(),[ma,ke]=Be(Pe),[pa,ga]=Be(Pe),Wt=o=>{const{__scopeSelect:c,children:s,open:p,defaultOpen:u,onOpenChange:N,value:g,defaultValue:m,onValueChange:x,dir:C,name:_,autoComplete:I,disabled:V,required:d,form:S}=o,b=rt(c),[k,z]=i.useState(null),[y,T]=i.useState(null),[ge,W]=i.useState(!1),ye=Mo(C),[O,le]=Lt({prop:p,defaultProp:u??!1,onChange:N,caller:Pe}),[F,xe]=Lt({prop:g,defaultProp:m,onChange:x,caller:Pe}),te=i.useRef(null),G=k?S||!!k.closest("form"):!0,[re,ce]=i.useState(new Set),oe=Array.from(re).map(X=>X.props.value).join(";");return e.jsx(Oo,{...b,children:e.jsxs(ma,{required:d,scope:c,trigger:k,onTriggerChange:z,valueNode:y,onValueNodeChange:T,valueNodeHasChildren:ge,onValueNodeHasChildrenChange:W,contentId:wt(),value:F,onValueChange:xe,open:O,onOpenChange:le,dir:ye,triggerPointerDownPosRef:te,disabled:V,children:[e.jsx(st.Provider,{scope:c,children:e.jsx(pa,{scope:o.__scopeSelect,onNativeOptionAdd:i.useCallback(X=>{ce(ae=>new Set(ae).add(X))},[]),onNativeOptionRemove:i.useCallback(X=>{ce(ae=>{const de=new Set(ae);return de.delete(X),de})},[]),children:s})}),G?e.jsxs(fo,{"aria-hidden":!0,required:d,tabIndex:-1,name:_,autoComplete:I,value:F,onChange:X=>xe(X.target.value),disabled:V,form:S,children:[F===void 0?e.jsx("option",{value:""}):null,Array.from(re)]},oe):null]})})};Wt.displayName=Pe;var Yt="SelectTrigger",Jt=i.forwardRef((o,c)=>{const{__scopeSelect:s,disabled:p=!1,...u}=o,N=rt(s),g=ke(Yt,s),m=g.disabled||p,x=ve(c,g.onTriggerChange),C=nt(s),_=i.useRef("touch"),[I,V,d]=bo(b=>{const k=C().filter(T=>!T.disabled),z=k.find(T=>T.value===g.value),y=No(k,b,z);y!==void 0&&g.onValueChange(y.value)}),S=b=>{m||(g.onOpenChange(!0),d()),b&&(g.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx(Lo,{asChild:!0,...N,children:e.jsx(ie.button,{type:"button",role:"combobox","aria-controls":g.contentId,"aria-expanded":g.open,"aria-required":g.required,"aria-autocomplete":"none",dir:g.dir,"data-state":g.open?"open":"closed",disabled:m,"data-disabled":m?"":void 0,"data-placeholder":vo(g.value)?"":void 0,...u,ref:x,onClick:J(u.onClick,b=>{b.currentTarget.focus(),_.current!=="mouse"&&S(b)}),onPointerDown:J(u.onPointerDown,b=>{_.current=b.pointerType;const k=b.target;k.hasPointerCapture(b.pointerId)&&k.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(S(b),b.preventDefault())}),onKeyDown:J(u.onKeyDown,b=>{const k=I.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&V(b.key),!(k&&b.key===" ")&&la.includes(b.key)&&(S(),b.preventDefault())})})})});Jt.displayName=Yt;var Xt="SelectValue",Zt=i.forwardRef((o,c)=>{const{__scopeSelect:s,className:p,style:u,children:N,placeholder:g="",...m}=o,x=ke(Xt,s),{onValueNodeHasChildrenChange:C}=x,_=N!==void 0,I=ve(c,x.onValueNodeChange);return Se(()=>{C(_)},[C,_]),e.jsx(ie.span,{...m,ref:I,style:{pointerEvents:"none"},children:vo(x.value)?e.jsx(e.Fragment,{children:g}):N})});Zt.displayName=Xt;var xa="SelectIcon",Qt=i.forwardRef((o,c)=>{const{__scopeSelect:s,children:p,...u}=o;return e.jsx(ie.span,{"aria-hidden":!0,...u,ref:c,children:p||"▼"})});Qt.displayName=xa;var ha="SelectPortal",eo=o=>e.jsx(Fo,{asChild:!0,...o});eo.displayName=ha;var ze="SelectContent",to=i.forwardRef((o,c)=>{const s=ke(ze,o.__scopeSelect),[p,u]=i.useState();if(Se(()=>{u(new DocumentFragment)},[]),!s.open){const N=p;return N?Ht.createPortal(e.jsx(oo,{scope:o.__scopeSelect,children:e.jsx(st.Slot,{scope:o.__scopeSelect,children:e.jsx("div",{children:o.children})})}),N):null}return e.jsx(ao,{...o,ref:c})});to.displayName=ze;var pe=10,[oo,De]=Be(ze),fa="SelectContentImpl",va=Xo("SelectContent.RemoveScroll"),ao=i.forwardRef((o,c)=>{const{__scopeSelect:s,position:p="item-aligned",onCloseAutoFocus:u,onEscapeKeyDown:N,onPointerDownOutside:g,side:m,sideOffset:x,align:C,alignOffset:_,arrowPadding:I,collisionBoundary:V,collisionPadding:d,sticky:S,hideWhenDetached:b,avoidCollisions:k,...z}=o,y=ke(ze,s),[T,ge]=i.useState(null),[W,ye]=i.useState(null),O=ve(c,h=>ge(h)),[le,F]=i.useState(null),[xe,te]=i.useState(null),G=nt(s),[re,ce]=i.useState(!1),oe=i.useRef(!1);i.useEffect(()=>{if(T)return Uo(T)},[T]),Ho();const X=i.useCallback(h=>{const[B,...q]=G().map(j=>j.ref.current),[D]=q.slice(-1),L=document.activeElement;for(const j of h)if(j===L||(j?.scrollIntoView({block:"nearest"}),j===B&&W&&(W.scrollTop=0),j===D&&W&&(W.scrollTop=W.scrollHeight),j?.focus(),document.activeElement!==L))return},[G,W]),ae=i.useCallback(()=>X([le,T]),[X,le,T]);i.useEffect(()=>{re&&ae()},[re,ae]);const{onOpenChange:de,triggerPointerDownPosRef:ue}=y;i.useEffect(()=>{if(T){let h={x:0,y:0};const B=D=>{h={x:Math.abs(Math.round(D.pageX)-(ue.current?.x??0)),y:Math.abs(Math.round(D.pageY)-(ue.current?.y??0))}},q=D=>{h.x<=10&&h.y<=10?D.preventDefault():T.contains(D.target)||de(!1),document.removeEventListener("pointermove",B),ue.current=null};return ue.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",q,{capture:!0})}}},[T,de,ue]),i.useEffect(()=>{const h=()=>de(!1);return window.addEventListener("blur",h),window.addEventListener("resize",h),()=>{window.removeEventListener("blur",h),window.removeEventListener("resize",h)}},[de]);const[Ue,we]=bo(h=>{const B=G().filter(L=>!L.disabled),q=B.find(L=>L.ref.current===document.activeElement),D=No(B,h,q);D&&setTimeout(()=>D.ref.current.focus())}),He=i.useCallback((h,B,q)=>{const D=!oe.current&&!q;(y.value!==void 0&&y.value===B||D)&&(F(h),D&&(oe.current=!0))},[y.value]),qe=i.useCallback(()=>T?.focus(),[T]),be=i.useCallback((h,B,q)=>{const D=!oe.current&&!q;(y.value!==void 0&&y.value===B||D)&&te(h)},[y.value]),M=p==="popper"?ft:so,Ee=M===ft?{side:m,sideOffset:x,align:C,alignOffset:_,arrowPadding:I,collisionBoundary:V,collisionPadding:d,sticky:S,hideWhenDetached:b,avoidCollisions:k}:{};return e.jsx(oo,{scope:s,content:T,viewport:W,onViewportChange:ye,itemRefCallback:He,selectedItem:le,onItemLeave:qe,itemTextRefCallback:be,focusSelectedItem:ae,selectedItemText:xe,position:p,isPositioned:re,searchRef:Ue,children:e.jsx(qo,{as:va,allowPinchZoom:!0,children:e.jsx(Ko,{asChild:!0,trapped:y.open,onMountAutoFocus:h=>{h.preventDefault()},onUnmountAutoFocus:J(u,h=>{y.trigger?.focus({preventScroll:!0}),h.preventDefault()}),children:e.jsx(Go,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:N,onPointerDownOutside:g,onFocusOutside:h=>h.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:e.jsx(M,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:h=>h.preventDefault(),...z,...Ee,onPlaced:()=>ce(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...z.style},onKeyDown:J(z.onKeyDown,h=>{const B=h.ctrlKey||h.altKey||h.metaKey;if(h.key==="Tab"&&h.preventDefault(),!B&&h.key.length===1&&we(h.key),["ArrowUp","ArrowDown","Home","End"].includes(h.key)){let D=G().filter(L=>!L.disabled).map(L=>L.ref.current);if(["ArrowUp","End"].includes(h.key)&&(D=D.slice().reverse()),["ArrowUp","ArrowDown"].includes(h.key)){const L=h.target,j=D.indexOf(L);D=D.slice(j+1)}setTimeout(()=>X(D)),h.preventDefault()}})})})})})})});ao.displayName=fa;var ba="SelectItemAlignedPosition",so=i.forwardRef((o,c)=>{const{__scopeSelect:s,onPlaced:p,...u}=o,N=ke(ze,s),g=De(ze,s),[m,x]=i.useState(null),[C,_]=i.useState(null),I=ve(c,O=>_(O)),V=nt(s),d=i.useRef(!1),S=i.useRef(!0),{viewport:b,selectedItem:k,selectedItemText:z,focusSelectedItem:y}=g,T=i.useCallback(()=>{if(N.trigger&&N.valueNode&&m&&C&&b&&k&&z){const O=N.trigger.getBoundingClientRect(),le=C.getBoundingClientRect(),F=N.valueNode.getBoundingClientRect(),xe=z.getBoundingClientRect();if(N.dir!=="rtl"){const L=xe.left-le.left,j=F.left-L,K=O.left-j,Ne=O.width+K,Ae=Math.max(Ne,le.width),Ke=window.innerWidth-pe,Ge=Vt(j,[pe,Math.max(pe,Ke-Ae)]);m.style.minWidth=Ne+"px",m.style.left=Ge+"px"}else{const L=le.right-xe.right,j=window.innerWidth-F.right-L,K=window.innerWidth-O.right-j,Ne=O.width+K,Ae=Math.max(Ne,le.width),Ke=window.innerWidth-pe,Ge=Vt(j,[pe,Math.max(pe,Ke-Ae)]);m.style.minWidth=Ne+"px",m.style.right=Ge+"px"}const te=V(),G=window.innerHeight-pe*2,re=b.scrollHeight,ce=window.getComputedStyle(C),oe=parseInt(ce.borderTopWidth,10),X=parseInt(ce.paddingTop,10),ae=parseInt(ce.borderBottomWidth,10),de=parseInt(ce.paddingBottom,10),ue=oe+X+re+de+ae,Ue=Math.min(k.offsetHeight*5,ue),we=window.getComputedStyle(b),He=parseInt(we.paddingTop,10),qe=parseInt(we.paddingBottom,10),be=O.top+O.height/2-pe,M=G-be,Ee=k.offsetHeight/2,h=k.offsetTop+Ee,B=oe+X+h,q=ue-B;if(B<=be){const L=te.length>0&&k===te[te.length-1].ref.current;m.style.bottom="0px";const j=C.clientHeight-b.offsetTop-b.offsetHeight,K=Math.max(M,Ee+(L?qe:0)+j+ae),Ne=B+K;m.style.height=Ne+"px"}else{const L=te.length>0&&k===te[0].ref.current;m.style.top="0px";const K=Math.max(be,oe+b.offsetTop+(L?He:0)+Ee)+q;m.style.height=K+"px",b.scrollTop=B-be+b.offsetTop}m.style.margin=`${pe}px 0`,m.style.minHeight=Ue+"px",m.style.maxHeight=G+"px",p?.(),requestAnimationFrame(()=>d.current=!0)}},[V,N.trigger,N.valueNode,m,C,b,k,z,N.dir,p]);Se(()=>T(),[T]);const[ge,W]=i.useState();Se(()=>{C&&W(window.getComputedStyle(C).zIndex)},[C]);const ye=i.useCallback(O=>{O&&S.current===!0&&(T(),y?.(),S.current=!1)},[T,y]);return e.jsx(ja,{scope:s,contentWrapper:m,shouldExpandOnScrollRef:d,onScrollButtonChange:ye,children:e.jsx("div",{ref:x,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ge},children:e.jsx(ie.div,{...u,ref:I,style:{boxSizing:"border-box",maxHeight:"100%",...u.style}})})})});so.displayName=ba;var Na="SelectPopperPosition",ft=i.forwardRef((o,c)=>{const{__scopeSelect:s,align:p="start",collisionPadding:u=pe,...N}=o,g=rt(s);return e.jsx(Wo,{...g,...N,ref:c,align:p,collisionPadding:u,style:{boxSizing:"border-box",...N.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ft.displayName=Na;var[ja,Ct]=Be(ze,{}),vt="SelectViewport",no=i.forwardRef((o,c)=>{const{__scopeSelect:s,nonce:p,...u}=o,N=De(vt,s),g=Ct(vt,s),m=ve(c,N.onViewportChange),x=i.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:p}),e.jsx(st.Slot,{scope:s,children:e.jsx(ie.div,{"data-radix-select-viewport":"",role:"presentation",...u,ref:m,style:{position:"relative",flex:1,overflow:"hidden auto",...u.style},onScroll:J(u.onScroll,C=>{const _=C.currentTarget,{contentWrapper:I,shouldExpandOnScrollRef:V}=g;if(V?.current&&I){const d=Math.abs(x.current-_.scrollTop);if(d>0){const S=window.innerHeight-pe*2,b=parseFloat(I.style.minHeight),k=parseFloat(I.style.height),z=Math.max(b,k);if(z<S){const y=z+d,T=Math.min(S,y),ge=y-T;I.style.height=T+"px",I.style.bottom==="0px"&&(_.scrollTop=ge>0?ge:0,I.style.justifyContent="flex-end")}}}x.current=_.scrollTop})})})]})});no.displayName=vt;var ro="SelectGroup",[ya,wa]=Be(ro),Ca=i.forwardRef((o,c)=>{const{__scopeSelect:s,...p}=o,u=wt();return e.jsx(ya,{scope:s,id:u,children:e.jsx(ie.div,{role:"group","aria-labelledby":u,...p,ref:c})})});Ca.displayName=ro;var co="SelectLabel",Sa=i.forwardRef((o,c)=>{const{__scopeSelect:s,...p}=o,u=wa(co,s);return e.jsx(ie.div,{id:u.id,...p,ref:c})});Sa.displayName=co;var tt="SelectItem",[ka,io]=Be(tt),lo=i.forwardRef((o,c)=>{const{__scopeSelect:s,value:p,disabled:u=!1,textValue:N,...g}=o,m=ke(tt,s),x=De(tt,s),C=m.value===p,[_,I]=i.useState(N??""),[V,d]=i.useState(!1),S=ve(c,y=>x.itemRefCallback?.(y,p,u)),b=wt(),k=i.useRef("touch"),z=()=>{u||(m.onValueChange(p),m.onOpenChange(!1))};if(p==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(ka,{scope:s,value:p,disabled:u,textId:b,isSelected:C,onItemTextChange:i.useCallback(y=>{I(T=>T||(y?.textContent??"").trim())},[]),children:e.jsx(st.ItemSlot,{scope:s,value:p,disabled:u,textValue:_,children:e.jsx(ie.div,{role:"option","aria-labelledby":b,"data-highlighted":V?"":void 0,"aria-selected":C&&V,"data-state":C?"checked":"unchecked","aria-disabled":u||void 0,"data-disabled":u?"":void 0,tabIndex:u?void 0:-1,...g,ref:S,onFocus:J(g.onFocus,()=>d(!0)),onBlur:J(g.onBlur,()=>d(!1)),onClick:J(g.onClick,()=>{k.current!=="mouse"&&z()}),onPointerUp:J(g.onPointerUp,()=>{k.current==="mouse"&&z()}),onPointerDown:J(g.onPointerDown,y=>{k.current=y.pointerType}),onPointerMove:J(g.onPointerMove,y=>{k.current=y.pointerType,u?x.onItemLeave?.():k.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:J(g.onPointerLeave,y=>{y.currentTarget===document.activeElement&&x.onItemLeave?.()}),onKeyDown:J(g.onKeyDown,y=>{x.searchRef?.current!==""&&y.key===" "||(da.includes(y.key)&&z(),y.key===" "&&y.preventDefault())})})})})});lo.displayName=tt;var We="SelectItemText",uo=i.forwardRef((o,c)=>{const{__scopeSelect:s,className:p,style:u,...N}=o,g=ke(We,s),m=De(We,s),x=io(We,s),C=ga(We,s),[_,I]=i.useState(null),V=ve(c,z=>I(z),x.onItemTextChange,z=>m.itemTextRefCallback?.(z,x.value,x.disabled)),d=_?.textContent,S=i.useMemo(()=>e.jsx("option",{value:x.value,disabled:x.disabled,children:d},x.value),[x.disabled,x.value,d]),{onNativeOptionAdd:b,onNativeOptionRemove:k}=C;return Se(()=>(b(S),()=>k(S)),[b,k,S]),e.jsxs(e.Fragment,{children:[e.jsx(ie.span,{id:x.textId,...N,ref:V}),x.isSelected&&g.valueNode&&!g.valueNodeHasChildren?Ht.createPortal(N.children,g.valueNode):null]})});uo.displayName=We;var mo="SelectItemIndicator",po=i.forwardRef((o,c)=>{const{__scopeSelect:s,...p}=o;return io(mo,s).isSelected?e.jsx(ie.span,{"aria-hidden":!0,...p,ref:c}):null});po.displayName=mo;var bt="SelectScrollUpButton",go=i.forwardRef((o,c)=>{const s=De(bt,o.__scopeSelect),p=Ct(bt,o.__scopeSelect),[u,N]=i.useState(!1),g=ve(c,p.onScrollButtonChange);return Se(()=>{if(s.viewport&&s.isPositioned){let m=function(){const C=x.scrollTop>0;N(C)};const x=s.viewport;return m(),x.addEventListener("scroll",m),()=>x.removeEventListener("scroll",m)}},[s.viewport,s.isPositioned]),u?e.jsx(ho,{...o,ref:g,onAutoScroll:()=>{const{viewport:m,selectedItem:x}=s;m&&x&&(m.scrollTop=m.scrollTop-x.offsetHeight)}}):null});go.displayName=bt;var Nt="SelectScrollDownButton",xo=i.forwardRef((o,c)=>{const s=De(Nt,o.__scopeSelect),p=Ct(Nt,o.__scopeSelect),[u,N]=i.useState(!1),g=ve(c,p.onScrollButtonChange);return Se(()=>{if(s.viewport&&s.isPositioned){let m=function(){const C=x.scrollHeight-x.clientHeight,_=Math.ceil(x.scrollTop)<C;N(_)};const x=s.viewport;return m(),x.addEventListener("scroll",m),()=>x.removeEventListener("scroll",m)}},[s.viewport,s.isPositioned]),u?e.jsx(ho,{...o,ref:g,onAutoScroll:()=>{const{viewport:m,selectedItem:x}=s;m&&x&&(m.scrollTop=m.scrollTop+x.offsetHeight)}}):null});xo.displayName=Nt;var ho=i.forwardRef((o,c)=>{const{__scopeSelect:s,onAutoScroll:p,...u}=o,N=De("SelectScrollButton",s),g=i.useRef(null),m=nt(s),x=i.useCallback(()=>{g.current!==null&&(window.clearInterval(g.current),g.current=null)},[]);return i.useEffect(()=>()=>x(),[x]),Se(()=>{m().find(_=>_.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[m]),e.jsx(ie.div,{"aria-hidden":!0,...u,ref:c,style:{flexShrink:0,...u.style},onPointerDown:J(u.onPointerDown,()=>{g.current===null&&(g.current=window.setInterval(p,50))}),onPointerMove:J(u.onPointerMove,()=>{N.onItemLeave?.(),g.current===null&&(g.current=window.setInterval(p,50))}),onPointerLeave:J(u.onPointerLeave,()=>{x()})})}),Da="SelectSeparator",Ea=i.forwardRef((o,c)=>{const{__scopeSelect:s,...p}=o;return e.jsx(ie.div,{"aria-hidden":!0,...p,ref:c})});Ea.displayName=Da;var jt="SelectArrow",Aa=i.forwardRef((o,c)=>{const{__scopeSelect:s,...p}=o,u=rt(s),N=ke(jt,s),g=De(jt,s);return N.open&&g.position==="popper"?e.jsx(Yo,{...u,...p,ref:c}):null});Aa.displayName=jt;var _a="SelectBubbleInput",fo=i.forwardRef(({__scopeSelect:o,value:c,...s},p)=>{const u=i.useRef(null),N=ve(p,u),g=ea(c);return i.useEffect(()=>{const m=u.current;if(!m)return;const x=window.HTMLSelectElement.prototype,_=Object.getOwnPropertyDescriptor(x,"value").set;if(g!==c&&_){const I=new Event("change",{bubbles:!0});_.call(m,c),m.dispatchEvent(I)}},[g,c]),e.jsx(ie.select,{...s,style:{...Vo,...s.style},ref:N,defaultValue:c})});fo.displayName=_a;function vo(o){return o===""||o===void 0}function bo(o){const c=Bo(o),s=i.useRef(""),p=i.useRef(0),u=i.useCallback(g=>{const m=s.current+g;c(m),(function x(C){s.current=C,window.clearTimeout(p.current),C!==""&&(p.current=window.setTimeout(()=>x(""),1e3))})(m)},[c]),N=i.useCallback(()=>{s.current="",window.clearTimeout(p.current)},[]);return i.useEffect(()=>()=>window.clearTimeout(p.current),[]),[s,u,N]}function No(o,c,s){const u=c.length>1&&Array.from(c).every(C=>C===c[0])?c[0]:c,N=s?o.indexOf(s):-1;let g=Ia(o,Math.max(N,0));u.length===1&&(g=g.filter(C=>C!==s));const x=g.find(C=>C.textValue.toLowerCase().startsWith(u.toLowerCase()));return x!==s?x:void 0}function Ia(o,c){return o.map((s,p)=>o[(c+p)%o.length])}var Ta=Wt,Ra=Jt,Pa=Zt,za=Qt,Ma=eo,Oa=to,$a=no,La=lo,Fa=uo,Va=po,Ba=go,Ua=xo;function mt({...o}){return e.jsx(Ta,{"data-slot":"select",...o})}function pt({...o}){return e.jsx(Pa,{"data-slot":"select-value",...o})}function gt({className:o,children:c,...s}){return e.jsxs(Ra,{"data-slot":"select-trigger",className:Ve("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-full items-center justify-between rounded-md border bg-transparent px-3 py-2 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&>span]:line-clamp-1",o),...s,children:[c,e.jsx(za,{asChild:!0,children:e.jsx(Gt,{className:"size-4 opacity-50"})})]})}function xt({className:o,children:c,position:s="popper",...p}){return e.jsx(Ma,{children:e.jsxs(Oa,{"data-slot":"select-content",className:Ve("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",o),position:s,...p,children:[e.jsx(Ha,{}),e.jsx($a,{className:Ve("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:c}),e.jsx(qa,{})]})})}function et({className:o,children:c,...s}){return e.jsxs(La,{"data-slot":"select-item",className:Ve("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",o),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Va,{children:e.jsx(ta,{className:"size-4"})})}),e.jsx(Fa,{children:c})]})}function Ha({className:o,...c}){return e.jsx(Ba,{"data-slot":"select-scroll-up-button",className:Ve("flex cursor-default items-center justify-center py-1",o),...c,children:e.jsx(sa,{className:"size-4"})})}function qa({className:o,...c}){return e.jsx(Ua,{"data-slot":"select-scroll-down-button",className:Ve("flex cursor-default items-center justify-center py-1",o),...c,children:e.jsx(Gt,{className:"size-4"})})}const Ka=o=>{switch(o){case"pendiente":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800";case"subido":return"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border-blue-200 dark:border-blue-800";case"vigente":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border-green-200 dark:border-green-800";case"caducado":return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-200 dark:border-orange-800";case"rechazado":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 border-red-200 dark:border-red-800";default:return"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-300 border-gray-200 dark:border-gray-700"}},Ga=o=>{switch(o){case"pendiente":return e.jsx(qt,{className:"w-4 h-4"});case"subido":return e.jsx(Fe,{className:"w-4 h-4"});case"vigente":return e.jsx(je,{className:"w-4 h-4"});case"caducado":return e.jsx(Re,{className:"w-4 h-4"});case"rechazado":return e.jsx(me,{className:"w-4 h-4"});case"subiendo":return e.jsx(Fe,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-pulse"});case"procesando":return e.jsx(Le,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"});case"analizando":return e.jsx(Kt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"});case"completado":return e.jsx(je,{className:"w-4 h-4 text-green-600 dark:text-green-400"});case"error":return e.jsx(me,{className:"w-4 h-4 text-red-600 dark:text-red-400"});default:return e.jsx(Te,{className:"w-4 h-4"})}},yt=o=>{if(!o||o===0||isNaN(o))return"0 Bytes";const c=1024,s=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(o)/Math.log(c));return parseFloat((o/Math.pow(c,p)).toFixed(2))+" "+s[p]},ot=o=>{if(!o)return"Fecha no disponible";try{let c;if(o.includes("-"))if(o.match(/^\d{4}-\d{2}-\d{2}$/)){const[s,p,u]=o.split("-");c=new Date(parseInt(s),parseInt(p)-1,parseInt(u))}else c=new Date(o);else isNaN(Number(o))?c=new Date(o):c=new Date(Number(o));return isNaN(c.getTime())?"Fecha inválida":c.toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}catch(c){return console.error("Error formateando fecha:",o,c),"Fecha inválida"}},Bt=o=>{const c=o.fechaExpedicion,s=o.vigenciaDocumento;if(o.diasRestantesVigencia,!c&&!s)return`${yt(o.tamaño||0)} • ${ot(o.fechaSubida)}`;let p=yt(o.tamaño||0);return c&&(p+=` • ${ot(c)}`),p},ht=o=>{console.log("🔍 Documento completo:",{concepto:o.concepto,estado:o.estado,archivos:o.archivos}),o.archivos&&o.archivos.length>0&&o.archivos.forEach((s,p)=>{console.log(`📄 Archivo ${p+1}:`,{nombre:s.nombre,estado:s.estado,fechaExpedicion:s.fechaExpedicion,vigenciaDocumento:s.vigenciaDocumento,diasRestantesVigencia:s.diasRestantesVigencia,validacionIA:s.validacionIA})});const c=o.archivos?.find(s=>s.estado==="completado"&&(s.metadata?.vigencia_documento||s.vigenciaDocumento));if(c){const s=c.metadata?.vigencia_documento||c.vigenciaDocumento;if(s){const p=new Date(s),u=new Date,N=p.getTime()-u.getTime(),g=Math.ceil(N/(1e3*60*60*24)),m=c.metadata?.vigencia_documento?"BD (metadata)":"IA (JSON)";return console.log(`✅ Usando vigencia desde ${m}:`,s,"Días calculados:",g),{fecha:s,diasRestantes:g,esVigenciaReal:!0}}}return console.log("⚠️ No hay archivos con vigencia IA, usando fechaLimite:",o.fechaLimite),{fecha:o.fechaLimite,diasRestantes:null,esVigenciaReal:!1}},Ns=({campusDelDirector:o,documentosRequeridos:c,campusSeleccionado:s,error:p})=>{console.log("=== PROPS RECIBIDAS AL CARGAR COMPONENTE ==="),console.log("campusDelDirector:",o?.length||0,o),console.log("documentosIniciales:",c?.length||0,c),console.log("campusInicial:",s),console.log("error:",p),c&&c.length>0&&(console.log("=== DETALLE DE DOCUMENTOS INICIALES ==="),c.forEach((t,r)=>{console.log(`Documento ${r+1}:`,{id:t.id,concepto:t.concepto,estado:t.estado,archivos:t.archivos,cantidad_archivos:t.archivos?.length||0}),t.archivos&&t.archivos.length>0?(console.log(`  Archivos del documento "${t.concepto}":`),t.archivos.forEach((a,n)=>{console.log(`    Archivo ${n+1}:`,{id:a.id,nombre:a.nombre,estado:a.estado,tamaño:a.tamaño,fechaSubida:a.fechaSubida})})):console.log(`  Documento "${t.concepto}" no tiene archivos`)}));const[u,N]=i.useState(s),g=(c||[]).map(t=>({...t,archivos:t.archivos||[]}));console.log("=== PROCESAMIENTO DOCUMENTOS CON ARCHIVOS ==="),console.log("documentosConArchivos procesados:",g.length),g.forEach((t,r)=>{console.log(`DocConArchivos ${r+1}: "${t.concepto}" - ${t.archivos?.length||0} archivos`)});const[m,x]=i.useState(g),[C,_]=i.useState(null),[I,V]=i.useState({}),[d,S]=i.useState(g[0]||null),[b,k]=i.useState("todos"),z=i.useRef(null),[y,T]=i.useState(""),[ge,W]=i.useState(!1),[ye,O]=i.useState(0),[le,F]=i.useState(""),[xe,te]=i.useState(""),[G,re]=i.useState(!1),[ce,oe]=i.useState(0),[X,ae]=i.useState(0),[de,ue]=i.useState(new Set),[Ue,we]=i.useState(!1),[He,qe]=i.useState(""),[be,M]=i.useState(!1),[Ee,h]=i.useState(!1),[B,q]=i.useState(!1),[D,L]=i.useState(null),j=t=>t.uniqueKey||t.id,K=t=>t.archivos||[],Ne=t=>{const r=K(t);if(r.length===0)return!0;const a=Z(t),n=U(a);return n==="vigente"&&!H(t)?!1:n==="caducado"||H(t)?!0:!(r.find(w=>w.estado==="completado"&&(!w.validacionIA||w.validacionIA.coincide))&&a!=="rechazado")},Ae=async()=>{if(!u){console.log("No hay campus actual, no se puede refrescar");return}try{console.log("=== REFRESCANDO DOCUMENTOS DESDE SERVIDOR ==="),console.log("Campus actual:",u.ID_Campus,u.Campus),console.log("Tipo de documento seleccionado:",he),he==="medicos"?await Ge():await Ke()}catch(t){console.error("Error al refrescar documentos:",t),M(!1),h(!0),Je(!1)}},Ke=async()=>{if(!u){console.log("No hay campus actual para documentos legales");return}try{M(!0),h(!1);const t=await fetch(`/documentos/upload?campus=${u.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(t.ok){const r=await t.json();if(console.log("Respuesta del servidor (legales):",r),r.props?.documentosRequeridos){console.log("Documentos legales recibidos:",r.props.documentosRequeridos.length);const a=(r.props.documentosRequeridos||[]).map(n=>({...n,archivos:n.archivos||[]}));if(x(a),console.log("Documentos legales actualizados"),d){const n=a.find(f=>f.id===d.id);n&&(S(n),console.log("Documento seleccionado actualizado"))}else a.length>0&&(S(a[0]),console.log("Primer documento seleccionado por defecto"));h(!0),M(!1)}else console.log("No se recibieron documentos legales en la respuesta"),M(!1),h(!0)}else console.error("Error al actualizar documentos legales:",t.status,t.statusText),M(!1),h(!0)}catch(t){console.error("Error en refrescarDocumentosLegales:",t),M(!1),h(!0)}},Ge=async()=>{if(!u){console.log("No hay campus actual para documentos médicos");return}console.log("=== REFRESCANDO DOCUMENTOS MÉDICOS OPTIMIZADO ==="),console.log("Campus:",u.ID_Campus,u.Campus),M(!0),h(!1),Je(!0);try{const t=Date.now();console.log("🔄 Realizando consulta optimizada...");const r=await fetch(`/documentos/medicos-optimizado?campus_id=${u.ID_Campus}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(!r.ok)throw new Error(`Error en la respuesta: ${r.status}`);const a=await r.json(),n=Date.now()-t;if(console.log(`⚡ Consulta optimizada completada en ${n}ms`),console.log("Respuesta optimizada:",a),!a.success||!a.carreras||!a.documentos_por_carrera){console.log("No se recibieron datos válidos de documentos médicos"),Oe([]);return}const f=a.carreras,w=a.documentos_por_carrera;console.log(`📋 Procesando ${f.length} carreras médicas...`),Ye(f),console.log("🔄 Carreras médicas actualizadas en el estado:",f);const l=m.filter(P=>P.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(l.length===0){console.log("No se encontraron documentos base de cartas de intención"),Oe([]);return}if(!f||f.length===0){console.log("No se recibieron carreras médicas"),Oe([]);return}const R=[];if(f.forEach(P=>{const $=P.ID_Especialidad,A=P.Descripcion,v=w[$]||[];l.forEach(Y=>{const E=`${Y.id}_carrera_${$}`,ee=v.find(Ie=>Ie.id===Y.id),_e={...Y,id:Y.id,documentoOriginalId:Y.id,uniqueKey:E,concepto:`${Y.concepto} - ${A}`,descripcion:`${Y.descripcion} para la carrera de ${A}`,carreraId:String($),carreraNombre:A,estado:ee?.estado||"pendiente",archivos:ee?.archivos||[]};console.log(`✅ Documento generado para ${A}:`,{uniqueKey:_e.uniqueKey,estado:_e.estado,totalArchivos:_e.archivos?.length||0}),R.push(_e)})}),console.log(`📚 Total documentos médicos generados: ${R.length}`),Oe(R),console.log("📋 Documentos médicos actualizados en estado separado"),d&&d.uniqueKey){const P=R.find($=>$.uniqueKey===d.uniqueKey);P&&(S(P),console.log("Documento médico seleccionado actualizado"))}else R.length>0&&(S(R[0]),console.log("Primer documento médico seleccionado por defecto"))}catch(t){console.error("Error en consulta optimizada de documentos médicos:",t),Oe([])}finally{h(!0),M(!1),Je(!1)}},St=()=>{setTimeout(()=>{console.log("Actualizando panel automáticamente..."),Ae()},2e3)};i.useEffect(()=>{console.log("=== CARGA INICIAL DEL COMPONENTE ==="),console.log("Campus inicial:",s),console.log("Campus actual:",u),console.log("Documentos iniciales:",c?.length||0),M(!0),h(!1);const t=c?.every(a=>!a.archivos||a.archivos.length===0)||!1,r=!c||c.length===0;if(s&&(r||t))console.log(r?"Campus inicial detectado SIN documentos, refrescando desde servidor...":"Campus inicial detectado con documentos VACÍOS (sin archivos), refrescando desde servidor..."),(async()=>{try{console.log("=== REFRESCANDO DOCUMENTOS CARGA INICIAL ==="),console.log("Campus inicial:",s.ID_Campus,s.Campus);const n=await fetch("/documentos/cambiar-campus",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({campus_id:s.ID_Campus})});if(n.ok){const f=await n.json();if(console.log("Respuesta del servidor (carga inicial):",f),f.documentos){console.log("Documentos recibidos (carga inicial):",f.documentos.length);const w=(f.documentos||[]).map(l=>({...l,archivos:l.archivos||[]}));x(w),console.log("Documentos estado actualizado (carga inicial)"),w.length>0&&(S(w[0]),console.log("Primer documento seleccionado por defecto (carga inicial)")),h(!0),M(!1)}else console.log("No se recibieron documentos en la respuesta (carga inicial)"),M(!1),h(!0)}else console.error("Error al cargar documentos iniciales:",n.status,n.statusText),M(!1),h(!0)}catch(n){console.error("Error al refrescar documentos (carga inicial):",n),M(!1),h(!0)}})();else if(s&&c&&c.length>0&&!t){if(console.log("Campus inicial detectado CON documentos válidos Y CON ARCHIVOS, usando documentos iniciales..."),console.log("Documentos iniciales disponibles:",c.length),console.log("Estado documentos actual:",m.length),console.log("Documento seleccionado actual:",d?.concepto||"ninguno"),!d&&m.length>0)console.log("Seleccionando primer documento por defecto:",m[0].concepto),S(m[0]);else if(!d&&c.length>0){const a={...c[0],archivos:c[0].archivos||[]};console.log("Fallback: Seleccionando primer documento de documentos iniciales:",a.concepto),S(a)}else d&&console.log("Ya hay un documento seleccionado:",d.concepto);h(!0),M(!1)}else if(console.log("No hay campus inicial, usando documentos proporcionados"),c&&c.length>0){const a=c.map(n=>({...n,archivos:n.archivos||[]}));console.log("Actualizando estado con documentos proporcionados"),x(a),!d&&a.length>0&&(console.log("Seleccionando primer documento por defecto"),S(a[0])),h(!0),M(!1)}else M(!1),h(!0)},[]),i.useEffect(()=>{console.log("=== ESTADO DOCUMENTOS CAMBIÓ ==="),console.log("Documentos en estado:",m.length),console.log("Documento seleccionado:",d?.concepto||"ninguno"),m.length>0&&(console.log("=== DETALLE DE DOCUMENTOS EN ESTADO ==="),m.forEach((t,r)=>{const a=t.archivos?.length||0;console.log(`Estado Doc ${r+1}: "${t.concepto}" - ${a} archivos`),a>0&&t.archivos?.forEach((n,f)=>{console.log(`  Estado Archivo ${f+1}: ${n.nombre} (${n.estado})`)})})),m.length>0&&!d&&(console.log("Auto-seleccionando primer documento:",m[0].concepto),S(m[0]))},[m,d]),i.useEffect(()=>{console.log("=== VERIFICANDO ANALISIS DE ARCHIVOS ==="),console.log("Documentos actuales:",m.length);const t=m.flatMap(r=>(r.archivos||[]).filter(a=>a.estado==="completado"&&!a.fechaExpedicion&&!a.vigenciaDocumento));console.log("Archivos completados sin analisis:",t.length),t.forEach(r=>{console.log(`- ${r.nombre} (${r.estado})`)}),t.length>0?console.log("Archivos completados detectados, datos deberían venir del backend"):console.log("Todos los archivos ya tienen analisis o no hay archivos completados")},[m]),i.useEffect(()=>{if(d){const t=m.find(r=>j(r)===j(d));t&&t.archivos?.some((a,n)=>{const f=d.archivos?.[n];return f&&(a.fechaExpedicion!==f.fechaExpedicion||a.vigenciaDocumento!==f.vigenciaDocumento||a.diasRestantesVigencia!==f.diasRestantesVigencia)})&&(console.log("🔄 FECHAS ACTUALIZADAS DETECTADAS - Actualizando selectedDocumento"),S(t))}},[m]),i.useEffect(()=>{u&&u.ID_Campus&&(console.log("=== CAMPUS ACTUAL CAMBIÓ ==="),console.log("Nuevo campus actual:",u.ID_Campus,u.Campus),console.log("Documentos actuales:",m.length),m.length===0?(console.log("No hay documentos, refrescando..."),Ae()):console.log("Ya hay documentos cargados, no refrescando automáticamente"))},[u]);const jo=(t,r)=>{t.validacionIA&&!t.validacionIA.coincide&&(L({fileName:t.nombre,documentType:r,reason:t.validacionIA.razon||"Documento no válido",percentage:t.validacionIA.porcentaje||0,expectedType:r,detectedType:"Información de análisis IA"}),q(!0))},yo=t=>{const r=K(t);if(r.length===0)return"No hay archivos subidos para este documento";const a=Z(t),n=U(a);return n==="rechazado"?"El documento fue rechazado por un administrador. Puede subir un nuevo archivo.":n==="caducado"||H(t)?"El documento ha caducado por vencimiento de fecha. Puede subir un nuevo archivo.":n==="vigente"&&!H(t)?"Documento aprobado por administrador. No se pueden subir más archivos.":r.find(l=>l.estado==="completado"&&(!l.validacionIA||l.validacionIA.coincide))?"Documento validado automáticamente por IA. Esperando revisión del administrador.":r.find(l=>l.estado==="rechazado"||l.validacionIA&&!l.validacionIA.coincide)?"El documento anterior fue rechazado por validación automática. Puede subir un nuevo archivo.":"Puede subir archivos para este documento"},kt=async t=>{console.log("=== CAMBIO DE CAMPUS ==="),console.log("Nuevo campus ID:",t),M(!0),h(!1);try{const r=await dt("/documentos/cambiar-campus",{method:"POST",body:JSON.stringify({campus_id:t})});if(r.ok){const a=await r.json();console.log("Respuesta del servidor:",a),N(a.campus),console.log("Campus actualizado:",a.campus);const n=a.documentos.map(f=>({...f,archivos:f.archivos||[]}));console.log("Documentos cargados:",n.length),x(n),S(n[0]||null),V({}),It("legales"),await Dt(t),h(!0),M(!1)}else console.error("Error en la respuesta del servidor:",r.status,r.statusText),M(!1),h(!0)}catch(r){console.error("Error cambiando campus:",r),M(!1),h(!0)}},Dt=async t=>{if(t){At(!0);try{console.log(`=== VERIFICANDO CARRERAS MÉDICAS PARA CAMPUS ${t} ===`);const r=await dt(`/documentos/campus/${t}/medico`);if(r.ok){const a=await r.json();it(a.tiene_carreras_medicas),Ye(a.carreras_medicas||[]),console.log(`✅ Campus ${t} tiene carreras médicas:`,a.tiene_carreras_medicas),console.log("📋 Carreras médicas disponibles:",a.carreras_medicas),(a.carreras_medicas||[]).forEach(n=>{console.log(`  - ID_Especialidad: ${n.ID_Especialidad}, Descripcion: ${n.Descripcion}`)})}else console.error("❌ Error verificando campus médico:",r.status),it(!1),Ye([])}catch(r){console.error("❌ Error verificando campus médico:",r),it(!1),Ye([])}finally{At(!1)}}},wo=(t,r)=>{t.preventDefault(),_(r)},Co=t=>{t.preventDefault(),_(null)},So=(t,r)=>{t.preventDefault(),_(null);const a=Array.from(t.dataTransfer.files);Et(a,r)},Et=(t,r)=>{console.log("=== HANDLE FILE SELECTION ==="),console.log("Files received:",t),console.log("DocumentoId:",r),console.log("Current selectedFiles before update:",I),V(a=>{const n={...a,[r]:[...a[r]||[],...t]};return console.log("Updated selectedFiles:",n),n})},ko=(t,r)=>{if(console.log("=== HANDLE FILE INPUT CHANGE ==="),console.log("Event target files:",t.target.files),console.log("DocumentoId:",r),t.target.files){const a=Array.from(t.target.files);console.log("Files array:",a),console.log("Files length:",a.length),a.forEach((n,f)=>{console.log(`File ${f}:`,{name:n.name,size:n.size,type:n.type})}),Et(a,r)}else console.log("❌ No files in event target")},Do=(t,r)=>{V(a=>({...a,[t]:a[t]?.filter((n,f)=>f!==r)||[]}))},Eo=async t=>{console.log("INICIANDO UPLOAD - DocumentoKey:",t),console.log("Tipo de documento actual:",he),console.log("DocumentosDelTipo disponibles:",fe.length),fe.forEach((n,f)=>{console.log(`  Doc ${f}: key="${j(n)}", uniqueKey="${n.uniqueKey}", id="${n.id}"`)});const r=I[t];console.log("Archivos a subir:",r),console.log("Estado completo selectedFiles:",I);const a=fe.find(n=>j(n)===t);if(!a){console.error("Documento no encontrado con clave:",t),console.error("Claves disponibles:",fe.map(n=>j(n))),alert("Error: Documento no encontrado");return}if(console.log("Documento encontrado:",{id:a.id,uniqueKey:a.uniqueKey,documentoOriginalId:a.documentoOriginalId,carreraId:a.carreraId,carreraNombre:a.carreraNombre}),!r||r.length===0){console.log("No hay archivos para subir"),alert("No hay archivos seleccionados. Por favor selecciona un archivo primero.");return}if(!u?.ID_Campus){console.error("No hay campus seleccionado"),alert("No hay campus seleccionado");return}console.log("Campus actual:",u.ID_Campus),W(!0),O(0),F("Preparando archivos..."),re(!1),oe(0),ae(r.length),V(n=>({...n,[t]:[]})),console.log(`Procesando ${r.length} archivo(s)...`);for(let n=0;n<r.length;n++){const f=r[n];console.log(`Procesando archivo ${n+1}/${r.length}: ${f.name}`),te(f.name),F(`Subiendo ${f.name}...`),O(10);try{const w=new FormData;w.append("archivo",f);const l=a.documentoOriginalId||a.id;w.append("documento_id",l.toString()),w.append("campus_id",u.ID_Campus),console.log("Usando documento_id para backend:",l,"(original:",a.documentoOriginalId,", compuesto:",a.id,")"),a.carreraId&&(w.append("carrera_id",a.carreraId),console.log("Agregando carrera_id (ID_Especialidad):",a.carreraId,"para carrera:",a.carreraNombre)),console.log("=== DEBUG FORMDATA ===");for(let v of w.entries())console.log(v[0]+":",v[1]);await new Promise(v=>setTimeout(v,500)),O(25),F(`Validando ${f.name}...`),await new Promise(v=>setTimeout(v,500)),O(50),F(`Guardando ${f.name} en servidor...`),await new Promise(v=>setTimeout(v,500)),O(75),F(`Finalizando subida de ${f.name}...`),console.log("Iniciando petición de subida real...");const R=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");console.log("CSRF Token:",R);const P=new FormData;P.append("archivo",f),P.append("documento_id",l.toString()),P.append("campus_id",u.ID_Campus),a.carreraId&&P.append("carrera_id",a.carreraId),console.log("Testing with fresh FormData:");for(let v of P.entries())console.log(`  ${v[0]}:`,v[1]),v[1]instanceof File&&console.log(`    File details: name=${v[1].name}, size=${v[1].size}, type=${v[1].type}`);const $=await fetch("/documentos/subir-archivo",{method:"POST",headers:{"X-CSRF-TOKEN":R||""},body:P});console.log("Status de respuesta:",$.status,$.statusText),console.log("Headers de respuesta:",$.headers);const A=await $.text();if(console.log("Respuesta RAW del servidor:",A),$.ok)try{const v=JSON.parse(A);if(console.log("Respuesta parseada exitosamente:",v),!v.archivo||!v.archivo.estado){console.error("El servidor no procesó el archivo correctamente"),console.error("data.archivo:",v.archivo),F("Error: El archivo no se procesó correctamente en el servidor"),W(!1);return}O(100),F(`${f.name} subido exitosamente`),oe(E=>E+1),v.archivo.estado==="analizando"&&(F(`Analizando ${f.name} con IA...`),O(100),await new Promise(E=>setTimeout(E,2e3)));const Y={id:v.archivo.id,nombre:f.name,tamaño:v.archivo.tamaño||f.size||0,fechaSubida:new Date().toISOString().split("T")[0],estado:v.archivo.estado==="analizando"?"analizando":"completado",progreso:100,mensaje:v.archivo.estado==="analizando"?"Analizando con IA...":"Completado"};x(E=>E.map(ee=>j(ee)===t?{...ee,estado:"subido",archivos:[...K(ee),Y]}:ee)),d&&j(d)===t&&S(E=>E&&{...E,estado:"subido",archivos:[...K(E),Y]}),ue(E=>new Set(E).add(v.archivo.id)),setTimeout(()=>{ue(E=>{const ee=new Set(E);return ee.delete(v.archivo.id),ee})},5e3),console.log("Archivo agregado inmediatamente al panel:",Y),v.archivo.estado==="analizando"&&Io(v.archivo.id,t,1),console.log("Programando actualización automática del panel..."),St()}catch(v){console.error("Error parseando JSON:",v),console.error("Respuesta no es JSON válido:",A),F("Error: El servidor devolvió una respuesta inválida"),W(!1);return}else{console.log("Status de error:",$.status,$.statusText),console.log("Respuesta RAW de error:",A);try{const v=JSON.parse(A);console.error("Error subiendo archivo:",v),v.validation_errors&&(console.error("Errores de validación específicos:"),Object.keys(v.validation_errors).forEach(Y=>{console.error(`  - ${Y}: ${v.validation_errors[Y]}`)})),v.debug_info&&console.error("Debug info:",v.debug_info),F(`Error al subir ${f.name}: ${v.error||"Error desconocido"}`)}catch(v){console.error("Error parseando respuesta de error:",v),console.error("Respuesta de error no es JSON válido:",A),F(`Error al subir ${f.name}: Error del servidor (${$.status})`)}O(0),await new Promise(v=>setTimeout(v,2e3))}}catch(w){console.error("Error en upload:",w),F(`Error de conexión con ${f.name}`),O(0),M(!1),h(!0),Je(!1),await new Promise(l=>setTimeout(l,2e3))}}re(!0),O(100),F(`Todos los archivos procesados exitosamente (${ce+1}/${r.length})`),te(""),await new Promise(n=>setTimeout(n,3e3)),W(!1),re(!1),O(0),F(""),te(""),oe(0),ae(0),console.log("Proceso de subida completado exitosamente")},[ct,Me]=i.useState(new Set),[Ao,it]=i.useState(!1),[_o,At]=i.useState(!1),[_t,Ye]=i.useState([]),[lt,Oe]=i.useState([]),[Wa,Je]=i.useState(!1),[he,It]=i.useState("legales");i.useEffect(()=>()=>{console.log("Limpiando monitores activos al desmontar componente"),Me(new Set)},[]),i.useEffect(()=>{u?.ID_Campus&&Dt(u.ID_Campus)},[u]),i.useEffect(()=>{u&&(console.log(`🔄 Tipo de documento cambió a: ${he} - Refrescando estado...`),M(!0),h(!1),Oe([]),he==="medicos"?Ae():(h(!0),M(!1)))},[he,u]);const Io=async(t,r,a=2)=>{if(ct.has(t)){console.log(`Ya existe un monitor activo para archivo ${t}`);return}Me(w=>new Set(w).add(t));let n=0;const f=async()=>{n++;try{console.log(`Verificando análisis para archivo ${t} - Intento ${n}/${a}`);const w=await dt(`/documentos/analisis/estado?archivo_id=${t}`,{method:"GET"});if(w.ok){const l=await w.json();if(console.log("Estado del análisis:",l),x(R=>R.map(P=>{if(j(P)===r){const $=K(P).map(E=>{if(E.id===t){const ee=l.tiene_analisis;let _e=ee?"completado":"analizando",Ie="";if(l.estado==="rechazado"||ee&&l.analisis&&l.analisis.validacion&&!l.analisis.validacion.coincide){_e="rechazado";let Ce="";l.analisis&&l.analisis.validacion?Ce=l.analisis.validacion.razon:l.analisis&&l.analisis.documento?Ce=l.analisis.documento.observaciones:Ce="Documento no cumple con los requisitos",Ie=`Documento rechazado: ${Ce}`;const Ot=m.find(Po=>j(Po)===r);L({fileName:E.nombre,documentType:Ot?.concepto||"Documento",reason:Ce,percentage:0,expectedType:l.analisis?.validacion?.documento_esperado||Ot?.concepto||"Tipo de documento requerido",detectedType:l.analisis?.validacion?.documento_detectado||l.analisis?.documento?.nombre_detectado||l.documento?.tipo_detectado||"Tipo no identificado",cityValidation:l.analisis?.validacion?.ciudad_campus?{campusCity:l.analisis.validacion.ciudad_campus,documentCities:l.analisis.validacion.ciudades_documento||[],isValid:l.analisis.validacion.coincide||!1,details:l.analisis.validacion.evaluacion_gpt==="ciudad_incorrecta"?"El documento pertenece a una ciudad diferente a la del campus seleccionado":void 0}:void 0}),q(!0)}else if(ee&&l.analisis&&l.analisis.validacion){let Ce=`Documento validado correctamente (${l.analisis.validacion.porcentaje_coincidencia}% coincidencia)`;l.analisis.validacion.ciudad_campus&&l.analisis.validacion.ciudades_documento&&(Ce+=` • Ubicación: ${l.analisis.validacion.ciudad_campus} ✓`),Ie=Ce}else ee?Ie="Análisis IA completado":Ie=`Analizando documento... (${n}/${a})`;return{...E,estado:_e,mensaje:Ie,validacionIA:l.analisis?.validacion?{coincide:l.analisis.validacion.coincide,porcentaje:l.analisis.validacion.porcentaje_coincidencia,razon:l.analisis.validacion.razon,accion:l.analisis.validacion.accion}:void 0,fechaExpedicion:l.analisis?.documento?.fecha_expedicion,vigenciaDocumento:l.analisis?.documento?.vigencia_documento,diasRestantesVigencia:l.analisis?.documento?.dias_restantes_vigencia,metadata:l.metadata?{folio_documento:l.metadata.folio_documento,fecha_expedicion:l.metadata.fecha_expedicion,vigencia_documento:l.metadata.vigencia_documento,lugar_expedicion:l.metadata.lugar_expedicion,estado_bd:l.metadata.estado_bd||l.estado_bd}:void 0}}return E});let A=P.estado;const v=$.find(E=>E.estado==="completado"&&(!E.validacionIA||E.validacionIA.coincide));return $.find(E=>E.estado==="rechazado"||E.estado==="completado"&&E.validacionIA&&!E.validacionIA.coincide)?(A="rechazado",console.log("Documento rechazado - cambiando estado inmediatamente")):v?(A="vigente",console.log("Documento aprobado - cambiando a vigente")):$.some(E=>E.estado==="completado")&&(A="subido",console.log("Documento subido")),{...P,estado:A,archivos:$}}return P})),d&&j(d)===r&&S(R=>{if(R&&m.find($=>j($)===r)){const $=l.estado==="rechazado"||l.analisis?.validacion&&!l.analisis.validacion.coincide,A={...R,estado:$?"rechazado":l.analisis?.validacion?.coincide?"vigente":R.estado,archivos:R.archivos?.map(v=>{if(v.id===t){const Y=$?"rechazado":l.tiene_analisis?"completado":"analizando";return{...v,estado:Y,validacionIA:l.analisis?.validacion?{coincide:l.analisis.validacion.coincide,porcentaje:l.analisis.validacion.porcentaje_coincidencia,razon:l.analisis.validacion.razon,accion:l.analisis.validacion.accion}:void 0,fechaExpedicion:l.analisis?.documento?.fecha_expedicion,vigenciaDocumento:l.analisis?.documento?.vigencia_documento,diasRestantesVigencia:l.analisis?.documento?.dias_restantes_vigencia}}return v})||[]};return console.log("Actualizando selectedDocumento en tiempo real:",A),A}return R}),l.tiene_analisis||n>=a){if(console.log(`Finalizando monitoreo para archivo ${t}. Análisis completado: ${l.tiene_analisis}, Intentos: ${n}`),Me(R=>{const P=new Set(R);return P.delete(t),P}),l.tiene_analisis){console.log("Análisis IA completado - Actualizando panel..."),console.log("📅 FECHAS RECIBIDAS DEL ANÁLISIS:",{fecha_expedicion:l.analisis?.documento?.fecha_expedicion,vigencia_documento:l.analisis?.documento?.vigencia_documento,dias_restantes:l.analisis?.documento?.dias_restantes_vigencia});const R=m.find(A=>j(A)===r),P=R?.archivos?.find(A=>A.id===t);if(l.estado==="rechazado"||l.analisis&&l.analisis.validacion&&!l.analisis.validacion.coincide)console.log("Documento rechazado - Actualizando interfaz inmediatamente"),setTimeout(()=>{x(A=>[...A])},100);else if(l.analisis?.validacion?.coincide){console.log("Documento aprobado por IA - Mostrando notificación de éxito");const A=R?.archivos?.find(v=>v.id===t);qe(`${A?.nombre||"Documento"} validado exitosamente`),we(!0),setTimeout(()=>we(!1),4e3),setTimeout(()=>{console.log("🔄 Forzando re-render para actualizar fechas en UI"),S(v=>v&&{...v})},500)}St()}!l.tiene_analisis&&n>=a&&(console.warn(`Timeout en análisis de archivo ${t} después de ${a} intentos`),x(R=>R.map(P=>{if(j(P)===r){const $=K(P).map(A=>A.id===t?{...A,estado:"error"}:A);return{...P,archivos:$}}return P})));return}setTimeout(f,2e3)}else console.error(`Error en petición de estado: ${w.status}`),n<a?setTimeout(f,2e3):Me(l=>{const R=new Set(l);return R.delete(t),R})}catch(w){console.error("Error monitoreando análisis:",w),n<a?setTimeout(f,3e3):(console.error(`Error persistente en monitoreo de archivo ${t}, cancelando.`),Me(l=>{const R=new Set(l);return R.delete(t),R}))}};f()},To=()=>{console.log("Deteniendo todos los monitores manualmente"),Me(new Set),x(t=>t.map(r=>({...r,archivos:K(r).map(a=>a.estado==="analizando"?{...a,estado:"error"}:a)})))},Tt=t=>{const r=new Date,n=new Date(t).getTime()-r.getTime();return Math.ceil(n/(1e3*60*60*24))},Ro=t=>t<0?"text-red-600":t<=7?"text-orange-600":t<=30?"text-yellow-600":"text-green-600",U=t=>{const r=t.toLowerCase();return console.log("🔄 Estado original:",t,"-> normalizado:",r),r},H=t=>{const r=Z(t),a=U(r);if(a==="caducado")return console.log("✅ Documento marcado como caducado en BD:",t.concepto),!0;const n=ht(t),f=n.diasRestantes!==null?n.diasRestantes:Tt(t.fechaLimite),w=a==="vigente"&&f<0;return w&&console.log("⏰ Documento caducado dinámicamente:",t.concepto,"Días restantes:",f),w},Rt=t=>{const r=Z(t);if(H(t))return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-300 dark:border-orange-800";const a=U(r);return Ka(a)},Pt=t=>{if(H(t))return e.jsx(Re,{className:"w-3 h-3"});const r=Z(t),a=U(r);return Ga(a)},zt=t=>{if(H(t))return"caducado";const r=Z(t);return U(r)},Z=t=>{const r=K(t);console.log(`🔍 Debug ${t.concepto}:`,{total_archivos:r.length,archivos:r.map(n=>({id:n.id,nombre:n.nombre,metadata:n.metadata,tiene_estado_bd:!!n.metadata?.estado_bd}))});const a=r.filter(n=>n.metadata?.estado_bd);if(a.length>0){const n=a.sort((f,w)=>new Date(w.fechaSubida).getTime()-new Date(f.fechaSubida).getTime())[0];return console.log(`🔧 Usando estado de BD para ${t.concepto}:`,n.metadata?.estado_bd),n.metadata?.estado_bd||t.estado}return console.log(`📄 Usando estado JSON para ${t.concepto}:`,t.estado),t.estado},Mt=m.filter(t=>{const r=t.concepto.toLowerCase().includes(y.toLowerCase())||t.descripcion.toLowerCase().includes(y.toLowerCase());let a=!1;const n=U(t.estado);return b==="todos"?a=!0:b==="subido"?a=n==="subido"||n==="vigente"||n==="caducado"||H(t):a=n===b||b==="caducado"&&H(t),r&&a}),fe=(()=>{if(he==="legales")return Mt.filter(t=>!t.concepto.toLowerCase().includes("cartas de intención de campo clínico"));{if(lt.length>0)return console.log("🔄 Usando documentos médicos con estado actualizado:",lt.length),lt;const t=Mt.filter(a=>a.concepto.toLowerCase().includes("cartas de intención de campo clínico"));if(t.length===0||_t.length===0)return[];const r=[];return _t.forEach(a=>{t.forEach(n=>{const f=`${n.id}_carrera_${a.ID_Especialidad}`,w={id:n.id,concepto:`${n.concepto} - ${a.Descripcion}`,descripcion:`${n.descripcion} para la carrera de ${a.Descripcion}`,fechaLimite:n.fechaLimite,estado:"pendiente",archivos:[],obligatorio:n.obligatorio,categoria:n.categoria,documentoOriginalId:n.id,uniqueKey:f,carreraId:String(a.ID_Especialidad),carreraNombre:a.Descripcion};console.log(`📄 Documento generado para ${a.Descripcion}:`,{uniqueKey:w.uniqueKey,carreraId:w.carreraId,carreraIdType:typeof w.carreraId,documentoOriginalId:w.documentoOriginalId}),r.push(w)})}),console.log(`📚 Total documentos médicos generados: ${r.length}`),r}})();return e.jsxs(Jo,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Documentos",href:"/documentos"},{title:"Subir Documentos",href:"/documentos/upload"}],children:[e.jsx(zo,{title:"Subida de Documentos",children:e.jsx("meta",{name:"csrf-token",content:document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""})}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[Ue&&e.jsx("div",{className:"fixed top-4 right-4 z-40 animate-in slide-in-from-right-full duration-500",children:e.jsx(se,{className:"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 shadow-lg",children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center",children:e.jsx(je,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"Archivo subido exitosamente"}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:He})]}),e.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>we(!1),className:"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-200 hover:bg-green-100 dark:hover:bg-green-900/50 h-6 w-6 p-0",children:e.jsx(Xe,{className:"w-3 h-3"})})]})})})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",onClick:t=>t.preventDefault(),children:e.jsx(se,{className:"w-96 mx-4 dark:bg-gray-800 dark:border-gray-700",onClick:t=>t.stopPropagation(),children:e.jsx(ne,{className:"p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"relative",children:G?e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(je,{className:"w-12 h-12 text-green-600 animate-pulse"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-20 h-20 bg-green-600 rounded-full opacity-20 animate-ping"})})]}):e.jsxs("div",{className:"w-16 h-16 mx-auto",children:[e.jsx(Le,{className:"w-16 h-16 text-blue-600 animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full opacity-20 animate-ping"})})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`text-lg font-semibold ${G?"text-green-900 dark:text-green-100":"text-gray-900 dark:text-gray-100"}`,children:G?"Documentos Subidos Exitosamente":"Procesando Documentos"}),xe&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:xe}),e.jsx("p",{className:`text-sm font-medium ${G?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"}`,children:le}),G&&ce>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[e.jsx(je,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("span",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:[ce," de ",X," archivo(s) procesado(s) exitosamente"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Progreso"}),e.jsxs("span",{children:[ye,"%"]})]}),e.jsx($t,{value:ye,className:`h-3 ${G?"bg-green-100 dark:bg-green-900/30":"dark:bg-gray-700"}`})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:G?"Los documentos se están procesando en segundo plano...":"Por favor espera mientras procesamos tus documentos..."}),G&&e.jsxs(Q,{onClick:()=>{W(!1),re(!1),O(0),F(""),te(""),oe(0),ae(0)},className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Continuar"]})]})})})}),B&&D&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",onClick:t=>t.preventDefault(),children:e.jsxs(se,{className:"w-full max-w-2xl bg-white dark:bg-gray-800 shadow-xl dark:border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx(Ze,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(Qe,{className:"text-lg text-gray-900 dark:text-gray-100",children:"Documento Rechazado"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Validación automática"})]})]}),e.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>q(!1),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 h-8 w-8 p-0",children:e.jsx(Xe,{className:"w-4 h-4"})})]})}),e.jsxs(ne,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Archivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg",children:D.fileName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Motivo:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border-l-4 border-red-400 dark:border-red-600",children:D.reason})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Esperado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900/20 p-2 rounded text-center",children:D.expectedType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Detectado:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 bg-orange-50 dark:bg-orange-900/20 p-2 rounded text-center",children:D.detectedType})]})]}),D.cityValidation&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Validación de Ubicación:"}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Campus:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["📍 ",D.cityValidation.campusCity]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Documento de:"}),e.jsxs("p",{className:"text-sm text-gray-700 bg-white p-2 rounded border",children:["🏙️ ",D.cityValidation.documentCities.join(", ")||"No detectado"]})]})]}),D.cityValidation.details&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-yellow-800",children:[e.jsx(me,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:D.cityValidation.details})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"¿Qué hacer?"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Suba el documento correcto o contacte al administrador si considera que es un error."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Q,{variant:"outline",onClick:()=>q(!1),className:"flex-1",children:"Cerrar"}),e.jsxs(Q,{onClick:()=>{q(!1),(d?document.getElementById(`file-input-${j(d)}`):null)?.scrollIntoView({behavior:"smooth"})},className:"flex-1",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Subir Documento Correcto"]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-2 dark:text-gray-100",children:"Subir Documentos"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Selecciona un campus y un documento de la lista para subir los archivos requeridos"})]}),ct.size>0&&e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-spin"}),e.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:[ct.size," análisis en curso"]})]}),e.jsxs(Q,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 hover:bg-blue-100 dark:hover:bg-blue-900/50",onClick:To,children:[e.jsx(Xe,{className:"w-3 h-3 mr-1"}),"Detener"]})]})]})}),(!o||!Array.isArray(o)||o.length===0)&&e.jsx(se,{className:"mb-6 border-destructive",children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(me,{className:"w-5 h-5"}),e.jsx("p",{className:"font-medium",children:p||"No tienes campus asignados para subir documentos"})]})})}),u&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 mb-6",children:[e.jsx(se,{children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Total ",he==="medicos"?"Médicos":"Legales"]}),e.jsx("p",{className:"text-2xl font-bold",children:fe.length})]})]})})}),e.jsx(se,{children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold",children:fe.filter(t=>U(t.estado)==="pendiente").length})]})]})})}),e.jsx(se,{children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Completados"}),e.jsx("p",{className:"text-2xl font-bold",children:fe.filter(t=>U(t.estado)==="vigente"&&!H(t)).length})]})]})})}),e.jsx(se,{children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Caducados"}),e.jsx("p",{className:"text-2xl font-bold",children:fe.filter(t=>U(t.estado)==="caducado"||H(t)).length})]})]})})}),e.jsx(se,{children:e.jsx(ne,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Rechazados"}),e.jsx("p",{className:"text-2xl font-bold",children:fe.filter(t=>U(t.estado)==="rechazado").length})]})]})})})]}),u&&e.jsxs(e.Fragment,{children:[be&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(se,{className:"h-fit",children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Qe,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(mt,{value:u?.ID_Campus||"",onValueChange:kt,children:[e.jsx(gt,{className:"w-52",children:e.jsx(pt,{placeholder:"Selecciona campus"})}),e.jsx(xt,{children:[...o].sort((t,r)=>t.Campus.localeCompare(r.Campus,"es",{sensitivity:"base"})).map(t=>e.jsx(et,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]})}),e.jsx(ne,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Le,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Cargando Documentos"}),e.jsx("p",{className:"text-sm text-gray-500",children:he==="medicos"?"Obteniendo estados de documentos médicos...":"Obteniendo documentos legales..."})]})]})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(se,{className:"h-fit",children:e.jsx(ne,{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Te,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Preparando Información"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Por favor espera mientras cargamos la información completa..."})]})]})})})})]}),!be&&Ee&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(se,{className:"h-fit",children:[e.jsxs(Ze,{className:"pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Qe,{className:"text-lg",children:"Documentos Requeridos"}),o&&Array.isArray(o)&&o.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{htmlFor:"campus-select",className:"text-sm font-medium text-muted-foreground",children:"Campus:"}),e.jsxs(mt,{value:u?.ID_Campus||"",onValueChange:kt,children:[e.jsx(gt,{className:"w-52",children:e.jsx(pt,{placeholder:"Selecciona campus"})}),e.jsx(xt,{children:[...o].sort((t,r)=>t.Campus.localeCompare(r.Campus,"es",{sensitivity:"base"})).map(t=>e.jsx(et,{value:t.ID_Campus,children:t.Campus},t.ID_Campus))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"text-sm font-medium text-muted-foreground",children:"Tipo:"}),e.jsxs(mt,{value:he,onValueChange:t=>{It(t)},children:[e.jsx(gt,{className:"w-40",children:e.jsx(pt,{})}),e.jsxs(xt,{children:[e.jsx(et,{value:"legales",children:"Legales"}),Ao&&e.jsx(et,{value:"medicos",children:"Médicos"})]})]}),_o&&e.jsx(Le,{className:"w-4 h-4 animate-spin text-blue-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Zo,{placeholder:"Buscar documento...",value:y,onChange:t=>T(t.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{variant:b==="todos"?"default":"outline",size:"sm",onClick:()=>k("todos"),children:"Todos"}),e.jsx(Q,{variant:b==="pendiente"?"default":"outline",size:"sm",onClick:()=>k("pendiente"),children:"Pendientes"}),e.jsx(Q,{variant:b==="subido"?"default":"outline",size:"sm",onClick:()=>k("subido"),children:"Subidos"})]})]})]})]}),e.jsx(ne,{className:"p-0",children:e.jsx("div",{ref:z,className:"max-h-[600px] overflow-y-auto",children:fe.map(t=>{const r=t.uniqueKey||t.id,a=d?.uniqueKey===r||d?.id===t.id&&!t.uniqueKey;return e.jsxs("div",{className:`p-4 border-b cursor-pointer transition-colors hover:bg-muted/50 ${a?"bg-primary/10 border-l-4 border-l-primary":""}`,onClick:n=>{n.preventDefault();const f=z.current?.scrollTop||0;S(t),requestAnimationFrame(()=>{z.current&&(z.current.scrollTop=f)})},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:t.concepto}),t.obligatorio&&e.jsx($e,{variant:"destructive",className:"text-xs ml-2",children:"Req."})]}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs($e,{className:Rt(t),variant:"outline",children:[Pt(t),e.jsx("span",{className:"ml-1 capitalize text-xs",children:zt(t)})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Re,{className:"w-3 h-3"}),(()=>{const n=ht(t),w=(n.diasRestantes!==null?n.diasRestantes:Tt(t.fechaLimite))??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:ot(n.fecha)}),e.jsxs("span",{className:`font-medium ${Ro(w)}`,children:["(",w>=0?`${w}d`:`${Math.abs(w)}d vencido`,")"]})]})})()]})]},r)})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:d?e.jsxs(se,{className:"h-fit dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs(Ze,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Qe,{className:"text-xl dark:text-gray-100",children:d.concepto}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mt-1",children:d.descripcion})]}),e.jsx($e,{className:Rt(d),children:e.jsxs("div",{className:"flex items-center gap-1",children:[Pt(d),e.jsx("span",{className:"capitalize",children:zt(d)})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground dark:text-gray-400",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsxs("span",{children:["Vence: ",ot(ht(d).fecha)]})]}),d.obligatorio&&e.jsx($e,{variant:"destructive",className:"text-xs",children:"Documento Obligatorio"}),H(d)&&e.jsx($e,{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border-orange-300 dark:border-orange-800",children:"CADUCADO"}),d?.carreraNombre&&e.jsx($e,{variant:"secondary",className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400",children:d.carreraNombre})]})]}),e.jsxs(ne,{className:"space-y-6",children:[K(d).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos subidos (",K(d).length,")"]}),e.jsx("div",{className:"space-y-2",children:K(d).map(t=>{const r=d?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,a=H(d);let n="";return de.has(t.id)?n="border-green-400 dark:border-green-600 bg-green-50 dark:bg-green-900/20 shadow-lg ring-2 ring-green-200 dark:ring-green-800 ring-opacity-50 animate-pulse":t.estado==="subiendo"||t.estado==="procesando"||t.estado==="analizando"?n="border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/20 shadow-lg":t.estado==="completado"?r?n="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":a?n="border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20":n="border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20":t.estado==="rechazado"?n="border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20 shadow-lg":t.estado==="error"?n="border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":n="border-gray-200 dark:border-gray-700 dark:bg-gray-800/50",e.jsx("div",{className:`p-3 border rounded-lg transition-all duration-300 ${n}`,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.nombre}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:Bt(t)}),"                                                                    ",t.estado==="subiendo"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-bounce"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:t.mensaje||"Subiendo archivo..."}),e.jsxs("span",{className:"text-xs text-blue-500 dark:text-blue-400 font-bold",children:[t.progreso,"%"]})]}),e.jsx($t,{value:t.progreso,className:"h-3 bg-blue-100 dark:bg-blue-900/30"})]}),t.estado==="procesando"&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:t.mensaje||"Procesando documento..."})]})}),t.estado==="analizando"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:t.mensaje||"Analizando con IA..."})]}),e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:e.jsx("div",{className:"mt-1 text-xs text-purple-600 dark:text-purple-400",children:"procesando el documento..."})})]}),t.estado==="completado"&&e.jsxs(e.Fragment,{children:[(()=>{const f=d?.estado==="rechazado"||t.validacionIA&&!t.validacionIA.coincide,w=H(d);return f?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(me,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Documento Rechazado"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 px-2 py-1 rounded",children:["No aprobado (",t.validacionIA.porcentaje,"%)"]})]}):w?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Re,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Documento Caducado"}),e.jsx("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 px-2 py-1 rounded",children:"Vencido - Requiere Renovación"})]}):e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(je,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Documento Vigente"}),t.validacionIA&&e.jsxs("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 px-2 py-1 rounded",children:["Aprobado (",t.validacionIA.porcentaje,"%)"]})]})})(),e.jsxs("div",{className:"mt-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:e.jsx(Te,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Vista Previa del Documento"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.nombre})]})]}),e.jsxs(Q,{variant:"outline",size:"sm",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm",children:[e.jsx(Ft,{className:"w-4 h-4"}),"Abrir Completo"]})]})}),e.jsxs("div",{className:"relative bg-gray-50 dark:bg-gray-900",children:[e.jsx("iframe",{src:`/documentos/archivo/${t.id}#toolbar=1&navpanes=0&scrollbar=1&view=FitH&zoom=125`,className:"w-full h-[700px] bg-white dark:bg-gray-900",title:`Preview de ${t.nombre}`,style:{backgroundColor:"#ffffff",border:"none",borderRadius:"0"},onError:()=>{console.log("Error cargando preview del PDF")},loading:"lazy",allowFullScreen:!0}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-all duration-300 pointer-events-none",children:e.jsxs("div",{className:"text-center text-white bg-gray-900 dark:bg-gray-800 bg-opacity-80 p-6 rounded-lg backdrop-blur-sm",children:[e.jsx(Te,{className:"w-16 h-16 mx-auto mb-4 text-blue-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Documento PDF Validado"}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Haz clic para abrir en una nueva ventana"}),e.jsxs(Q,{variant:"secondary",onClick:()=>window.open(`/documentos/file/${t.file_hash_sha256}`,"_blank"),className:"gap-2 pointer-events-auto bg-white text-gray-900 hover:bg-gray-100",children:[e.jsx(Ft,{className:"w-4 h-4"}),"Ver en Nueva Ventana"]})]})})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:e.jsx("div",{className:"flex items-center gap-4 text-xs",children:e.jsx("span",{children:Bt(t)})})})})]})]}),t.estado==="rechazado"&&e.jsxs("div",{className:"flex flex-col gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Documento Rechazado"})]}),t.validacionIA&&e.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>jo(t,d.concepto),className:"text-red-600 hover:text-red-800 hover:bg-red-100 h-6 px-2",children:e.jsx("span",{className:"text-xs",children:"Ver detalles"})})]}),t.validacionIA&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium mb-1",children:"Motivo del rechazo:"}),e.jsx("p",{className:"text-xs text-red-700",children:t.validacionIA.razon}),t.validacionIA.porcentaje!==void 0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Coincidencia: ",t.validacionIA.porcentaje,"%"]})]})]}),t.estado==="error"&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(me,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:t.mensaje||"Error en proceso"})]})]})})})},t.id)})})]}),(I[j(d)]||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 dark:text-gray-200",children:["Archivos seleccionados (",(I[j(d)]||[]).length,")"]}),e.jsx("div",{className:"space-y-2",children:(I[j(d)]||[]).map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 dark:bg-primary/10 rounded-lg border border-primary/20 dark:border-primary/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium dark:text-gray-200",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400",children:yt(t.size)})]})]}),e.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>Do(j(d),r),className:"text-destructive hover:text-destructive dark:text-red-400 dark:hover:text-red-300",children:e.jsx(Xe,{className:"w-4 h-4"})})]},r))}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(Q,{onClick:()=>Eo(j(d)),children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Subir Archivos (",(I[j(d)]||[]).length,")"]}),e.jsx(Q,{variant:"outline",onClick:()=>V(t=>({...t,[j(d)]:[]})),children:"Cancelar"})]})]}),(U(Z(d))!=="vigente"||H(d))&&Ne(d)?e.jsxs("div",{className:`
                                                border-2 border-dashed rounded-lg p-8 text-center transition-colors
                                                ${C===j(d)?"border-primary bg-primary/5 dark:bg-primary/10":"border-muted-foreground/25 hover:border-muted-foreground/50 dark:border-gray-700 dark:hover:border-gray-600"}
                                            `,onDragOver:t=>wo(t,j(d)),onDragLeave:Co,onDrop:t=>So(t,j(d)),children:[e.jsx(Fe,{className:`
                                                w-12 h-12 mx-auto mb-4
                                                ${C===j(d)?"text-primary":"text-muted-foreground dark:text-gray-400"}
                                            `}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Arrastra archivos aquí"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 mb-4 text-sm",children:"o haz clic para seleccionar archivos"}),e.jsx("input",{type:"file",id:`file-input-${j(d)}`,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:t=>ko(t,j(d))}),e.jsxs(Q,{variant:"outline",onClick:()=>{document.getElementById(`file-input-${j(d)}`)?.click()},children:[e.jsx(ra,{className:"w-4 h-4 mr-2"}),"Seleccionar Archivos"]}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-3",children:"Formatos: PDF, DOC, DOCX, JPG, PNG (máx. 10MB)"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-8 text-center bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:U(Z(d))==="vigente"&&!H(d)?e.jsx(je,{className:"w-12 h-12 text-green-600 dark:text-green-400"}):U(Z(d))==="rechazado"?e.jsx(me,{className:"w-12 h-12 text-red-600 dark:text-red-400"}):U(Z(d))==="caducado"||H(d)?e.jsx(Re,{className:"w-12 h-12 text-orange-600 dark:text-orange-400"}):e.jsx(me,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"font-semibold mb-2 text-gray-700 dark:text-gray-200",children:U(Z(d))==="vigente"&&!H(d)?"Documento Aprobado":U(Z(d))==="rechazado"?"Documento Rechazado - Puede Subir Nuevo":U(Z(d))==="caducado"||H(d)?"Documento Caducado - Puede Subir Nuevo":"Subida Bloqueada"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:yo(d)}),U(Z(d))==="vigente"&&!H(d)&&e.jsxs("div",{className:"bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg p-3 text-green-800 dark:text-green-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha sido validado y aprobado."}),e.jsx("p",{className:"text-xs mt-1 text-green-700 dark:text-green-400",children:"No se pueden realizar más cambios a menos que sea rechazado por un administrador."})]}),U(Z(d))==="rechazado"&&e.jsxs("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3 text-red-800 dark:text-red-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento fue rechazado por un administrador."}),e.jsx("p",{className:"text-xs mt-1 text-red-700 dark:text-red-400",children:"Por favor, revise los comentarios y suba una nueva versión."})]}),(U(Z(d))==="caducado"||H(d))&&e.jsxs("div",{className:"bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800 rounded-lg p-3 text-orange-800 dark:text-orange-400",children:[e.jsx("p",{className:"text-sm font-medium",children:"Este documento ha caducado por vencimiento de fecha."}),e.jsx("p",{className:"text-xs mt-1 text-orange-700 dark:text-orange-400",children:"Puede subir una nueva versión actualizada del documento."})]})]})]})]}):e.jsx(se,{className:"h-full dark:bg-gray-800 dark:border-gray-700",children:e.jsx(ne,{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-12 h-12 text-muted-foreground dark:text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold mb-2 dark:text-gray-200",children:"Selecciona un documento"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400 text-sm",children:"Elige un documento de la lista para comenzar a subir archivos"})]})})})})]})]})]})]})};export{Ns as default};
